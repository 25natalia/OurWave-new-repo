/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={471:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".card {\n\tfont-family: 'inter';\n\tbackground-color: rgb(237, 237, 237);\n\twidth: 90%;\n\tpadding: 10px;\n\tborder-radius: 10px;\n\tmargin-left: 5%;\n\tmargin-top: 10px;\n\tmargin-bottom: 10px;\n\tdisplay: flex;\n\talign-items: center;\n\tcolor: rgb(30, 30, 30);\n}\n\n.top {\n\tmargin: 10px;\n\tmargin-right: 20px;\n\tfont-family: 'inter';\n\tfont-weight: 600;\n\tcolor: rgba(30, 30, 30, 0.7);\n}\n\n.artist {\n\tfont-size: 12px;\n\tmargin-top: 2px;\n}\n\n.title {\n\tfont-size: 15px;\n\tfont-weight: 600;\n\tmargin: 0;\n}\n\n.letters {\n\tmargin-left: 10px;\n}\n\nimg {\n\theight: 50px;\n\twidth: 50px;\n\tborder-radius: 5px;\n}\n\n.imagen {\n\tjustify-content: center;\n}\n\np {\n\tmargin-top: 0%;\n\tmargin-bottom: 0%;\n}\n",""]);const a=o},357:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".image img {\n\twidth: 100%;\n\theight: 100%;\n\tobject-fit: cover;\n}\n\n#wave {\n\tmargin-left: 10px;\n\tmargin-top: 10px;\n}\n\n.image {\n\twidth: 30px;\n\theight: 30px;\n\tborder-radius: 50%;\n\toverflow: hidden;\n\tmargin: 10px;\n}\n\n.comment,\n.like_group,\n.share {\n\tmargin-left: 15px;\n\tmargin-right: 15px;\n}\n\n.cardEntera {\n\tbackground-color: rgb(255, 255, 255);\n\twidth: 70%;\n\theight: 15%;\n\tpadding: 10px;\n\tmargin-bottom: 10px;\n\tborder-radius: 10px;\n\tbox-shadow: 0 4px 8px rgba(0, 0, 0.3, 0.3);\n\tmargin-left: 15%;\n\tmargin-top: 2%;\n\tfont-family: 'inter';\n\tcolor: #1e1e1e;\n}\n\n.profile {\n\tdisplay: flex;\n\talign-items: center;\n}\n.interacciones {\n\tdisplay: flex;\n\tcolor: #2ec4b6;\n\talign-items: center;\n\tjustify-content: end;\n}\n.like_group,\n.share,\n.comment {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n#svg {\n\twidth: 26px;\n\theight: 26px;\n\tmargin: 3px;\n}\n\n#svg_like {\n\twidth: 26px;\n\theight: 26px;\n\tmargin: 3px;\n}\n\n.username {\n\tfont-weight: 700;\n}\n\np {\n\tmargin: 0;\n}\n",""]);const a=o},499:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"p {\n\tfont-family: 'inter';\n\tfont-size: 14px;\n\tcolor: white;\n}\n.image img {\n\twidth: 30px;\n\theight: 30px; /* Ancho del contenedor */ /* Altura del contenedor */\n\toverflow: hidden; /* Oculta cualquier contenido que exceda los lÃ­mites del contenedor */\n\tdisplay: block; /* Asegura que la imagen se comporte como un bloque */\n\tborder-radius: 50%; /* Hace que la imagen sea circular */\n\tmargin: 10px;\n}\n\n.image {\n\tdisplay: flex;\n}\n\n.song {\n\tfont-family: 'inter';\n\tfont-weight: 400;\n\tfont-size: 20px;\n\twidth: 280px;\n\talign-items: flex-start;\n\tcolor: white;\n\tmargin-left: 65px;\n\tmargin-top: 0;\n}\n\nh3 {\n\tmargin-top: 0;\n}\n.card {\n\twidth: 400px;\n\theight: 180px;\n\tborder-radius: 20px;\n\tmargin: 20px;\n}\n\n.todo {\n\tposition: relative;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.7);\n\tz-index: 1;\n\tborder-radius: 20px;\n}\n",""]);const a=o},507:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".header {\n\tbackground-color: rgb(255, 255, 255);\n\theight: 10vh;\n\tbox-shadow: 0 4px 4px rgba(0, 0, 0, 0.1);\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n\n#perfil {\n\theight: 50px;\n\twidth: 50px;\n\tmargin-right: 2%;\n}\n\n.header img {\n\tmargin-left: 5%;\n}\n\n.logo img {\n\theight: 10vh;\n\tmargin-left: 20px;\n\tcursor: pointer;\n}\n\nsvg {\n\tmargin-right: 20px;\n\tcursor: pointer;\n}\n\n#log_out {\n\tbackground-color: transparent;\n\tborder: none;\n}\n\n.modalContainer {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.5);\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-family: Arial;\n}\n\n.Accept {\n\tbackground-color: #2ec4b6;\n\tborder: none;\n\tborder-radius: 50px;\n\tcursor: pointer;\n\theight: 40px;\n\twidth: 120px;\n\tcolor: white;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\ttransition: 0.3s;\n\tmargin-left: 6px;\n}\n\n.Cancel {\n\tbackground-color: rgba(46, 196, 182, 0.7);\n\tborder: none;\n\tborder-radius: 50px;\n\tcursor: pointer;\n\theight: 40px;\n\twidth: 120px;\n\tcolor: white;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\ttransition: 0.3s;\n\tmargin-right: 6px;\n}\n\n.Accept:hover,\n.Cancel:hover {\n\tbackground-color: #ffbf69;\n}\n\nh2 {\n\tcolor: #ff9f1c;\n\tfont-size: 25px;\n}\n\n.close {\n\tmargin-left: 90%;\n\tmargin-top: 2%;\n\tright: 50px;\n\tcursor: pointer;\n\tfont-family: Arial;\n\tcolor: #2ec4b6;\n}\n\n.logout {\n\tbackground-color: white;\n\tpadding: 20px;\n\tborder-radius: 40px;\n\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\twidth: 40%;\n\theight: 20%;\n\toverflow-y: auto;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tposition: relative;\n\tmargin: auto;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n}\n\n.botones {\n\tdisplay: flex;\n\tmargin: 10px;\n}\n",""]);const a=o},67:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".menubar {\n\tdisplay: flex;\n\tjustify-content: space-evenly;\n\tposition: fixed;\n\tbottom: 0;\n\talign-items: center;\n\twidth: 100%;\n\theight: 10vh;\n\tbackground-color: white;\n\tz-index: 2;\n\tbox-shadow: 0 -4px 4px rgba(0, 0, 0, 0.1);\n}\n\n#home,\n#chats,\n#profile {\n\theight: 30px;\n\twidth: 30px;\n\tcursor: pointer;\n}\n\n#explore {\n\theight: 24px;\n\twidth: 34px;\n\tcursor: pointer;\n}\n\n@media screen and (max-width: 768px) {\n\t.menubar {\n\t\tdisplay: flex;\n\t\tjustify-content: space-evenly;\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\talign-items: center;\n\t\twidth: 100%;\n\t\theight: 8vh;\n\t\tbackground-color: white;\n\t\tbox-shadow: 0 -4px 4px rgba(0, 0, 0, 0.1);\n\t}\n}\n",""]);const a=o},831:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".profile {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tflex-direction: column;\n\tfont-family: 'inter';\n\tmargin-top: 30px;\n}\n\n#ButtonSong,\n#edit {\n\tbackground-color: transparent;\n\tborder: none;\n\tcursor: pointer;\n}\n\n#writtenSong,\n#newProfileImage {\n\tpadding: 4%;\n\tmargin-bottom: 2vh;\n\tborder-radius: 30px;\n\twidth: 32vh;\n\theight: 1vh;\n}\n\n#newProfileImage::placeholder {\n\tfont-family: 'inter';\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.Accept {\n\tbackground-color: #2ec4b6;\n\tborder: none;\n\tborder-radius: 50px;\n\tcursor: pointer;\n\theight: 40px;\n\twidth: 120px;\n\tcolor: white;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\ttransition: 0.3s;\n\tmargin-left: 6px;\n}\n\n.Cancel {\n\tbackground-color: rgba(46, 196, 182, 0.7);\n\tborder: none;\n\tborder-radius: 50px;\n\tcursor: pointer;\n\theight: 40px;\n\twidth: 120px;\n\tcolor: white;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\ttransition: 0.3s;\n\tmargin-right: 6px;\n}\n\n.fileContainer {\n\tdisplay: inline-block;\n\tposition: relative;\n\toverflow: hidden;\n\tcursor: pointer;\n\tpadding-bottom: 2vh;\n}\n\n.fileContainer input[type='file'] {\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tmargin: 0;\n\tpadding: 0;\n\tfont-size: 20px;\n\tcursor: pointer;\n\topacity: 0;\n\tfilter: alpha(opacity=0);\n}\n\n.fileContainer:before {\n\tcontent: 'Select file';\n\twhite-space: nowrap;\n\tbackground-color: #ff9f1c;\n\tborder: none;\n\tborder-radius: 50px;\n\tcursor: pointer;\n\theight: 5vh;\n\twidth: 40vh;\n\ttransition: background-color 0.2s ease;\n\tcolor: white;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tmargin-top: 1vh;\n\tmargin-left: 1vh;\n\tmargin-right: 1vh;\n}\n.fileContainer:hover:before {\n\tbackground-color: #ffbf69;\n}\n\n.file-name {\n\tmargin-left: 10px;\n\tfont-size: 16px;\n\tcolor: #333;\n\tdisplay: inline-block;\n\tvertical-align: middle;\n}\n\n.Accept:hover,\n.Cancel:hover {\n\tbackground-color: #ffbf69;\n}\n\n.waveSong {\n\tbackground-color: white;\n\tpadding: 20px;\n\tborder-radius: 40px;\n\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\twidth: 60%;\n\theight: 40%;\n\toverflow-y: auto;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tposition: relative;\n\tmargin: auto;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n}\n\n.profileImgForm {\n\tbackground-color: white;\n\tpadding: 20px;\n\tborder-radius: 40px;\n\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\twidth: 45%;\n\toverflow-y: auto;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tposition: relative;\n\tmargin: auto;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n}\n\n.modalContainer,\n#modalContainerProfileImg {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.5);\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-family: Arial;\n}\n\n.post {\n\tbackground-color: #2ec4b6;\n\tborder: none;\n\tborder-radius: 50px;\n\tcursor: pointer;\n\theight: 40px;\n\twidth: 120px;\n\ttransition: background-color 0.2s ease;\n\tcolor: white;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\nh2 {\n\tcolor: #ff9f1c;\n\tfont-size: 25px;\n}\n\n.close {\n\tmargin-left: 90%;\n\tmargin-top: 2%;\n\tright: 50px;\n\tcursor: pointer;\n\tfont-family: Arial;\n\tcolor: #2ec4b6;\n}\n\n.profileimg {\n\twidth: 200px;\n\theight: 200px;\n\tborder-radius: 50%;\n\toverflow: hidden;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 2px solid #fff;\n\tbox-shadow: 0 0 5px rgba(0, 0, 0, 0.2);\n}\n\n.profileimg img {\n\twidth: 100%;\n\theight: 100%;\n\tobject-fit: cover;\n}\n\n.pin {\n\theight: 24px;\n\twidth: 24px;\n}\n\nh1 {\n\tfont-size: 24px;\n\tmargin-bottom: 0;\n\tfont-weight: 700;\n\tcolor: #1e1e1e;\n}\n\n.edit {\n\tbackground-color: transparent;\n\tborder-width: 0;\n\tcolor: #ff9f1c;\n\tcursor: pointer;\n\tfont-family: 'inter';\n\tfont-size: 16px;\n\tmargin-top: 0;\n\tfont-weight: 500;\n}\n\n.fav_song {\n\tdisplay: flex;\n\talign-items: center;\n\tfont-weight: 500;\n\tfont-size: 25px;\n\tcolor: rgb(46, 196, 182);\n\tcursor: pointer;\n}\n\n.name-following {\n\tdisplay: flex;\n\talign-items: center;\n\tflex-direction: row;\n\tjustify-content: center;\n\tfont-family: 'Inter';\n}\n\n.name {\n\tmargin: 5px;\n\tborder: 2px solid rgba(30, 30, 30, 0.2);\n\tborder-radius: 10px;\n\theight: 30px;\n\twidth: 193px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 16px;\n\tcolor: #1e1e1e;\n}\n\n.following {\n\tmargin: 5px;\n\tborder: 2px solid rgba(30, 30, 30, 0.2);\n\tborder-radius: 10px;\n\theight: 30px;\n\twidth: 193px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 16px;\n\tcolor: #1e1e1e;\n\tcursor: pointer;\n}\n\n.followers {\n\theight: 55px;\n\twidth: 400px;\n\tbackground-color: #2ec4b6;\n\tfont-weight: 500;\n\tcolor: white;\n\tborder-radius: 12px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 18px;\n\tmargin: 4px;\n\tbox-shadow: 2px 2px 7px rgba(0, 0, 0, 0.4);\n\tcursor: pointer;\n}\n\n.playlist {\n\theight: 35px;\n\twidth: 400px;\n\tbackground-color: #ff9f1c;\n\tfont-weight: 500;\n\tcolor: white;\n\tborder-radius: 10px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 15px;\n\tmargin: 4px;\n\tborder: none;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\tmargin-top: 8px;\n\tcursor: pointer;\n}\n\n.todo {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tfont-family: 'inter';\n}\n\n.h1Add {\n\tfont-size: 24px;\n\tmargin-bottom: 15px;\n\tcolor: #1e1e1e;\n\tfont-weight: 700;\n\tfont-family: 'Inter';\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tmargin-top: 30px;\n}\n\n.artist,\n.title,\n.coverImage {\n\twidth: 20%;\n\tpadding: 10px;\n\tmargin: 4px;\n\theight: 12px;\n\tborder: 2px solid #ccc;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n}\n\n.create-song {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.artist:focus,\n.title:focus,\n.coverImage:focus {\n\tborder-color: #ff9f1c;\n\toutline: none;\n}\n\n.save {\n\tpadding: 10px 65px;\n\tfont-size: 16px;\n\tborder: none;\n\tborder-radius: 5px;\n\tbackground-color: #ff9f1c;\n\tcolor: white;\n\tcursor: pointer;\n\ttransition: 0.3s;\n\tmargin-left: 45%;\n\tmargin-top: 20px;\n\tmargin-bottom: 20px;\n}\n.save:hover {\n\tbackground-color: #ffbf69;\n}\n\n.playlist:hover {\n\tbackground-color: #ffbf69;\n}\n.botones {\n\tdisplay: flex;\n\tmargin: 10px;\n}\n",""]);const a=o},835:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"input {\n\twidth: 70vh;\n\tpadding: 10px;\n\tmargin: 2vh;\n\tborder: none;\n\tborder-radius: 12px;\n\tfont-size: 15px;\n\tcolor: rgba(30, 30, 30, 0.8);\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\theight: 4vh;\n}\n\n.info {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n}\n\nsvg {\n\tmargin-top: 40px;\n\theight: 35px;\n\twidth: 35px;\n\tcursor: pointer;\n\tposition: absolute;\n\tmargin-right: 90%;\n}\n\ninput:focus {\n\tborder-color: #2ec4b6;\n\toutline: none;\n}\n\n.logo {\n\twidth: 40vh;\n}\n\n.todo {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\talign-content: center;\n\tfont-family: 'inter';\n}\n\n.google {\n\twidth: 9vh;\n\tmargin-right: 100px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tcursor: pointer;\n}\n\n.facebook {\n\twidth: 6vh;\n\tmargin-right: 100px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tpadding: 8px;\n\tbackground-color: #fdfdfd;\n\tcursor: pointer;\n}\n\n.outlook {\n\twidth: 6vh;\n\tmargin: 10px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tpadding: 8px;\n\tbackground-color: #fdfdfd;\n\tcursor: pointer;\n}\n\n#apps {\n\tdisplay: flex;\n\talign-items: center;\n}\n\nbutton {\n\twidth: 73vh;\n\tpadding: 10px;\n\tmargin: 2vh;\n\tborder: none;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n\tcolor: white;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\theight: 6vh;\n\tbackground-color: #2ec4b6;\n\tcursor: pointer;\n\ttransition: 0.3s;\n}\n\nbutton:hover {\n\tbackground-color: #ffbf69;\n}\n\nform {\n\tdisplay: flex;\n\tjustify-content: center;\n\tflex-direction: column;\n}\n\n.text_create {\n\tcolor: rgba(30, 30, 30, 0.6);\n\tmargin-bottom: 25px;\n\tmargin-left: 12px;\n\tmargin-top: 0;\n\tfont-weight: 600;\n}\n\n.text {\n\tcolor: rgba(30, 30, 30, 0.6);\n\tmargin-top: 45px;\n\tmargin-bottom: 45px;\n\tmargin-right: 10px;\n\tfont-weight: 500;\n}\n\n.already_have {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.signup_btn {\n\tcursor: pointer;\n\tcolor: #ff9f1c;\n}\n\n@media screen and (max-width: 768px) {\n\tinput {\n\t\twidth: 50vh;\n\t\tpadding: 10px;\n\t\tmargin: 2vh;\n\t\tborder: none;\n\t\tborder-radius: 12px;\n\t\tfont-size: 15px;\n\t\tcolor: rgba(30, 30, 30, 0.8);\n\t\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\t\theight: 4vh;\n\t}\n}\n\n.inputs {\n\tdisplay: flex;\n\talign-items: center;\n\tflex-direction: column;\n}\n",""]);const a=o},9:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"input {\n\twidth: 30%;\n\theight: 15%;\n\tpadding: 10px;\n\tmargin: 10px;\n\tborder: 2px solid #ccc;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n\tmargin-left: 15%;\n\tmargin-bottom: 30px;\n}\n\nbody {\n\tcolor: #ccc;\n}\n\nh1 {\n\tfont-family: 'inter';\n\tmargin-left: 15%;\n\tfont-size: 30px;\n\tpadding-top: 50px;\n\tcolor: #1e1e1e;\n\tmargin-top: 0;\n}\n\nh2 {\n\tfont-family: 'inter';\n\tmargin-left: 15%;\n\tfont-size: 30px;\n\tmargin-top: 10px;\n\tcolor: #969696;\n\tmargin-bottom: 20px;\n}\n\ninput:focus {\n\tborder-color: #ff9f1c;\n\toutline: none;\n}\n\nbutton {\n\tpadding: 10px 40px;\n\tfont-size: 16px;\n\tborder: none;\n\tborder-radius: 5px;\n\tbackground-color: #ff9f1c;\n\tcolor: white;\n\tcursor: pointer;\n\ttransition: 0.3s;\n\tmargin-top: 20px;\n\tmargin-bottom: 20px;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n}\n\nbutton:hover {\n\tbackground-color: #ffbf69;\n}\n\n.input-btn {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n",""]);const a=o},628:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"h1 {\n\tfont-family: 'inter';\n\tmargin-left: 20px;\n\tfont-size: 30px;\n\tmargin-top: 60px;\n\tcolor: #1e1e1e;\n}\n\n.playlists {\n\tdisplay: flex;\n\toverflow-x: auto;\n\tmax-width: 100%;\n\tpadding-bottom: 20px;\n}\n\n.my-friend {\n\tflex: 0 0 auto;\n\tmargin-right: 20px;\n}\n",""]);const a=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);i&&o[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),e.push(h))}},e}},601:t=>{t.exports=function(t){return t[1]}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{const t=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#ff9f1c" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'"https://i.pinimg.com/originals/94/67/f5/9467f504e83345d60816f9b87ac84588.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="27" height="27" viewBox="0 0 24 24" style="fill: rgb(32, 32, 32);transform: ;msFilter:;"><path d="M12 2C6.579 2 2 6.579 2 12s4.579 10 10 10 10-4.579 10-10S17.421 2 12 2zm0 5c1.727 0 3 1.272 3 3s-1.273 3-3 3c-1.726 0-3-1.272-3-3s1.274-3 3-3zm-5.106 9.772c.897-1.32 2.393-2.2 4.106-2.2h2c1.714 0 3.209.88 4.106 2.2C15.828 18.14 14.015 19 12 19s-3.828-.86-5.106-2.228z"></path></svg>'}];var e=n(67);const i=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=r>>2,h=(3&r)<<4|o>>4;let u=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(u=64)),i.push(n[l],n[h],n[u],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const c=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==o||null==a||null==c)throw new s;const l=r<<2|o>>4;if(i.push(l),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==c){const t=a<<6&192|c;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(t){return function(t){const e=i(t);return r.encodeByteArray(e,!0)}(t).replace(/\./g,"")},a=function(t){try{return r.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},c=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&a(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},l=t=>{var e,n;return null===(n=null===(e=c())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},h=t=>{const e=l(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]},u=()=>{var t;return null===(t=c())||void 0===t?void 0:t.config},d=t=>{var e;return null===(e=c())||void 0===e?void 0:e[`_${t}`]};class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function p(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(s)),""].join(".")}function m(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function g(){try{return"object"==typeof indexedDB}catch(t){return!1}}class v extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,v.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(w,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new v(i,o,n)}}const w=/\{\$([^}]+)}/g;function b(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(_(n)&&_(s)){if(!b(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function _(t){return null!==t&&"object"==typeof t}function E(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function T(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function I(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class C{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=S),void 0===i.error&&(i.error=S),void 0===i.complete&&(i.complete=S);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function S(){}function k(t){return t&&t._delegate?t._delegate:t}class A{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const x="[DEFAULT]";class R{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new f;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:x})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=x){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=x){return this.instances.has(t)}getOptions(t=x){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===x?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=x){return this.component?this.component.multipleInstances?t:x:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class N{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new R(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const D=[];var O;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(O||(O={}));const L={debug:O.DEBUG,verbose:O.VERBOSE,info:O.INFO,warn:O.WARN,error:O.ERROR,silent:O.SILENT},P=O.INFO,M={[O.DEBUG]:"log",[O.VERBOSE]:"log",[O.INFO]:"info",[O.WARN]:"warn",[O.ERROR]:"error"},U=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=M[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class F{constructor(t){this.name=t,this._logLevel=P,this._logHandler=U,this._userLogHandler=null,D.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in O))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?L[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,O.DEBUG,...t),this._logHandler(this,O.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,O.VERBOSE,...t),this._logHandler(this,O.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,O.INFO,...t),this._logHandler(this,O.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,O.WARN,...t),this._logHandler(this,O.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,O.ERROR,...t),this._logHandler(this,O.ERROR,...t)}}const V=(t,e)=>e.some((e=>t instanceof e));let j,B;const z=new WeakMap,q=new WeakMap,H=new WeakMap,$=new WeakMap,K=new WeakMap;let G={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return q.get(t);if("objectStoreNames"===e)return t.objectStoreNames||H.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Q(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function W(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(B||(B=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(X(this),t),Q(z.get(this))}:function(...t){return Q(e.apply(X(this),t))}:function(t,...n){const i=e.call(X(this),t,...n);return H.set(i,t.sort?t.sort():[t]),Q(i)}:(t instanceof IDBTransaction&&function(t){if(q.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));q.set(t,e)}(t),V(t,j||(j=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,G):t);var e}function Q(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(Q(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&z.set(e,t)})).catch((()=>{})),K.set(e,t),e}(t);if($.has(t))return $.get(t);const e=W(t);return e!==t&&($.set(t,e),K.set(e,t)),e}const X=t=>K.get(t),J=["get","getKey","getAll","getAllKeys","count"],Y=["put","add","delete","clear"],Z=new Map;function tt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Z.get(e))return Z.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=Y.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!J.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return Z.set(e,s),s}var et;et=G,G={...et,get:(t,e,n)=>tt(t,e)||et.get(t,e,n),has:(t,e)=>!!tt(t,e)||et.has(t,e)};class nt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const it="@firebase/app",rt="0.9.26",st=new F("@firebase/app"),ot="[DEFAULT]",at={[it]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ct=new Map,lt=new Map;function ht(t,e){try{t.container.addComponent(e)}catch(n){st.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ut(t){const e=t.name;if(lt.has(e))return st.debug(`There were multiple attempts to register component ${e}.`),!1;lt.set(e,t);for(const e of ct.values())ht(e,t);return!0}function dt(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const ft=new y("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class pt{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new A("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ft.create("app-deleted",{appName:this._name})}}const mt="10.7.2";function gt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:ot,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw ft.create("bad-app-name",{appName:String(r)});if(n||(n=u()),!n)throw ft.create("no-options");const s=ct.get(r);if(s){if(b(n,s.options)&&b(i,s.config))return s;throw ft.create("duplicate-app",{appName:r})}const o=new N(r);for(const t of lt.values())o.addComponent(t);const a=new pt(n,i,o);return ct.set(r,a),a}function vt(t=ot){const e=ct.get(t);if(!e&&t===ot&&u())return gt();if(!e)throw ft.create("no-app",{appName:t});return e}function yt(t,e,n){var i;let r=null!==(i=at[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void st.warn(t.join(" "))}ut(new A(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const wt="firebase-heartbeat-database",bt=1,_t="firebase-heartbeat-store";let Et=null;function Tt(){return Et||(Et=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=Q(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(Q(o.result),t.oldVersion,t.newVersion,Q(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(t=>r(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(wt,bt,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(_t)}catch(t){console.warn(t)}}}).catch((t=>{throw ft.create("idb-open",{originalErrorMessage:t.message})}))),Et}async function It(t,e){try{const n=(await Tt()).transaction(_t,"readwrite"),i=n.objectStore(_t);await i.put(e,Ct(t)),await n.done}catch(t){if(t instanceof v)st.warn(t.message);else{const e=ft.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});st.warn(e.message)}}}function Ct(t){return`${t.name}!${t.options.appId}`}class St{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new At(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=kt();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=kt(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),xt(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),xt(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=o(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function kt(){return(new Date).toISOString().substring(0,10)}class At{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!g()&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=await Tt();return await e.transaction(_t).objectStore(_t).get(Ct(t))}catch(t){if(t instanceof v)st.warn(t.message);else{const e=ft.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});st.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return It(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return It(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function xt(t){return o(JSON.stringify({version:2,heartbeats:t})).length}function Rt(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}ut(new A("platform-logger",(t=>new nt(t)),"PRIVATE")),ut(new A("heartbeat",(t=>new St(t)),"PRIVATE")),yt(it,rt,""),yt(it,rt,"esm2017"),yt("fire-js",""),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Nt=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Dt=new y("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ot=new F("@firebase/auth");function Lt(t,...e){Ot.logLevel<=O.ERROR&&Ot.error(`Auth (${mt}): ${t}`,...e)}function Pt(t,...e){throw Ut(t,...e)}function Mt(t,...e){return Ut(t,...e)}function Ut(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return Dt.create(t,...e)}function Ft(t,e,...n){if(!t)throw Ut(e,...n)}function Vt(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Lt(e),new Error(e)}function jt(t,e){t||Vt(e)}function Bt(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function zt(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function qt(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===zt()||"https:"===zt()||function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class Ht{constructor(t,e){this.shortDelay=t,this.longDelay=e,jt(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return qt()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $t(t,e){jt(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Kt{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Vt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Vt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Vt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Gt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Wt=new Ht(3e4,6e4);function Qt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Xt(t,e,n,i,r={}){return Jt(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=E(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Kt.fetch()(Zt(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Jt(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Gt),e);try{const e=new ee(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw ne(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ne(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw ne(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw ne(t,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const i=Object.assign(Object.assign({},Nt()),{[e]:n});return new y("auth","Firebase",i).create(e,{appName:t.name})}(t,a,o);Pt(t,a)}}catch(e){if(e instanceof v)throw e;Pt(t,"network-request-failed",{message:String(e)})}}async function Yt(t,e,n,i,r={}){const s=await Xt(t,e,n,i,r);return"mfaPendingCredential"in s&&Pt(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Zt(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?$t(t.config,r):`${t.config.apiScheme}://${r}`}function te(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ee{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Mt(this.auth,"network-request-failed"))),Wt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function ne(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Mt(t,e,i);return r.customData._tokenResponse=n,r}function ie(t){return void 0!==t&&void 0!==t.enterprise}class re{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return te(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}function se(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function oe(t){return 1e3*Number(t)}function ae(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return Lt("JWT malformed, contained fewer than 3 sections"),null;try{const t=a(n);return t?JSON.parse(t):(Lt("Failed to decode base64 JWT payload"),null)}catch(t){return Lt("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function ce(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof v&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class le{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class he{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=se(this.lastLoginAt),this.creationTime=se(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ue(t){var e;const n=t.auth,i=await t.getIdToken(),r=await ce(t,async function(t,e){return Xt(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));Ft(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=Rt(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,l=o,[...c.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var c,l;const h=t.isAnonymous,u=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!h&&u,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new he(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class de{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Ft(t.idToken,"internal-error"),Ft(void 0!==t.idToken,"internal-error"),Ft(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=ae(t);return Ft(e,"internal-error"),Ft(void 0!==e.exp,"internal-error"),Ft(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return Ft(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await Jt(t,{},(async()=>{const n=E({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=Zt(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Kt.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new de;return n&&(Ft("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(Ft("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(Ft("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new de,this.toJSON())}_performRefresh(){return Vt("not implemented")}}function fe(t,e){Ft("string"==typeof t||void 0===t,"internal-error",{appName:e})}class pe{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=Rt(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new le(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new he(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await ce(this,this.stsTokenManager.getToken(this.auth,t));return Ft(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=k(t),i=await n.getIdToken(e),r=ae(i);Ft(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:se(oe(r.auth_time)),issuedAtTime:se(oe(r.iat)),expirationTime:se(oe(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=k(t);await ue(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Ft(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new pe(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await ue(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await ce(this,async function(t,e){return Xt(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,c,l;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,u=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=e.createdAt)&&void 0!==c?c:void 0,v=null!==(l=e.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:w,isAnonymous:b,providerData:_,stsTokenManager:E}=e;Ft(y&&E,t,"internal-error");const T=de.fromJSON(this.name,E);Ft("string"==typeof y,t,"internal-error"),fe(h,t.name),fe(u,t.name),Ft("boolean"==typeof w,t,"internal-error"),Ft("boolean"==typeof b,t,"internal-error"),fe(d,t.name),fe(f,t.name),fe(p,t.name),fe(m,t.name),fe(g,t.name),fe(v,t.name);const I=new pe({uid:y,auth:t,email:u,emailVerified:w,displayName:h,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:g,lastLoginAt:v});return _&&Array.isArray(_)&&(I.providerData=_.map((t=>Object.assign({},t)))),m&&(I._redirectEventId=m),I}static async _fromIdTokenResponse(t,e,n=!1){const i=new de;i.updateFromServerResponse(e);const r=new pe({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await ue(r),r}}const me=new Map;function ge(t){jt(t instanceof Function,"Expected a class definition");let e=me.get(t);return e?(jt(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,me.set(t,e),e)}class ve{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}ve.type="NONE";const ye=ve;function we(t,e,n){return`firebase:${t}:${e}:${n}`}class be{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=we(this.userKey,i.apiKey,r),this.fullPersistenceKey=we("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?pe._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new be(ge(ye),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||ge(ye);const s=we(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=pe._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new be(r,t,n)):new be(r,t,n)}}function _e(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ce(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ee(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ke(e))return"Blackberry";if(Ae(e))return"Webos";if(Te(e))return"Safari";if((e.includes("chrome/")||Ie(e))&&!e.includes("edge/"))return"Chrome";if(Se(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Ee(t=m()){return/firefox\//i.test(t)}function Te(t=m()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ie(t=m()){return/crios\//i.test(t)}function Ce(t=m()){return/iemobile/i.test(t)}function Se(t=m()){return/android/i.test(t)}function ke(t=m()){return/blackberry/i.test(t)}function Ae(t=m()){return/webos/i.test(t)}function xe(t=m()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Re(t=m()){return xe(t)||Se(t)||Ae(t)||ke(t)||/windows phone/i.test(t)||Ce(t)}function Ne(t,e=[]){let n;switch(t){case"Browser":n=_e(m());break;case"Worker":n=`${_e(m())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${mt}/${i}`}class De{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class Oe{constructor(t){var e,n,i,r;const s=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=s.minPasswordLength)&&void 0!==e?e:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=t.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}class Le{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Me(this),this.idTokenSubscription=new Me(this),this.beforeStateQueue=new De(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=ge(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await be.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await ue(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?k(t):null;return e&&Ft(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Ft(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(ge(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return Xt(t,"GET","/v2/passwordPolicy",Qt(t,e))}(this),e=new Oe(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new y("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return Xt(t,"POST","/v2/accounts:revokeToken",Qt(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&ge(t)||this._popupRedirectResolver;Ft(e,this,"argument-error"),this.redirectPersistenceManager=await be.create(this,[ge(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ft(o,this,"internal-error"),o.then((()=>{s||r(this.currentUser)})),"function"==typeof e){const r=t.addObserver(e,n,i);return()=>{s=!0,r()}}{const n=t.addObserver(e);return()=>{s=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Ne(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){Ot.logLevel<=O.WARN&&Ot.warn(`Auth (${mt}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function Pe(t){return k(t)}class Me{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new C(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return Ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Ue(t){return new Promise(((e,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=Mt("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)}))}function Fe(t){return`__${t}${Math.floor(1e6*Math.random())}`}class Ve{constructor(t){this.type="recaptcha-enterprise",this.auth=Pe(t)}async verify(t="verify",e=!1){function n(e,n,i){const r=window.grecaptcha;ie(r)?r.enterprise.ready((()=>{r.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{(async function(t,e){return Xt(t,"GET","/v2/recaptchaConfig",Qt(t,e))})(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new re(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((r=>{if(!e&&ie(window.grecaptcha))n(r,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));Ue("https://www.google.com/recaptcha/enterprise.js?render="+r).then((()=>{n(r,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function je(t,e,n,i=!1){const r=new Ve(t);let s;try{s=await r.verify(n)}catch(t){s=await r.verify(n,!0)}const o=Object.assign({},e);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Be(t,e,n,i){var r;if(null===(r=t._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await je(t,e,n,"getOobCode"===n);return i(t,r)}return i(t,e).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await je(t,e,n,"getOobCode"===n);return i(t,r)}return Promise.reject(r)}))}function ze(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function qe(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class He{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Vt("not implemented")}_getIdTokenResponse(t){return Vt("not implemented")}_linkToIdToken(t,e){return Vt("not implemented")}_getReauthenticationResolver(t){return Vt("not implemented")}}async function $e(t,e){return Xt(t,"POST","/v1/accounts:signUp",e)}async function Ke(t,e){return Yt(t,"POST","/v1/accounts:signInWithPassword",Qt(t,e))}class Ge extends He{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Ge(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Ge(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return Be(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ke);case"emailLink":return async function(t,e){return Yt(t,"POST","/v1/accounts:signInWithEmailLink",Qt(t,e))}(t,{email:this._email,oobCode:this._password});default:Pt(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return Be(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$e);case"emailLink":return async function(t,e){return Yt(t,"POST","/v1/accounts:signInWithEmailLink",Qt(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Pt(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function We(t,e){return Yt(t,"POST","/v1/accounts:signInWithIdp",Qt(t,e))}class Qe extends He{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Qe(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Pt("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=Rt(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Qe(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return We(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,We(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,We(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=E(e)}return t}}const Xe={USER_NOT_FOUND:"user-not-found"};class Je extends He{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Je({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Je({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Yt(t,"POST","/v1/accounts:signInWithPhoneNumber",Qt(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Yt(t,"POST","/v1/accounts:signInWithPhoneNumber",Qt(t,e));if(n.temporaryProof)throw ne(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Yt(t,"POST","/v1/accounts:signInWithPhoneNumber",Qt(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Xe)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new Je({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Ye{constructor(t){var e,n,i,r,s,o;const a=T(I(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Ft(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=T(I(t)).link,n=e?T(I(e)).deep_link_id:null,i=T(I(t)).deep_link_id;return(i?T(I(i)).link:null)||i||n||e||t}(t);try{return new Ye(e)}catch(t){return null}}}class Ze{constructor(){this.providerId=Ze.PROVIDER_ID}static credential(t,e){return Ge._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Ye.parseLink(e);return Ft(n,"argument-error"),Ge._fromEmailAndCode(t,n.code,n.tenantId)}}Ze.PROVIDER_ID="password",Ze.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ze.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class tn{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class en extends tn{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class nn extends en{constructor(){super("facebook.com")}static credential(t){return Qe._fromParams({providerId:nn.PROVIDER_ID,signInMethod:nn.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return nn.credentialFromTaggedObject(t)}static credentialFromError(t){return nn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return nn.credential(t.oauthAccessToken)}catch(t){return null}}}nn.FACEBOOK_SIGN_IN_METHOD="facebook.com",nn.PROVIDER_ID="facebook.com";class rn extends en{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Qe._fromParams({providerId:rn.PROVIDER_ID,signInMethod:rn.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return rn.credentialFromTaggedObject(t)}static credentialFromError(t){return rn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return rn.credential(e,n)}catch(t){return null}}}rn.GOOGLE_SIGN_IN_METHOD="google.com",rn.PROVIDER_ID="google.com";class sn extends en{constructor(){super("github.com")}static credential(t){return Qe._fromParams({providerId:sn.PROVIDER_ID,signInMethod:sn.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return sn.credentialFromTaggedObject(t)}static credentialFromError(t){return sn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return sn.credential(t.oauthAccessToken)}catch(t){return null}}}sn.GITHUB_SIGN_IN_METHOD="github.com",sn.PROVIDER_ID="github.com";class on extends en{constructor(){super("twitter.com")}static credential(t,e){return Qe._fromParams({providerId:on.PROVIDER_ID,signInMethod:on.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return on.credentialFromTaggedObject(t)}static credentialFromError(t){return on.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return on.credential(e,n)}catch(t){return null}}}async function an(t,e){return Yt(t,"POST","/v1/accounts:signUp",Qt(t,e))}on.TWITTER_SIGN_IN_METHOD="twitter.com",on.PROVIDER_ID="twitter.com";class cn{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await pe._fromIdTokenResponse(t,n,i),s=ln(n);return new cn({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=ln(n);return new cn({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function ln(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class hn extends v{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,hn.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new hn(t,e,n,i)}}function un(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw hn._fromErrorAndOperation(t,n,e,i);throw n}))}async function dn(t,e,n=!1){const i="signIn",r=await un(t,i,e),s=await cn._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}async function fn(t){const e=Pe(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}new WeakMap;const pn="__sak";class mn{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(pn,"1"),this.storage.removeItem(pn),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class gn extends mn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=m();return Te(t)||xe(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Re(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);!function(){const t=m();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||r===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}gn.type="LOCAL";const vn=gn;class yn extends mn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}yn.type="SESSION";const wn=yn;class bn{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new bn(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function _n(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}bn.receivers=[];class En{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=_n("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(l),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Tn(){return window}function In(){return void 0!==Tn().WorkerGlobalScope&&"function"==typeof Tn().importScripts}const Cn="firebaseLocalStorageDb",Sn="firebaseLocalStorage",kn="fbase_key";class An{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function xn(t,e){return t.transaction([Sn],e?"readwrite":"readonly").objectStore(Sn)}function Rn(){const t=indexedDB.open(Cn,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Sn,{keyPath:kn})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Sn)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Cn);return new An(t).toPromise()}(),e(await Rn()))}))}))}async function Nn(t,e,n){const i=xn(t,!0).put({[kn]:e,value:n});return new An(i).toPromise()}function Dn(t,e){const n=xn(t,!0).delete(e);return new An(n).toPromise()}class On{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Rn()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return In()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bn._getInstance(In()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new En(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Rn();return await Nn(t,pn,"1"),await Dn(t,pn),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Nn(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=xn(t,!1).get(e),i=await new An(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Dn(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=xn(t,!1).getAll();return new An(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}On.type="LOCAL";const Ln=On;Fe("rcb"),new Ht(3e4,6e4);class Pn{constructor(t){this.providerId=Pn.PROVIDER_ID,this.auth=Pe(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(Ft("string"==typeof r,t,"argument-error"),Ft("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){Ft("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Xt(t,"POST","/v2/accounts/mfaEnrollment:start",Qt(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Ft("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;Ft(n,t,"missing-multi-factor-info");const o=await function(t,e){return Xt(t,"POST","/v2/accounts/mfaSignIn:start",Qt(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Xt(t,"POST","/v1/accounts:sendVerificationCode",Qt(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,k(e))}static credential(t,e){return Je._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Pn.credentialFromTaggedObject(e)}static credentialFromError(t){return Pn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Je._fromTokenResponse(e,n):null}}Pn.PROVIDER_ID="phone",Pn.PHONE_SIGN_IN_METHOD="phone";class Mn extends He{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return We(t,this._buildIdpRequest())}_linkToIdToken(t,e){return We(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return We(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Un(t){return dn(t.auth,new Mn(t),t.bypassAuthState)}function Fn(t){const{auth:e,user:n}=t;return Ft(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await ce(t,un(i,r,e,t),n);Ft(s.idToken,i,"internal-error");const o=ae(s.idToken);Ft(o,i,"internal-error");const{sub:a}=o;return Ft(t.uid===a,i,"user-mismatch"),cn._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Pt(i,"user-mismatch"),t}}(n,new Mn(t),t.bypassAuthState)}async function Vn(t){const{auth:e,user:n}=t;return Ft(n,e,"internal-error"),async function(t,e,n=!1){const i=await ce(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return cn._forOperation(t,"link",i)}(n,new Mn(t),t.bypassAuthState)}class jn{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Un;case"linkViaPopup":case"linkViaRedirect":return Vn;case"reauthViaPopup":case"reauthViaRedirect":return Fn;default:Pt(this.auth,"internal-error")}}resolve(t){jt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){jt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Bn=new Ht(2e3,1e4);class zn extends jn{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,zn.currentPopupAction&&zn.currentPopupAction.cancel(),zn.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Ft(t,this.auth,"internal-error"),t}async onExecution(){jt(1===this.filter.length,"Popup operations only handle one event");const t=_n();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Mt(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Mt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zn.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Mt(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,Bn.get())};t()}}zn.currentPopupAction=null;const qn="pendingRedirect",Hn=new Map;class $n extends jn{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Hn.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return we(qn,t.config.apiKey,t.name)}(e),i=function(t){return ge(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}Hn.set(this.auth._key(),t)}return this.bypassAuthState||Hn.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Kn(t,e){Hn.set(t._key(),e)}async function Gn(t,e,n=!1){const i=Pe(t),r=function(t,e){return e?ge(e):(Ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),s=new $n(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class Wn{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Xn(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Xn(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Mt(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qn(t))}saveEventToCache(t){this.cachedEventUids.add(Qn(t)),this.lastProcessedEventTime=Date.now()}}function Qn(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Xn({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const Jn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Yn=/^https?/;function Zn(t){const e=Bt(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Yn.test(n))return!1;if(Jn.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const ti=new Ht(3e4,6e4);function ei(){const t=Tn().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let ni=null;function ii(t){return ni=ni||function(t){return new Promise(((e,n)=>{var i,r,s;function o(){ei(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ei(),n(Mt(t,"network-request-failed"))},timeout:ti.get()})}if(null===(r=null===(i=Tn().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Tn().gapi)||void 0===s?void 0:s.load)){const e=Fe("iframefcb");return Tn()[e]=()=>{gapi.load?o():n(Mt(t,"network-request-failed"))},Ue(`https://apis.google.com/js/api.js?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw ni=null,t}))}(t),ni}const ri=new Ht(5e3,15e3),si={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ai(t){const e=t.config;Ft(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?$t(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:mt},r=oi.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${E(i).slice(1)}`}const ci={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class li{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const hi=encodeURIComponent("fac");async function ui(t,e,n,i,r,s){Ft(t.config.authDomain,t,"auth-domain-config-required"),Ft(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:mt,eventId:r};if(e instanceof tn){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof en){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const c=await t._getAppCheckToken(),l=c?`#${hi}=${encodeURIComponent(c)}`:"";return`${function({config:t}){return t.emulator?$t(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${E(a).slice(1)}${l}`}const di="webStorageSupport",fi=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wn,this._completeRedirectFn=Gn,this._overrideRedirectResult=Kn}async _openPopup(t,e,n,i){var r;return jt(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},ci),{width:i.toString(),height:r.toString(),top:s,left:o}),l=m().toLowerCase();n&&(a=Ie(l)?"_blank":n),Ee(l)&&(e=e||"http://localhost",c.scrollbars="yes");const h=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=m()){var e;return xe(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",a),new li(null);const u=window.open(e||"",a,h);Ft(u,t,"popup-blocked");try{u.focus()}catch(t){}return new li(u)}(t,await ui(t,e,n,Bt(),i),_n())}async _openRedirect(t,e,n,i){return await this._originValidation(t),r=await ui(t,e,n,Bt(),i),Tn().location.href=r,new Promise((()=>{}));var r}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(jt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await ii(t),n=Tn().gapi;return Ft(n,t,"internal-error"),e.open({where:document.body,url:ai(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:si,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=Mt(t,"network-request-failed"),s=Tn().setTimeout((()=>{i(r)}),ri.get());function o(){Tn().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new Wn(t);return e.register("authEvent",(e=>(Ft(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(di,{type:di},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[di];void 0!==r&&e(!!r),Pt(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Xt(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Zn(t))return}catch(t){}Pt(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Re()||Te()||xe()}};var pi="@firebase/auth",mi="1.5.1";class gi{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const vi=d("authIdTokenMaxAge")||300;let yi=null;var wi;wi="Browser",ut(new A("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Ft(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:wi,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ne(wi)},c=new Le(n,i,r,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(ge);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(c,e),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),ut(new A("auth-internal",(t=>(t=>new gi(t))(Pe(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),yt(pi,mi,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(wi)),yt(pi,mi,"esm2017"),yt("firebase","10.7.2","app");var bi,_i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ei={},Ti=Ti||{},Ii=_i||self;function Ci(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Si(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ki="closure_uid_"+(1e9*Math.random()>>>0),Ai=0;function xi(t,e,n){return t.call.apply(t.bind,arguments)}function Ri(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ni(t,e,n){return(Ni=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?xi:Ri).apply(null,arguments)}function Di(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Oi(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function Li(){this.s=this.s,this.o=this.o}Li.prototype.s=!1,Li.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,ki)&&t[ki]||(t[ki]=++Ai))},Li.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Pi=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Mi(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Ui(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Ci(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function Fi(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Fi.prototype.h=function(){this.defaultPrevented=!0};var Vi=function(){if(!Ii.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};Ii.addEventListener("test",t,e),Ii.removeEventListener("test",t,e)}catch(t){}return t}();function ji(t){return/^[\s\xa0]*$/.test(t)}function Bi(){var t=Ii.navigator;return t&&(t=t.userAgent)?t:""}function zi(t){return-1!=Bi().indexOf(t)}function qi(t){return qi[" "](t),t}qi[" "]=function(){};var Hi,$i,Ki,Gi=zi("Opera"),Wi=zi("Trident")||zi("MSIE"),Qi=zi("Edge"),Xi=Qi||Wi,Ji=zi("Gecko")&&!(-1!=Bi().toLowerCase().indexOf("webkit")&&!zi("Edge"))&&!(zi("Trident")||zi("MSIE"))&&!zi("Edge"),Yi=-1!=Bi().toLowerCase().indexOf("webkit")&&!zi("Edge");function Zi(){var t=Ii.document;return t?t.documentMode:void 0}t:{var tr="",er=($i=Bi(),Ji?/rv:([^\);]+)(\)|;)/.exec($i):Qi?/Edge\/([\d\.]+)/.exec($i):Wi?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec($i):Yi?/WebKit\/(\S+)/.exec($i):Gi?/(?:Version)[ \/]?(\S+)/.exec($i):void 0);if(er&&(tr=er?er[1]:""),Wi){var nr=Zi();if(null!=nr&&nr>parseFloat(tr)){Hi=String(nr);break t}}Hi=tr}Ii.document&&Wi?Ki=Zi()||parseInt(Hi,10)||void 0:Ki=void 0;var ir=Ki;function rr(t,e){if(Fi.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Ji){t:{try{qi(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:sr[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&rr.$.h.call(this)}}Oi(rr,Fi);var sr={2:"touch",3:"pen",4:"mouse"};rr.prototype.h=function(){rr.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var or="closure_listenable_"+(1e6*Math.random()|0),ar=0;function cr(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++ar,this.fa=this.ia=!1}function lr(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function hr(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function ur(t){const e={};for(const n in t)e[n]=t[n];return e}const dr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fr(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<dr.length;e++)n=dr[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function pr(t){this.src=t,this.g={},this.h=0}function mr(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=Pi(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(lr(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function gr(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==i)return r}return-1}pr.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=gr(t,e,i,r);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new cr(e,this.src,s,!!i,r)).ia=n,t.push(e)),e};var vr="closure_lm_"+(1e6*Math.random()|0),yr={};function wr(t,e,n,i,r){if(i&&i.once)return _r(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)wr(t,e[s],n,i,r);return null}return n=Ar(n),t&&t[or]?t.O(e,n,Si(i)?!!i.capture:!!i,r):br(t,e,n,!1,i,r)}function br(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=Si(r)?!!r.capture:!!r,a=Sr(t);if(a||(t[vr]=a=new pr(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){const t=Cr;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Vi||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ir(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function _r(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)_r(t,e[s],n,i,r);return null}return n=Ar(n),t&&t[or]?t.P(e,n,Si(i)?!!i.capture:!!i,r):br(t,e,n,!0,i,r)}function Er(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Er(t,e[s],n,i,r);else i=Si(i)?!!i.capture:!!i,n=Ar(n),t&&t[or]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=gr(s=t.g[e],n,i,r))&&(lr(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=Sr(t))&&(e=t.g[e.toString()],t=-1,e&&(t=gr(e,n,i,r)),(n=-1<t?e[t]:null)&&Tr(n))}function Tr(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[or])mr(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ir(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Sr(e))?(mr(n,t),0==n.h&&(n.src=null,e[vr]=null)):lr(t)}}}function Ir(t){return t in yr?yr[t]:yr[t]="on"+t}function Cr(t,e){if(t.fa)t=!0;else{e=new rr(e,this);var n=t.listener,i=t.la||t.src;t.ia&&Tr(t),t=n.call(i,e)}return t}function Sr(t){return(t=t[vr])instanceof pr?t:null}var kr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ar(t){return"function"==typeof t?t:(t[kr]||(t[kr]=function(e){return t.handleEvent(e)}),t[kr])}function xr(){Li.call(this),this.i=new pr(this),this.S=this,this.J=null}function Rr(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new Fi(e,t);else if(e instanceof Fi)e.target=e.target||t;else{var r=e;fr(e=new Fi(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Nr(o,i,!0,e)&&r}if(r=Nr(o=e.g=t,i,!0,e)&&r,r=Nr(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Nr(o=e.g=n[s],i,!1,e)&&r}function Nr(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&mr(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}Oi(xr,Li),xr.prototype[or]=!0,xr.prototype.removeEventListener=function(t,e,n,i){Er(this,t,e,n,i)},xr.prototype.N=function(){if(xr.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)lr(n[i]);delete e.g[t],e.h--}}this.J=null},xr.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},xr.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Dr=Ii.JSON.stringify;function Or(){var t=jr;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Lr=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Pr),(t=>t.reset()));class Pr{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Mr(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Ur(t){Ii.setTimeout((()=>{throw t}),0)}let Fr,Vr=!1,jr=new class{constructor(){this.h=this.g=null}add(t,e){const n=Lr.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},Br=()=>{const t=Ii.Promise.resolve(void 0);Fr=()=>{t.then(zr)}};var zr=()=>{for(var t;t=Or();){try{t.h.call(t.g)}catch(t){Ur(t)}var e=Lr;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Vr=!1};function qr(t,e){xr.call(this),this.h=t||1,this.g=e||Ii,this.j=Ni(this.qb,this),this.l=Date.now()}function Hr(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function $r(t,e,n){if("function"==typeof t)n&&(t=Ni(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ni(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ii.setTimeout(t,e||0)}function Kr(t){t.g=$r((()=>{t.g=null,t.i&&(t.i=!1,Kr(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Oi(qr,xr),(bi=qr.prototype).ga=!1,bi.T=null,bi.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Rr(this,"tick"),this.ga&&(Hr(this),this.start()))}},bi.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},bi.N=function(){qr.$.N.call(this),Hr(this),delete this.g};class Gr extends Li{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Kr(this)}N(){super.N(),this.g&&(Ii.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wr(t){Li.call(this),this.h=t,this.g={}}Oi(Wr,Li);var Qr=[];function Xr(t,e,n,i){Array.isArray(n)||(n&&(Qr[0]=n.toString()),n=Qr);for(var r=0;r<n.length;r++){var s=wr(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Jr(t){hr(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Tr(t)}),t),t.g={}}function Yr(){this.g=!0}function Zr(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Dr(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Wr.prototype.N=function(){Wr.$.N.call(this),Jr(this)},Wr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Yr.prototype.Ea=function(){this.g=!1},Yr.prototype.info=function(){};var ts={},es=null;function ns(){return es=es||new xr}function is(t){Fi.call(this,ts.Ta,t)}function rs(t){const e=ns();Rr(e,new is(e))}function ss(t,e){Fi.call(this,ts.STAT_EVENT,t),this.stat=e}function os(t){const e=ns();Rr(e,new ss(e,t))}function as(t,e){Fi.call(this,ts.Ua,t),this.size=e}function cs(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ii.setTimeout((function(){t()}),e)}ts.Ta="serverreachability",Oi(is,Fi),ts.STAT_EVENT="statevent",Oi(ss,Fi),ts.Ua="timingevent",Oi(as,Fi);var ls={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},hs={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function us(){}function ds(t){return t.h||(t.h=t.i())}function fs(){}us.prototype.h=null;var ps,ms={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function gs(){Fi.call(this,"d")}function vs(){Fi.call(this,"c")}function ys(){}function ws(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new Wr(this),this.P=_s,t=Xi?125:void 0,this.V=new qr(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new bs}function bs(){this.i=null,this.g="",this.h=!1}Oi(gs,Fi),Oi(vs,Fi),Oi(ys,us),ys.prototype.g=function(){return new XMLHttpRequest},ys.prototype.i=function(){return{}},ps=new ys;var _s=45e3,Es={},Ts={};function Is(t,e,n){t.L=1,t.A=qs(Fs(e)),t.u=n,t.S=!0,Cs(t,null)}function Cs(t,e){t.G=Date.now(),xs(t),t.B=Fs(t.A);var n=t.B,i=t.W;Array.isArray(i)||(i=[String(i)]),no(n.i,"t",i),t.o=0,n=t.l.J,t.h=new bs,t.g=ia(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Gr(Ni(t.Pa,t,t.g),t.O)),Xr(t.U,t.g,"readystatechange",t.nb),e=t.I?ur(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),rs(),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var h=l[0];l=l[1];var u=h.split("_");o=2<=u.length&&"type"==u[1]?o+(h+"=")+l+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function Ss(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function ks(t,e,n){let i,r=!0;for(;!t.J&&t.o<n.length;){if(i=As(t,n),i==Ts){4==e&&(t.s=4,os(14),r=!1),Zr(t.j,t.m,null,"[Incomplete Response]");break}if(i==Es){t.s=4,os(15),Zr(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Zr(t.j,t.m,i,null),Ls(t,i)}Ss(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,os(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qo(e),e.M=!0,os(11))):(Zr(t.j,t.m,n,"[Invalid Chunked Response]"),Os(t),Ds(t))}function As(t,e){var n=t.o,i=e.indexOf("\n",n);return-1==i?Ts:(n=Number(e.substring(n,i)),isNaN(n)?Es:(i+=1)+n>e.length?Ts:(e=e.slice(i,i+n),t.o=i+n,e))}function xs(t){t.Y=Date.now()+t.P,Rs(t,t.P)}function Rs(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=cs(Ni(t.lb,t),e)}function Ns(t){t.C&&(Ii.clearTimeout(t.C),t.C=null)}function Ds(t){0==t.l.H||t.J||Yo(t.l,t)}function Os(t){Ns(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Hr(t.V),Jr(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Ls(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||lo(n.i,t)))if(!t.K&&lo(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;Jo(n),Bo(n)}Wo(n),os(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=cs(Ni(n.ib,n),6e3));if(1>=co(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else ta(n,11)}else if((t.K||n.g==t)&&Jo(n),!ji(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const e=l[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const r=l[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const h=l[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ho(s,s.h),s.h=null))}if(i.F){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,zs(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((i=n).wa=na(i,i.J?i.pa:null,i.Y),o.K){uo(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.C&&(Ns(a),xs(a)),i.g=o}else Go(i);0<n.j.length&&qo(n)}else"stop"!=l[0]&&"close"!=l[0]||ta(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?ta(n,7):jo(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}rs()}catch(t){}}function Ps(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Ci(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Ci(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Ci(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(bi=ws.prototype).setTimeout=function(t){this.P=t},bi.nb=function(t){t=t.target;const e=this.M;e&&3==Lo(t)?e.l():this.Pa(t)},bi.Pa=function(t){try{if(t==this.g)t:{const h=Lo(this.g);var e=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||Xi||this.g&&(this.h.h||this.g.ja()||Po(this.g)))){this.J||4!=h||7==e||rs(),Ns(this);var n=this.g.da();this.ca=n;e:if(Ss(this)){var i=Po(this.g);t="";var r=i.length,s=4==Lo(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Os(this),Ds(this);var o="";break e}this.h.i=new Ii.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ji(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.s=3,os(12),Os(this),Ds(this);break t}Zr(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ls(this,n)}this.S?(ks(this,h,o),Xi&&this.i&&3==h&&(Xr(this.U,this.V,"tick",this.mb),this.V.start())):(Zr(this.j,this.m,o,null),Ls(this,o)),4==h&&Os(this),this.i&&!this.J&&(4==h?Yo(this.l,this):(this.i=!1,xs(this)))}else(function(t){const e={};t=(t.g&&2<=Lo(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(ji(t[i]))continue;var n=Mr(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[r]||[];e[r]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,os(12)):(this.s=0,os(13)),Os(this),Ds(this)}}}catch(t){}},bi.mb=function(){if(this.g){var t=Lo(this.g),e=this.g.ja();this.o<e.length&&(Ns(this),ks(this,t,e),this.i&&4!=t&&xs(this))}},bi.cancel=function(){this.J=!0,Os(this)},bi.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(rs(),os(17)),Os(this),this.s=2,Ds(this)):Rs(this,this.Y-t)};var Ms=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Us(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Us){this.h=t.h,Vs(this,t.j),this.s=t.s,this.g=t.g,js(this,t.m),this.l=t.l;var e=t.i,n=new Ys;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Bs(this,n),this.o=t.o}else t&&(e=String(t).match(Ms))?(this.h=!1,Vs(this,e[1]||"",!0),this.s=Hs(e[2]||""),this.g=Hs(e[3]||"",!0),js(this,e[4]),this.l=Hs(e[5]||"",!0),Bs(this,e[6]||"",!0),this.o=Hs(e[7]||"")):(this.h=!1,this.i=new Ys(null,this.h))}function Fs(t){return new Us(t)}function Vs(t,e,n){t.j=n?Hs(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function js(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Bs(t,e,n){e instanceof Ys?(t.i=e,function(t,e){e&&!t.j&&(Zs(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(to(this,e),no(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=$s(e,Xs)),t.i=new Ys(e,t.h))}function zs(t,e,n){t.i.set(e,n)}function qs(t){return zs(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Hs(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function $s(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ks),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ks(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Us.prototype.toString=function(){var t=[],e=this.j;e&&t.push($s(e,Gs,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push($s(e,Gs,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push($s(n,"/"==n.charAt(0)?Qs:Ws,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",$s(n,Js)),t.join("")};var Gs=/[#\/\?@]/g,Ws=/[#\?:]/g,Qs=/[#\?]/g,Xs=/[#\?@]/g,Js=/#/g;function Ys(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Zs(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function to(t,e){Zs(t),e=io(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function eo(t,e){return Zs(t),e=io(t,e),t.g.has(e)}function no(t,e,n){to(t,e),0<n.length&&(t.i=null,t.g.set(io(t,e),Mi(n)),t.h+=n.length)}function io(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(bi=Ys.prototype).add=function(t,e){Zs(this),this.i=null,t=io(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},bi.forEach=function(t,e){Zs(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},bi.ta=function(){Zs(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},bi.Z=function(t){Zs(this);let e=[];if("string"==typeof t)eo(this,t)&&(e=e.concat(this.g.get(io(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},bi.set=function(t,e){return Zs(this),this.i=null,eo(this,t=io(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},bi.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},bi.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var ro=class{constructor(t,e){this.g=t,this.map=e}};function so(t){this.l=t||oo,t=Ii.PerformanceNavigationTiming?0<(t=Ii.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Ii.g&&Ii.g.Ka&&Ii.g.Ka()&&Ii.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var oo=10;function ao(t){return!!t.h||!!t.g&&t.g.size>=t.j}function co(t){return t.h?1:t.g?t.g.size:0}function lo(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ho(t,e){t.g?t.g.add(e):t.h=e}function uo(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function fo(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Mi(t.i)}so.prototype.cancel=function(){if(this.i=fo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var po=class{stringify(t){return Ii.JSON.stringify(t,void 0)}parse(t){return Ii.JSON.parse(t,void 0)}};function mo(){this.g=new po}function go(t,e,n){const i=n||"";try{Ps(t,(function(t,n){let r=t;Si(t)&&(r=Dr(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function vo(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function yo(t){this.l=t.ec||null,this.j=t.ob||!1}function wo(t,e){xr.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=bo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Oi(yo,us),yo.prototype.g=function(){return new wo(this.l,this.j)},yo.prototype.i=function(t){return function(){return t}}({}),Oi(wo,xr);var bo=0;function _o(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function Eo(t){t.readyState=4,t.l=null,t.j=null,t.A=null,To(t)}function To(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(bi=wo.prototype).open=function(t,e){if(this.readyState!=bo)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,To(this)},bi.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Ii).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},bi.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Eo(this)),this.readyState=bo},bi.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,To(this)),this.g&&(this.readyState=3,To(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Ii.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;_o(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},bi.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Eo(this):To(this),3==this.readyState&&_o(this)}},bi.Za=function(t){this.g&&(this.response=this.responseText=t,Eo(this))},bi.Ya=function(t){this.g&&(this.response=t,Eo(this))},bi.ka=function(){this.g&&Eo(this)},bi.setRequestHeader=function(t,e){this.v.append(t,e)},bi.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},bi.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(wo.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Io=Ii.JSON.parse;function Co(t){xr.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=So,this.L=this.M=!1}Oi(Co,xr);var So="",ko=/^https?$/i,Ao=["POST","PUT"];function xo(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ro(t),Do(t)}function Ro(t){t.F||(t.F=!0,Rr(t,"complete"),Rr(t,"error"))}function No(t){if(t.h&&void 0!==Ti&&(!t.C[1]||4!=Lo(t)||2!=t.da()))if(t.v&&4==Lo(t))$r(t.La,0,t);else if(Rr(t,"readystatechange"),4==Lo(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var r=String(t.I).match(Ms)[1]||null;!r&&Ii.self&&Ii.self.location&&(r=Ii.self.location.protocol.slice(0,-1)),i=!ko.test(r?r.toLowerCase():"")}n=i}if(n)Rr(t,"complete"),Rr(t,"success");else{t.m=6;try{var s=2<Lo(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",Ro(t)}}finally{Do(t)}}}function Do(t,e){if(t.g){Oo(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Rr(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Oo(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Ii.clearTimeout(t.A),t.A=null)}function Lo(t){return t.g?t.g.readyState:0}function Po(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case So:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Mo(t){let e="";return hr(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Uo(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Mo(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):zs(t,e,n))}function Fo(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Vo(t){this.Ga=0,this.j=[],this.l=new Yr,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Fo("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Fo("baseRetryDelayMs",5e3,t),this.hb=Fo("retryDelaySeedMs",1e4,t),this.eb=Fo("forwardChannelMaxRetries",2,t),this.xa=Fo("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new so(t&&t.concurrentRequestLimit),this.Ja=new mo,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function jo(t){if(zo(t),3==t.H){var e=t.W++,n=Fs(t.I);if(zs(n,"SID",t.K),zs(n,"RID",e),zs(n,"TYPE","terminate"),$o(t,n),(e=new ws(t,t.l,e)).L=2,e.A=qs(Fs(n)),n=!1,Ii.navigator&&Ii.navigator.sendBeacon)try{n=Ii.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&Ii.Image&&((new Image).src=e.A,n=!0),n||(e.g=ia(e.l,null),e.g.ha(e.A)),e.G=Date.now(),xs(e)}ea(t)}function Bo(t){t.g&&(Qo(t),t.g.cancel(),t.g=null)}function zo(t){Bo(t),t.u&&(Ii.clearTimeout(t.u),t.u=null),Jo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ii.clearTimeout(t.m),t.m=null)}function qo(t){if(!ao(t.i)&&!t.m){t.m=!0;var e=t.Na;Fr||Br(),Vr||(Fr(),Vr=!0),jr.add(e,t),t.C=0}}function Ho(t,e){var n;n=e?e.m:t.W++;const i=Fs(t.I);zs(i,"SID",t.K),zs(i,"RID",n),zs(i,"AID",t.V),$o(t,i),t.o&&t.s&&Uo(i,t.o,t.s),n=new ws(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Ko(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),ho(t.i,n),Is(n,i,e)}function $o(t,e){t.na&&hr(t.na,(function(t,n){zs(e,n,t)})),t.h&&Ps({},(function(t,n){zs(e,n,t)}))}function Ko(t,e,n){n=Math.min(t.j.length,n);var i=t.h?Ni(t.h.Va,t.h,t):null;t:{var r=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=e,0>n)e=Math.max(0,r[o].g-100),s=!1;else try{go(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function Go(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Fr||Br(),Vr||(Fr(),Vr=!0),jr.add(e,t),t.A=0}}function Wo(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=cs(Ni(t.Ma,t),Zo(t,t.A)),t.A++,0))}function Qo(t){null!=t.B&&(Ii.clearTimeout(t.B),t.B=null)}function Xo(t){t.g=new ws(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Fs(t.wa);zs(e,"RID","rpc"),zs(e,"SID",t.K),zs(e,"AID",t.V),zs(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&zs(e,"TO",t.qa),zs(e,"TYPE","xmlhttp"),$o(t,e),t.o&&t.s&&Uo(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=qs(Fs(e)),n.u=null,n.S=!0,Cs(n,t)}function Jo(t){null!=t.v&&(Ii.clearTimeout(t.v),t.v=null)}function Yo(t,e){var n=null;if(t.g==e){Jo(t),Qo(t),t.g=null;var i=2}else{if(!lo(t.i,e))return;n=e.F,uo(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.u?e.u.length:0,e=Date.now()-e.G;var r=t.C;Rr(i=ns(),new as(i,n)),qo(t)}else Go(t);else if(3==(r=e.s)||0==r&&0<e.ca||!(1==i&&function(t,e){return!(co(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=cs(Ni(t.Na,t,e),Zo(t,t.C)),t.C++,0)))}(t,e)||2==i&&Wo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:ta(t,5);break;case 4:ta(t,10);break;case 3:ta(t,6);break;default:ta(t,2)}}function Zo(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ta(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=Ni(t.pb,t);n||(n=new Us("//www.google.com/images/cleardot.gif"),Ii.location&&"http"==Ii.location.protocol||Vs(n,"https"),qs(n)),function(t,e){const n=new Yr;if(Ii.Image){const i=new Image;i.onload=Di(vo,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Di(vo,n,i,"TestLoadImage: error",!1,e),i.onabort=Di(vo,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Di(vo,n,i,"TestLoadImage: timeout",!1,e),Ii.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else os(2);t.H=0,t.h&&t.h.za(e),ea(t),zo(t)}function ea(t){if(t.H=0,t.ma=[],t.h){const e=fo(t.i);0==e.length&&0==t.j.length||(Ui(t.ma,e),Ui(t.ma,t.j),t.i.i.length=0,Mi(t.j),t.j.length=0),t.h.ya()}}function na(t,e,n){var i=n instanceof Us?Fs(n):new Us(n);if(""!=i.g)e&&(i.g=e+"."+i.g),js(i,i.m);else{var r=Ii.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Us(null);i&&Vs(s,i),e&&(s.g=e),r&&js(s,r),n&&(s.l=n),i=s}return n=t.F,e=t.Da,n&&e&&zs(i,n,e),zs(i,"VER",t.ra),$o(t,i),i}function ia(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Co(new yo({ob:n})):new Co(t.va)).Oa(t.J),e}function ra(){}function sa(){if(Wi&&!(10<=Number(ir)))throw Error("Environmental error: no available transport.")}function oa(t,e){xr.call(this),this.g=new Vo(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ji(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ji(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new la(this)}function aa(t){gs.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ca(){vs.call(this),this.status=1}function la(t){this.g=t}function ha(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ua(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}function da(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=0|t[r];i&&s==e||(n[r]=s,i=!1)}this.g=n}(bi=Co.prototype).Oa=function(t){this.M=t},bi.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ps.g(),this.C=this.u?ds(this.u):ds(ps),this.g.onreadystatechange=Ni(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void xo(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=Ii.FormData&&t instanceof Ii.FormData,!(0<=Pi(Ao,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Oo(this),0<this.B&&((this.L=function(t){return Wi&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ni(this.ua,this)):this.A=$r(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){xo(this,t)}},bi.ua=function(){void 0!==Ti&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Rr(this,"timeout"),this.abort(8))},bi.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Rr(this,"complete"),Rr(this,"abort"),Do(this))},bi.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Do(this,!0)),Co.$.N.call(this)},bi.La=function(){this.s||(this.G||this.v||this.l?No(this):this.kb())},bi.kb=function(){No(this)},bi.isActive=function(){return!!this.g},bi.da=function(){try{return 2<Lo(this)?this.g.status:-1}catch(t){return-1}},bi.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},bi.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Io(e)}},bi.Ia=function(){return this.m},bi.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(bi=Vo.prototype).ra=8,bi.H=1,bi.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new ws(this,this.l,t);let s=this.s;if(this.U&&(s?(s=ur(s),fr(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Ko(this,r,e),zs(n=Fs(this.I),"RID",t),zs(n,"CVER",22),this.F&&zs(n,"X-HTTP-Session-Id",this.F),$o(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Mo(s)))+"&"+e:this.o&&Uo(n,this.o,s)),ho(this.i,r),this.bb&&zs(n,"TYPE","init"),this.P?(zs(n,"$req",e),zs(n,"SID","null"),r.aa=!0,Is(r,n,null)):Is(r,n,e),this.H=2}}else 3==this.H&&(t?Ho(this,t):0==this.j.length||ao(this.i)||Ho(this))},bi.Ma=function(){if(this.u=null,Xo(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=cs(Ni(this.jb,this),t)}},bi.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,os(10),Bo(this),Xo(this))},bi.ib=function(){null!=this.v&&(this.v=null,Bo(this),Wo(this),os(19))},bi.pb=function(t){t?(this.l.info("Successfully pinged google.com"),os(2)):(this.l.info("Failed to ping google.com"),os(1))},bi.isActive=function(){return!!this.h&&this.h.isActive(this)},(bi=ra.prototype).Ba=function(){},bi.Aa=function(){},bi.za=function(){},bi.ya=function(){},bi.isActive=function(){return!0},bi.Va=function(){},sa.prototype.g=function(t,e){return new oa(t,e)},Oi(oa,xr),oa.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;os(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=na(t,null,t.Y),qo(t)},oa.prototype.close=function(){jo(this.g)},oa.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Dr(t),t=n);e.j.push(new ro(e.fb++,t)),3==e.H&&qo(e)},oa.prototype.N=function(){this.g.h=null,delete this.j,jo(this.g),delete this.g,oa.$.N.call(this)},Oi(aa,gs),Oi(ca,vs),Oi(la,ra),la.prototype.Ba=function(){Rr(this.g,"a")},la.prototype.Aa=function(t){Rr(this.g,new aa(t))},la.prototype.za=function(t){Rr(this.g,new ca)},la.prototype.ya=function(){Rr(this.g,"b")},Oi(ha,(function(){this.blockSize=-1})),ha.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},ha.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=n;)ua(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(i[r++]=t.charCodeAt(s++),r==this.blockSize){ua(this,i),r=0;break}}else for(;s<e;)if(i[r++]=t[s++],r==this.blockSize){ua(this,i),r=0;break}}this.h=r,this.i+=e},ha.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var fa={};function pa(t){return-128<=t&&128>t?function(t,e){var n=fa;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new da([0|t],0>t?-1:0)}(t)}(t):new da([0|t],0>t?-1:0)}function ma(t){if(isNaN(t)||!isFinite(t))return va;if(0>t)return Ea(ma(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=ga;return new da(e,0)}var ga=4294967296,va=pa(0),ya=pa(1),wa=pa(16777216);function ba(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function _a(t){return-1==t.h}function Ea(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new da(n,~t.h).add(ya)}function Ta(t,e){return t.add(Ea(e))}function Ia(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ca(t,e){this.g=t,this.h=e}function Sa(t,e){if(ba(e))throw Error("division by zero");if(ba(t))return new Ca(va,va);if(_a(t))return e=Sa(Ea(t),e),new Ca(Ea(e.g),Ea(e.h));if(_a(e))return e=Sa(t,Ea(e)),new Ca(Ea(e.g),e.h);if(30<t.g.length){if(_a(t)||_a(e))throw Error("slowDivide_ only works with positive integers.");for(var n=ya,i=e;0>=i.X(t);)n=ka(n),i=ka(i);var r=Aa(n,1),s=Aa(i,1);for(i=Aa(i,2),n=Aa(n,2);!ba(i);){var o=s.add(i);0>=o.X(t)&&(r=r.add(n),s=o),i=Aa(i,1),n=Aa(n,1)}return e=Ta(t,r.R(e)),new Ca(r,e)}for(r=va;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=ma(n)).R(e);_a(o)||0<o.X(t);)o=(s=ma(n-=i)).R(e);ba(s)&&(s=ya),r=r.add(s),t=Ta(t,o)}return new Ca(r,t)}function ka(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new da(n,t.h)}function Aa(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new da(r,t.h)}(bi=da.prototype).ea=function(){if(_a(this))return-Ea(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:ga+i)*e,e*=ga}return t},bi.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(ba(this))return"0";if(_a(this))return"-"+Ea(this).toString(t);for(var e=ma(Math.pow(t,6)),n=this,i="";;){var r=Sa(n,e).g,s=((0<(n=Ta(n,r.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(ba(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},bi.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},bi.X=function(t){return _a(t=Ta(this,t))?-1:ba(t)?0:1},bi.abs=function(){return _a(this)?Ea(this):this},bi.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&t.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new da(n,-2147483648&n[n.length-1]?-1:0)},bi.R=function(t){if(ba(this)||ba(t))return va;if(_a(this))return _a(t)?Ea(this).R(Ea(t)):Ea(Ea(this).R(t));if(_a(t))return Ea(this.R(Ea(t)));if(0>this.X(wa)&&0>t.X(wa))return ma(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=t.D(r)>>>16,c=65535&t.D(r);n[2*i+2*r]+=o*c,Ia(n,2*i+2*r),n[2*i+2*r+1]+=s*c,Ia(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,Ia(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,Ia(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new da(n,0)},bi.gb=function(t){return Sa(this,t).h},bi.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new da(n,this.h&t.h)},bi.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new da(n,this.h|t.h)},bi.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new da(n,this.h^t.h)},sa.prototype.createWebChannel=sa.prototype.g,oa.prototype.send=oa.prototype.u,oa.prototype.open=oa.prototype.m,oa.prototype.close=oa.prototype.close,ls.NO_ERROR=0,ls.TIMEOUT=8,ls.HTTP_ERROR=6,hs.COMPLETE="complete",fs.EventType=ms,ms.OPEN="a",ms.CLOSE="b",ms.ERROR="c",ms.MESSAGE="d",xr.prototype.listen=xr.prototype.O,Co.prototype.listenOnce=Co.prototype.P,Co.prototype.getLastError=Co.prototype.Sa,Co.prototype.getLastErrorCode=Co.prototype.Ia,Co.prototype.getStatus=Co.prototype.da,Co.prototype.getResponseJson=Co.prototype.Wa,Co.prototype.getResponseText=Co.prototype.ja,Co.prototype.send=Co.prototype.ha,Co.prototype.setWithCredentials=Co.prototype.Oa,ha.prototype.digest=ha.prototype.l,ha.prototype.reset=ha.prototype.reset,ha.prototype.update=ha.prototype.j,da.prototype.add=da.prototype.add,da.prototype.multiply=da.prototype.R,da.prototype.modulo=da.prototype.gb,da.prototype.compare=da.prototype.X,da.prototype.toNumber=da.prototype.ea,da.prototype.toString=da.prototype.toString,da.prototype.getBits=da.prototype.D,da.fromNumber=ma,da.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return Ea(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=ma(Math.pow(n,8)),r=va,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=ma(Math.pow(n,o)),r=r.R(o).add(ma(a))):r=(r=r.R(i)).add(ma(a))}return r};var xa=Ei.createWebChannelTransport=function(){return new sa},Ra=Ei.getStatEventTarget=function(){return ns()},Na=Ei.ErrorCode=ls,Da=Ei.EventType=hs,Oa=Ei.Event=ts,La=Ei.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Pa=(Ei.FetchXmlHttpFactory=yo,Ei.WebChannel=fs),Ma=Ei.XhrIo=Co,Ua=Ei.Md5=ha,Fa=Ei.Integer=da;const Va="@firebase/firestore";class ja{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ja.UNAUTHENTICATED=new ja(null),ja.GOOGLE_CREDENTIALS=new ja("google-credentials-uid"),ja.FIRST_PARTY=new ja("first-party-uid"),ja.MOCK_USER=new ja("mock-user");let Ba="10.7.2";const za=new F("@firebase/firestore");function qa(){return za.logLevel}function Ha(t,...e){if(za.logLevel<=O.DEBUG){const n=e.map(Ga);za.debug(`Firestore (${Ba}): ${t}`,...n)}}function $a(t,...e){if(za.logLevel<=O.ERROR){const n=e.map(Ga);za.error(`Firestore (${Ba}): ${t}`,...n)}}function Ka(t,...e){if(za.logLevel<=O.WARN){const n=e.map(Ga);za.warn(`Firestore (${Ba}): ${t}`,...n)}}function Ga(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function Wa(t="Unexpected state"){const e=`FIRESTORE (${Ba}) INTERNAL ASSERTION FAILED: `+t;throw $a(e),new Error(e)}function Qa(t,e){t||Wa()}function Xa(t,e){return t}const Ja={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ya extends v{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Za{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class tc{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ec{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(ja.UNAUTHENTICATED)))}shutdown(){}}class nc{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class ic{constructor(t){this.t=t,this.currentUser=ja.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new Za;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Za,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Ha("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Ha("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Za)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ha("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Qa("string"==typeof e.accessToken),new tc(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Qa(null===t||"string"==typeof t),new ja(t)}}class rc{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=ja.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class sc{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new rc(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(ja.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class oc{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ac{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&Ha("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,Ha("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Ha("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):Ha("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Qa("string"==typeof t.token),this.R=t.token,new oc(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function cc(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class lc{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=cc(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function hc(t,e){return t<e?-1:t>e?1:0}function uc(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class dc{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ya(Ja.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ya(Ja.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ya(Ja.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ya(Ja.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return dc.fromMillis(Date.now())}static fromDate(t){return dc.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new dc(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?hc(this.nanoseconds,t.nanoseconds):hc(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class fc{constructor(t){this.timestamp=t}static fromTimestamp(t){return new fc(t)}static min(){return new fc(new dc(0,0))}static max(){return new fc(new dc(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class pc{constructor(t,e,n){void 0===e?e=0:e>t.length&&Wa(),void 0===n?n=t.length-e:n>t.length-e&&Wa(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===pc.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof pc?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class mc extends pc{construct(t,e,n){return new mc(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Ya(Ja.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new mc(e)}static emptyPath(){return new mc([])}}const gc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vc extends pc{construct(t,e,n){return new vc(t,e,n)}static isValidIdentifier(t){return gc.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vc.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new vc(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Ya(Ja.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Ya(Ja.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Ya(Ja.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new Ya(Ja.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new vc(e)}static emptyPath(){return new vc([])}}class yc{constructor(t){this.path=t}static fromPath(t){return new yc(mc.fromString(t))}static fromName(t){return new yc(mc.fromString(t).popFirst(5))}static empty(){return new yc(mc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===mc.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return mc.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new yc(new mc(t.slice()))}}function wc(t){return new bc(t.readTime,t.key,-1)}class bc{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new bc(fc.min(),yc.empty(),-1)}static max(){return new bc(fc.max(),yc.empty(),-1)}}function _c(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=yc.comparator(t.documentKey,e.documentKey),0!==n?n:hc(t.largestBatchId,e.largestBatchId))}const Ec="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tc{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Ic(t){if(t.code!==Ja.FAILED_PRECONDITION||t.message!==Ec)throw t;Ha("LocalStore","Unexpectedly lost primary lease")}class Cc{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Wa(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Cc(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Cc?e:Cc.resolve(e)}catch(t){return Cc.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Cc.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Cc.reject(e)}static resolve(t){return new Cc(((e,n)=>{e(t)}))}static reject(t){return new Cc(((e,n)=>{n(t)}))}static waitFor(t){return new Cc(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=Cc.resolve(!1);for(const n of t)e=e.next((t=>t?Cc.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Cc(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;e(t[c]).next((t=>{s[c]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new Cc(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}class Sc{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new Za,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new xc(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=Lc(e.target.error);this.V.reject(new xc(t,n))}}static open(t,e,n,i){try{return new Sc(e,t.transaction(i,n))}catch(t){throw new xc(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(Ha("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new Nc(e)}}class kc{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===kc.S(m())&&$a("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return Ha("SimpleDb","Removing database:",t),Dc(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!g())return!1;if(kc.C())return!0;const t=m(),e=kc.S(t),n=0<e&&e<10,i=kc.v(t),r=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||r)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(Ha("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=t=>{const n=t.target.result;e(n)},i.onblocked=()=>{n(new xc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=e=>{const i=e.target.error;"VersionError"===i.name?n(new Ya(Ja.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new Ya(Ja.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new xc(t,i))},i.onupgradeneeded=t=>{Ha("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,i.transaction,t.oldVersion,this.version).next((()=>{Ha("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,i){const r="readonly"===e;let s=0;for(;;){++s;try{this.db=await this.O(t);const e=Sc.open(this.db,t,r?"readonly":"readwrite",n),s=i(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),Cc.reject(t)))).toPromise();return s.catch((()=>{})),await e.m,s}catch(t){const e=t,n="FirebaseError"!==e.name&&s<3;if(Ha("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Ac{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Dc(this.k.delete())}}class xc extends Ya{constructor(t,e){super(Ja.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Rc(t){return"IndexedDbTransactionError"===t.name}class Nc{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(Ha("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ha("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Dc(n)}add(t){return Ha("SimpleDb","ADD",this.store.name,t,t),Dc(this.store.add(t))}get(t){return Dc(this.store.get(t)).next((e=>(void 0===e&&(e=null),Ha("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return Ha("SimpleDb","DELETE",this.store.name,t),Dc(this.store.delete(t))}count(){return Ha("SimpleDb","COUNT",this.store.name),Dc(this.store.count())}W(t,e){const n=this.options(t,e),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const t=i.getAll(n.range);return new Cc(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new Cc(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){Ha("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const i=this.cursor(n);return this.G(i,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const i=this.cursor(n);return this.G(i,e)}Z(t){const e=this.cursor({});return new Cc(((n,i)=>{e.onerror=t=>{const e=Lc(t.target.error);i(e)},e.onsuccess=e=>{const i=e.target.result;i?t(i.primaryKey,i.value).next((t=>{t?i.continue():n()})):n()}}))}G(t,e){const n=[];return new Cc(((i,r)=>{t.onerror=t=>{r(t.target.error)},t.onsuccess=t=>{const r=t.target.result;if(!r)return void i();const s=new Ac(r),o=e(r.primaryKey,r.value,s);if(o instanceof Cc){const t=o.catch((t=>(s.done(),Cc.reject(t))));n.push(t)}s.isDone?i():null===s.$?r.continue():r.continue(s.$)}})).next((()=>Cc.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Dc(t){return new Cc(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=Lc(t.target.error);n(e)}}))}let Oc=!1;function Lc(t){const e=kc.S(m());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new Ya("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Oc||(Oc=!0,setTimeout((()=>{throw t}),0)),t}}return t}class Pc{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function Mc(t){return null==t}function Uc(t){return 0===t&&1/t==-1/0}Pc._e=-1;function Fc(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Vc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jc(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Bc{constructor(t,e){this.comparator=t,this.root=e||qc.EMPTY}insert(t,e){return new Bc(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,qc.BLACK,null,null))}remove(t){return new Bc(this.comparator,this.root.remove(t,this.comparator).copy(null,null,qc.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new zc(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new zc(this.root,t,this.comparator,!1)}getReverseIterator(){return new zc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new zc(this.root,t,this.comparator,!0)}}class zc{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class qc{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:qc.RED,this.left=null!=i?i:qc.EMPTY,this.right=null!=r?r:qc.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new qc(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qc.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return qc.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,qc.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,qc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Wa();if(this.right.isRed())throw Wa();const t=this.left.check();if(t!==this.right.check())throw Wa();return t+(this.isRed()?0:1)}}qc.EMPTY=null,qc.RED=!0,qc.BLACK=!1,qc.EMPTY=new class{constructor(){this.size=0}get key(){throw Wa()}get value(){throw Wa()}get color(){throw Wa()}get left(){throw Wa()}get right(){throw Wa()}copy(t,e,n,i,r){return this}insert(t,e,n){return new qc(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hc{constructor(t){this.comparator=t,this.data=new Bc(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new $c(this.data.getIterator())}getIteratorFrom(t){return new $c(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Hc))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Hc(this.comparator);return e.data=t,e}}class $c{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Kc{constructor(t){this.fields=t,t.sort(vc.comparator)}static empty(){return new Kc([])}unionWith(t){let e=new Hc(vc.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new Kc(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return uc(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class Gc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Wc{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Gc("Invalid base64 string: "+t):t}}(t);return new Wc(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new Wc(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return hc(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Wc.EMPTY_BYTE_STRING=new Wc("");const Qc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xc(t){if(Qa(!!t),"string"==typeof t){let e=0;const n=Qc.exec(t);if(Qa(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Jc(t.seconds),nanos:Jc(t.nanos)}}function Jc(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Yc(t){return"string"==typeof t?Wc.fromBase64String(t):Wc.fromUint8Array(t)}function Zc(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function tl(t){const e=t.mapValue.fields.__previous_value__;return Zc(e)?tl(e):e}function el(t){const e=Xc(t.mapValue.fields.__local_write_time__.timestampValue);return new dc(e.seconds,e.nanos)}class nl{constructor(t,e,n,i,r,s,o,a,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class il{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new il("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof il&&t.projectId===this.projectId&&t.database===this.database}}const rl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function sl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zc(t)?4:yl(t)?9007199254740991:10:Wa()}function ol(t,e){if(t===e)return!0;const n=sl(t);if(n!==sl(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return el(t).isEqual(el(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=Xc(t.timestampValue),i=Xc(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Yc(t.bytesValue).isEqual(Yc(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Jc(t.geoPointValue.latitude)===Jc(e.geoPointValue.latitude)&&Jc(t.geoPointValue.longitude)===Jc(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Jc(t.integerValue)===Jc(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Jc(t.doubleValue),i=Jc(e.doubleValue);return n===i?Uc(n)===Uc(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return uc(t.arrayValue.values||[],e.arrayValue.values||[],ol);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Fc(n)!==Fc(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!ol(n[t],i[t])))return!1;return!0}(t,e);default:return Wa()}}function al(t,e){return void 0!==(t.values||[]).find((t=>ol(t,e)))}function cl(t,e){if(t===e)return 0;const n=sl(t),i=sl(e);if(n!==i)return hc(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return hc(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Jc(t.integerValue||t.doubleValue),i=Jc(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return ll(t.timestampValue,e.timestampValue);case 4:return ll(el(t),el(e));case 5:return hc(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Yc(t),i=Yc(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=hc(n[t],i[t]);if(0!==e)return e}return hc(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=hc(Jc(t.latitude),Jc(e.latitude));return 0!==n?n:hc(Jc(t.longitude),Jc(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=cl(n[t],i[t]);if(e)return e}return hc(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===rl.mapValue&&e===rl.mapValue)return 0;if(t===rl.mapValue)return 1;if(e===rl.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=hc(i[t],s[t]);if(0!==e)return e;const o=cl(n[i[t]],r[s[t]]);if(0!==o)return o}return hc(i.length,s.length)}(t.mapValue,e.mapValue);default:throw Wa()}}function ll(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return hc(t,e);const n=Xc(t),i=Xc(e),r=hc(n.seconds,i.seconds);return 0!==r?r:hc(n.nanos,i.nanos)}function hl(t){return ul(t)}function ul(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=Xc(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return Yc(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return yc.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=ul(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${ul(t.fields[r])}`;return n+"}"}(t.mapValue):Wa()}function dl(t){return!!t&&"integerValue"in t}function fl(t){return!!t&&"arrayValue"in t}function pl(t){return!!t&&"nullValue"in t}function ml(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function gl(t){return!!t&&"mapValue"in t}function vl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Vc(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=vl(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=vl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function yl(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class wl{constructor(t){this.value=t}static empty(){return new wl({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!gl(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=vl(e)}setAll(t){let e=vc.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=vl(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());gl(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ol(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];gl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){Vc(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new wl(vl(this.value))}}function bl(t){const e=[];return Vc(t.fields,((t,n)=>{const i=new vc([t]);if(gl(n)){const t=bl(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new Kc(e)}class _l{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new _l(t,0,fc.min(),fc.min(),fc.min(),wl.empty(),0)}static newFoundDocument(t,e,n,i){return new _l(t,1,e,fc.min(),n,i,0)}static newNoDocument(t,e){return new _l(t,2,e,fc.min(),fc.min(),wl.empty(),0)}static newUnknownDocument(t,e){return new _l(t,3,e,fc.min(),fc.min(),wl.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(fc.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=wl.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=wl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fc.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof _l&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new _l(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class El{constructor(t,e){this.position=t,this.inclusive=e}}function Tl(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?yc.comparator(yc.fromName(o.referenceValue),n.key):cl(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Il(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ol(t.position[n],e.position[n]))return!1;return!0}class Cl{constructor(t,e="asc"){this.field=t,this.dir=e}}function Sl(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class kl{}class Al extends kl{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Pl(t,e,n):"array-contains"===e?new Vl(t,n):"in"===e?new jl(t,n):"not-in"===e?new Bl(t,n):"array-contains-any"===e?new zl(t,n):new Al(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Ml(t,n):new Ul(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(cl(e,this.value)):null!==e&&sl(this.value)===sl(e)&&this.matchesComparison(cl(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Wa()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xl extends kl{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new xl(t,e)}matches(t){return Rl(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Rl(t){return"and"===t.op}function Nl(t){return function(t){for(const e of t.filters)if(e instanceof xl)return!1;return!0}(t)&&Rl(t)}function Dl(t){if(t instanceof Al)return t.field.canonicalString()+t.op.toString()+hl(t.value);if(Nl(t))return t.filters.map((t=>Dl(t))).join(",");{const e=t.filters.map((t=>Dl(t))).join(",");return`${t.op}(${e})`}}function Ol(t,e){return t instanceof Al?function(t,e){return e instanceof Al&&t.op===e.op&&t.field.isEqual(e.field)&&ol(t.value,e.value)}(t,e):t instanceof xl?function(t,e){return e instanceof xl&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&Ol(n,e.filters[i])),!0)}(t,e):void Wa()}function Ll(t){return t instanceof Al?function(t){return`${t.field.canonicalString()} ${t.op} ${hl(t.value)}`}(t):t instanceof xl?function(t){return t.op.toString()+" {"+t.getFilters().map(Ll).join(" ,")+"}"}(t):"Filter"}class Pl extends Al{constructor(t,e,n){super(t,e,n),this.key=yc.fromName(n.referenceValue)}matches(t){const e=yc.comparator(t.key,this.key);return this.matchesComparison(e)}}class Ml extends Al{constructor(t,e){super(t,"in",e),this.keys=Fl(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Ul extends Al{constructor(t,e){super(t,"not-in",e),this.keys=Fl(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Fl(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>yc.fromName(t.referenceValue)))}class Vl extends Al{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return fl(e)&&al(e.arrayValue,this.value)}}class jl extends Al{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&al(this.value.arrayValue,e)}}class Bl extends Al{constructor(t,e){super(t,"not-in",e)}matches(t){if(al(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!al(this.value.arrayValue,e)}}class zl extends Al{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!fl(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>al(this.value.arrayValue,t)))}}class ql{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ce=null}}function Hl(t,e=null,n=[],i=[],r=null,s=null,o=null){return new ql(t,e,n,i,r,s,o)}function $l(t){const e=Xa(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Dl(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Mc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>hl(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>hl(t))).join(",")),e.ce=t}return e.ce}function Kl(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Sl(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Ol(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Il(t.startAt,e.startAt)&&Il(t.endAt,e.endAt)}function Gl(t){return yc.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Wl{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Ql(t){return new Wl(t)}function Xl(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Jl(t){const e=Xa(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new Hc(vc.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new Cl(i,n))})),t.has(vc.keyField().canonicalString())||e.le.push(new Cl(vc.keyField(),n))}return e.le}function Yl(t){const e=Xa(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return Hl(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new Cl(t.field,e)}));const n=t.endAt?new El(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new El(t.startAt.position,t.startAt.inclusive):null;return Hl(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}(e,Jl(t))),e.he}function Zl(t,e,n){return new Wl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function th(t,e){return Kl(Yl(t),Yl(e))&&t.limitType===e.limitType}function eh(t){return`${$l(Yl(t))}|lt:${t.limitType}`}function nh(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Ll(t))).join(", ")}]`),Mc(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>hl(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>hl(t))).join(",")),`Target(${e})`}(Yl(t))}; limitType=${t.limitType})`}function ih(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):yc.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Jl(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Tl(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,Jl(t),e)||t.endAt&&!function(t,e,n){const i=Tl(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,Jl(t),e))}(t,e)}function rh(t){return(e,n)=>{let i=!1;for(const r of Jl(t)){const t=sh(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function sh(t,e,n){const i=t.field.isKeyField()?yc.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?cl(i,r):Wa()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Wa()}}class oh{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Vc(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return jc(this.inner)}size(){return this.innerSize}}const ah=new Bc(yc.comparator);function ch(){return ah}const lh=new Bc(yc.comparator);function hh(...t){let e=lh;for(const n of t)e=e.insert(n.key,n);return e}function uh(t){let e=lh;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function dh(){return ph()}function fh(){return ph()}function ph(){return new oh((t=>t.toString()),((t,e)=>t.isEqual(e)))}const mh=new Bc(yc.comparator),gh=new Hc(yc.comparator);function vh(...t){let e=gh;for(const n of t)e=e.add(n);return e}const yh=new Hc(hc);function wh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uc(e)?"-0":e}}function bh(t){return{integerValue:""+t}}function _h(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Uc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?bh(e):wh(t,e)}class Eh{constructor(){this._=void 0}}function Th(t,e,n){return t instanceof Sh?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Zc(e)&&(e=tl(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof kh?Ah(t,e):t instanceof xh?Rh(t,e):function(t,e){const n=Ch(t,e),i=Dh(n)+Dh(t.Ie);return dl(n)&&dl(t.Ie)?bh(i):wh(t.serializer,i)}(t,e)}function Ih(t,e,n){return t instanceof kh?Ah(t,e):t instanceof xh?Rh(t,e):n}function Ch(t,e){return t instanceof Nh?function(t){return dl(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Sh extends Eh{}class kh extends Eh{constructor(t){super(),this.elements=t}}function Ah(t,e){const n=Oh(e);for(const e of t.elements)n.some((t=>ol(t,e)))||n.push(e);return{arrayValue:{values:n}}}class xh extends Eh{constructor(t){super(),this.elements=t}}function Rh(t,e){let n=Oh(e);for(const e of t.elements)n=n.filter((t=>!ol(t,e)));return{arrayValue:{values:n}}}class Nh extends Eh{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Dh(t){return Jc(t.integerValue||t.doubleValue)}function Oh(t){return fl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Lh{constructor(t,e){this.version=t,this.transformResults=e}}class Ph{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ph}static exists(t){return new Ph(void 0,t)}static updateTime(t){return new Ph(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Mh(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Uh{}function Fh(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Wh(t.key,Ph.none()):new qh(t.key,t.data,Ph.none());{const n=t.data,i=wl.empty();let r=new Hc(vc.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new Hh(t.key,i,new Kc(r.toArray()),Ph.none())}}function Vh(t,e,n){t instanceof qh?function(t,e,n){const i=t.value.clone(),r=Kh(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Hh?function(t,e,n){if(!Mh(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Kh(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll($h(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function jh(t,e,n,i){return t instanceof qh?function(t,e,n,i){if(!Mh(t.precondition,e))return n;const r=t.value.clone(),s=Gh(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof Hh?function(t,e,n,i){if(!Mh(t.precondition,e))return n;const r=Gh(t.fieldTransforms,i,e),s=e.data;return s.setAll($h(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return Mh(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Bh(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=Ch(i.transform,t||null);null!=r&&(null===n&&(n=wl.empty()),n.set(i.field,r))}return n||null}function zh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&uc(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof kh&&e instanceof kh||t instanceof xh&&e instanceof xh?uc(t.elements,e.elements,ol):t instanceof Nh&&e instanceof Nh?ol(t.Ie,e.Ie):t instanceof Sh&&e instanceof Sh}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class qh extends Uh{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Hh extends Uh{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function $h(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Kh(t,e,n){const i=new Map;Qa(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Ih(o,a,n[r]))}return i}function Gh(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Th(t,s,e))}return i}class Wh extends Uh{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Qh extends Uh{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Xh{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Vh(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=jh(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=jh(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=fh();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=Fh(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(fc.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),vh())}isEqual(t){return this.batchId===t.batchId&&uc(this.mutations,t.mutations,((t,e)=>zh(t,e)))&&uc(this.baseMutations,t.baseMutations,((t,e)=>zh(t,e)))}}class Jh{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Qa(t.mutations.length===n.length);let i=mh;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new Jh(t,e,n,i)}}class Yh{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Zh{constructor(t,e){this.count=t,this.unchangedNames=e}}var tu,eu;function nu(t){if(void 0===t)return $a("GRPC error has no .code"),Ja.UNKNOWN;switch(t){case tu.OK:return Ja.OK;case tu.CANCELLED:return Ja.CANCELLED;case tu.UNKNOWN:return Ja.UNKNOWN;case tu.DEADLINE_EXCEEDED:return Ja.DEADLINE_EXCEEDED;case tu.RESOURCE_EXHAUSTED:return Ja.RESOURCE_EXHAUSTED;case tu.INTERNAL:return Ja.INTERNAL;case tu.UNAVAILABLE:return Ja.UNAVAILABLE;case tu.UNAUTHENTICATED:return Ja.UNAUTHENTICATED;case tu.INVALID_ARGUMENT:return Ja.INVALID_ARGUMENT;case tu.NOT_FOUND:return Ja.NOT_FOUND;case tu.ALREADY_EXISTS:return Ja.ALREADY_EXISTS;case tu.PERMISSION_DENIED:return Ja.PERMISSION_DENIED;case tu.FAILED_PRECONDITION:return Ja.FAILED_PRECONDITION;case tu.ABORTED:return Ja.ABORTED;case tu.OUT_OF_RANGE:return Ja.OUT_OF_RANGE;case tu.UNIMPLEMENTED:return Ja.UNIMPLEMENTED;case tu.DATA_LOSS:return Ja.DATA_LOSS;default:return Wa()}}(eu=tu||(tu={}))[eu.OK=0]="OK",eu[eu.CANCELLED=1]="CANCELLED",eu[eu.UNKNOWN=2]="UNKNOWN",eu[eu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",eu[eu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",eu[eu.NOT_FOUND=5]="NOT_FOUND",eu[eu.ALREADY_EXISTS=6]="ALREADY_EXISTS",eu[eu.PERMISSION_DENIED=7]="PERMISSION_DENIED",eu[eu.UNAUTHENTICATED=16]="UNAUTHENTICATED",eu[eu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",eu[eu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",eu[eu.ABORTED=10]="ABORTED",eu[eu.OUT_OF_RANGE=11]="OUT_OF_RANGE",eu[eu.UNIMPLEMENTED=12]="UNIMPLEMENTED",eu[eu.INTERNAL=13]="INTERNAL",eu[eu.UNAVAILABLE=14]="UNAVAILABLE",eu[eu.DATA_LOSS=15]="DATA_LOSS";const iu=new Fa([4294967295,4294967295],0);function ru(t){const e=(new TextEncoder).encode(t),n=new Ua;return n.update(e),new Uint8Array(n.digest())}function su(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Fa([n,i],0),new Fa([r,s],0)]}class ou{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new au(`Invalid padding: ${e}`);if(n<0)throw new au(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new au(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new au(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=Fa.fromNumber(this.Te)}de(t,e,n){let i=t.add(e.multiply(Fa.fromNumber(n)));return 1===i.compare(iu)&&(i=new Fa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=ru(t),[n,i]=su(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);if(!this.Ae(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),s=new ou(r,i,e);return n.forEach((t=>s.insert(t))),s}insert(t){if(0===this.Te)return;const e=ru(t),[n,i]=su(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);this.Re(e)}}Re(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class cu{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,lu.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new cu(fc.min(),i,new Bc(hc),ch(),vh())}}class lu{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new lu(n,e,vh(),vh(),vh())}}class hu{constructor(t,e,n,i){this.Ve=t,this.removedTargetIds=e,this.key=n,this.me=i}}class uu{constructor(t,e){this.targetId=t,this.fe=e}}class du{constructor(t,e,n=Wc.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class fu{constructor(){this.ge=0,this.pe=gu(),this.ye=Wc.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=vh(),e=vh(),n=vh();return this.pe.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:Wa()}})),new lu(this.ye,this.we,t,e,n)}Fe(){this.Se=!1,this.pe=gu()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,Qa(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class pu{constructor(t){this.Le=t,this.ke=new Map,this.qe=ch(),this.Qe=mu(),this.Ke=new Bc(hc)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,(e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(e);break;case 3:this.je(e)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.Ce(t.resumeToken));break;default:Wa()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach(((t,n)=>{this.je(n)&&e(n)}))}Je(t){const e=t.targetId,n=t.fe.count,i=this.Ye(e);if(i){const r=i.target;if(Gl(r))if(0===n){const t=new yc(r.path);this.We(e,t,_l.newNoDocument(t,fc.min()))}else Qa(1===n);else{const i=this.Ze(e);if(i!==n){const n=this.Xe(t),r=n?this.et(n,t,i):1;if(0!==r){this.He(e);const t=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,t)}}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=e;let s,o;try{s=Yc(n).toUint8Array()}catch(t){if(t instanceof Gc)return Ka("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new ou(s,i,r)}catch(t){return Ka(t instanceof au?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.Te?null:o}et(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Le.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const r=this.Le.nt(),s=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.mightContain(s)||(this.We(e,n,null),i++)})),i}it(t){const e=new Map;this.ke.forEach(((n,i)=>{const r=this.Ye(i);if(r){if(n.current&&Gl(r.target)){const e=new yc(r.target.path);null!==this.qe.get(e)||this.st(i,e)||this.We(i,e,_l.newNoDocument(e,t))}n.De&&(e.set(i,n.ve()),n.Fe())}}));let n=vh();this.Qe.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ye(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.qe.forEach(((e,n)=>n.setReadTime(t)));const i=new cu(t,e,this.Ke,this.qe,n);return this.qe=ch(),this.Qe=mu(),this.Ke=new Bc(hc),i}Ue(t,e){if(!this.je(t))return;const n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,e)?i.Me(e,1):i.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new fu,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new Hc(hc),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||Ha("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new fu),this.Le.getRemoteKeysForTarget(t).forEach((e=>{this.We(t,e,null)}))}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function mu(){return new Bc(yc.comparator)}function gu(){return new Bc(yc.comparator)}const vu={asc:"ASCENDING",desc:"DESCENDING"},yu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wu={and:"AND",or:"OR"};class bu{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function _u(t,e){return t.useProto3Json||Mc(e)?e:{value:e}}function Eu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Tu(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Iu(t,e){return Eu(t,e.toTimestamp())}function Cu(t){return Qa(!!t),fc.fromTimestamp(function(t){const e=Xc(t);return new dc(e.seconds,e.nanos)}(t))}function Su(t,e){return ku(t,e).canonicalString()}function ku(t,e){const n=function(t){return new mc(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Au(t){const e=mc.fromString(t);return Qa(Ku(e)),e}function xu(t,e){return Su(t.databaseId,e.path)}function Ru(t,e){const n=Au(e);if(n.get(1)!==t.databaseId.projectId)throw new Ya(Ja.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ya(Ja.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new yc(Ou(n))}function Nu(t,e){return Su(t.databaseId,e)}function Du(t){return new mc(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ou(t){return Qa(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Lu(t,e,n){return{name:xu(t,e),fields:n.value.mapValue.fields}}function Pu(t,e){return{documents:[Nu(t,e.path)]}}function Mu(t,e){const n={structuredQuery:{}},i=e.path;let r;null!==e.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Nu(t,r);const s=function(t){if(0!==t.length)return Hu(xl.create(t,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:zu(t.field),direction:Vu(t.dir)}}(t)))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=_u(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ut:n,parent:r}}function Uu(t){let e=function(t){const e=Au(t);return 4===e.length?mc.emptyPath():Ou(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Qa(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=Fu(t);return e instanceof xl&&Nl(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new Cl(qu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Mc(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new El(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new El(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new Wl(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,l)}function Fu(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=qu(t.unaryFilter.field);return Al.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=qu(t.unaryFilter.field);return Al.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=qu(t.unaryFilter.field);return Al.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=qu(t.unaryFilter.field);return Al.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Wa()}}(t):void 0!==t.fieldFilter?function(t){return Al.create(qu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Wa()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return xl.create(t.compositeFilter.filters.map((t=>Fu(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Wa()}}(t.compositeFilter.op))}(t):Wa()}function Vu(t){return vu[t]}function ju(t){return yu[t]}function Bu(t){return wu[t]}function zu(t){return{fieldPath:t.canonicalString()}}function qu(t){return vc.fromServerFormat(t.fieldPath)}function Hu(t){return t instanceof Al?function(t){if("=="===t.op){if(ml(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NAN"}};if(pl(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ml(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NOT_NAN"}};if(pl(t.value))return{unaryFilter:{field:zu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zu(t.field),op:ju(t.op),value:t.value}}}(t):t instanceof xl?function(t){const e=t.getFilters().map((t=>Hu(t)));return 1===e.length?e[0]:{compositeFilter:{op:Bu(t.op),filters:e}}}(t):Wa()}function $u(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ku(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Gu{constructor(t,e,n,i,r=fc.min(),s=fc.min(),o=Wc.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new Gu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Gu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Gu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Gu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Wu{constructor(t){this.ct=t}}function Qu(t){const e=Uu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Zl(e,e.limit,"L"):e}class Xu{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(Jc(t.integerValue));else if("doubleValue"in t){const n=Jc(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),Uc(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(Yc(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?yl(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):Wa()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),yc.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}Xu.bt=new Xu;class Ju{constructor(){this._n=new Yu}addToCollectionParentIndex(t,e){return this._n.add(e),Cc.resolve()}getCollectionParents(t,e){return Cc.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return Cc.resolve()}deleteFieldIndex(t,e){return Cc.resolve()}deleteAllFieldIndexes(t){return Cc.resolve()}createTargetIndexes(t,e){return Cc.resolve()}getDocumentsMatchingTarget(t,e){return Cc.resolve(null)}getIndexType(t,e){return Cc.resolve(0)}getFieldIndexes(t,e){return Cc.resolve([])}getNextCollectionGroupToUpdate(t){return Cc.resolve(null)}getMinOffset(t,e){return Cc.resolve(bc.min())}getMinOffsetFromCollectionGroup(t,e){return Cc.resolve(bc.min())}updateCollectionGroup(t,e,n){return Cc.resolve()}updateIndexEntries(t,e){return Cc.resolve()}}class Yu{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new Hc(mc.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new Hc(mc.comparator)).toArray()}}new Uint8Array(0);class Zu{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Zu(t,Zu.DEFAULT_COLLECTION_PERCENTILE,Zu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Zu.DEFAULT_COLLECTION_PERCENTILE=10,Zu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zu.DEFAULT=new Zu(41943040,Zu.DEFAULT_COLLECTION_PERCENTILE,Zu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zu.DISABLED=new Zu(-1,0,0);class td{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new td(0)}static Bn(){return new td(-1)}}class ed{constructor(){this.changes=new oh((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,_l.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Cc.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class nd{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class id{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&jh(n.mutation,t,Kc.empty(),dc.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,vh()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=vh()){const i=dh();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=hh();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=dh();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,vh())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=ch();const s=ph(),o=ph();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof Hh)?r=r.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),jh(o.mutation,e,o.mutation.getFieldMask(),dc.now())):s.set(e.key,Kc.empty())})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new nd(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=ph();let i=new Bc(((t,e)=>t-e)),r=vh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||Kc.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||vh()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,l=fh();c.forEach((t=>{if(!r.has(t)){const i=Fh(e.get(t),n.get(t));null!==i&&l.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,l))}return Cc.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return yc.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):Cc.resolve(dh());let o=-1,a=r;return s.next((e=>Cc.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?Cc.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,vh()))).next((t=>({batchId:o,changes:uh(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new yc(e)).next((t=>{let e=hh();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const r=e.collectionGroup;let s=hh();return this.indexManager.getCollectionParents(t,r).next((o=>Cc.forEach(o,(o=>{const a=function(t,e){return new Wl(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(r));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,r,i)))).next((t=>{r.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,_l.newInvalidDocument(i)))}));let n=hh();return t.forEach(((t,i)=>{const s=r.get(t);void 0!==s&&jh(s.mutation,i,Kc.empty(),dc.now()),ih(e,i)&&(n=n.insert(t,i))})),n}))}}class rd{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return Cc.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Cu(t.createTime)}}(e)),Cc.resolve()}getNamedQuery(t,e){return Cc.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:Qu(t.bundledQuery),readTime:Cu(t.readTime)}}(e)),Cc.resolve()}}class sd{constructor(){this.overlays=new Bc(yc.comparator),this.hr=new Map}getOverlay(t,e){return Cc.resolve(this.overlays.get(e))}getOverlays(t,e){const n=dh();return Cc.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ht(t,e,i)})),Cc.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),Cc.resolve()}getOverlaysForCollection(t,e,n){const i=dh(),r=e.length+1,s=new yc(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Cc.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new Bc(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=dh(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=dh(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Cc.resolve(o)}ht(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Yh(e,n));let r=this.hr.get(e);void 0===r&&(r=vh(),this.hr.set(e,r)),this.hr.set(e,r.add(n.key))}}class od{constructor(){this.Pr=new Hc(ad.Ir),this.Tr=new Hc(ad.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new ad(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new ad(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new yc(new mc([])),n=new ad(e,t),i=new ad(e,t+1),r=[];return this.Tr.forEachInRange([n,i],(t=>{this.Ar(t),r.push(t.key)})),r}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new yc(new mc([])),n=new ad(e,t),i=new ad(e,t+1);let r=vh();return this.Tr.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new ad(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class ad{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return yc.comparator(t.key,e.key)||hc(t.pr,e.pr)}static Er(t,e){return hc(t.pr,e.pr)||yc.comparator(t.key,e.key)}}class cd{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new Hc(ad.Ir)}checkEmpty(t){return Cc.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Xh(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.wr=this.wr.add(new ad(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Cc.resolve(s)}lookupMutationBatch(t,e){return Cc.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.br(n),r=i<0?0:i;return Cc.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Cc.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return Cc.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new ad(e,0),i=new ad(e,Number.POSITIVE_INFINITY),r=[];return this.wr.forEachInRange([n,i],(t=>{const e=this.Sr(t.pr);r.push(e)})),Cc.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Hc(hc);return e.forEach((t=>{const e=new ad(t,0),i=new ad(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,i],(t=>{n=n.add(t.pr)}))})),Cc.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;yc.isDocumentKey(r)||(r=r.child(""));const s=new ad(new yc(r),0);let o=new Hc(hc);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.pr)),!0)}),s),Cc.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Qa(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Cc.forEach(e.mutations,(i=>{const r=new ad(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new ad(e,0),i=this.wr.firstAfterOrEqual(n);return Cc.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Cc.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class ld{constructor(t){this.vr=t,this.docs=new Bc(yc.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Cc.resolve(n?n.document.mutableCopy():_l.newInvalidDocument(e))}getEntries(t,e){let n=ch();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():_l.newInvalidDocument(t))})),Cc.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=ch();const s=e.path,o=new yc(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||_c(wc(o),n)<=0||(i.has(o.key)||ih(e,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Cc.resolve(r)}getAllFromCollectionGroup(t,e,n,i){Wa()}Fr(t,e){return Cc.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new hd(this)}getSize(t){return Cc.resolve(this.size)}}class hd extends ed{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.ar.addEntry(t,i)):this.ar.removeEntry(n)})),Cc.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class ud{constructor(t){this.persistence=t,this.Mr=new oh((t=>$l(t)),Kl),this.lastRemoteSnapshotVersion=fc.min(),this.highestTargetId=0,this.Or=0,this.Nr=new od,this.targetCount=0,this.Br=td.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),Cc.resolve()}getLastRemoteSnapshotVersion(t){return Cc.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Cc.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),Cc.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),Cc.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Br=new td(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,Cc.resolve()}updateTargetData(t,e){return this.qn(e),Cc.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,Cc.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Cc.waitFor(r).next((()=>i))}getTargetCount(t){return Cc.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return Cc.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),Cc.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),Cc.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),Cc.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return Cc.resolve(n)}containsKey(t,e){return Cc.resolve(this.Nr.containsKey(e))}}class dd{constructor(t,e){this.Lr={},this.overlays={},this.kr=new Pc(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new ud(this),this.indexManager=new Ju,this.remoteDocumentCache=function(t){return new ld(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new Wu(e),this.$r=new rd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new sd,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Lr[t.toKey()];return n||(n=new cd(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){Ha("MemoryPersistence","Starting transaction:",t);const i=new fd(this.kr.next());return this.referenceDelegate.Ur(),n(i).next((t=>this.referenceDelegate.Wr(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Gr(t,e){return Cc.or(Object.values(this.Lr).map((n=>()=>n.containsKey(t,e))))}}class fd extends Tc{constructor(t){super(),this.currentSequenceNumber=t}}class pd{constructor(t){this.persistence=t,this.zr=new od,this.jr=null}static Hr(t){return new pd(t)}get Jr(){if(this.jr)return this.jr;throw Wa()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),Cc.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),Cc.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),Cc.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Cc.forEach(this.Jr,(n=>{const i=yc.fromPath(n);return this.Yr(t,i).next((t=>{t||e.removeEntry(i,fc.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return Cc.or([()=>Cc.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class md{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=i}static Ki(t,e){let n=vh(),i=vh();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new md(t,e.fromCache,n,i)}}class gd{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class vd{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){var t;const e=null===(t=c())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()||!navigator.userAgent.includes("Safari")||navigator.userAgent.includes("Chrome")?kc.v(m())>0?6:4:8}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,i){const r={result:null};return this.ji(t,e).next((t=>{r.result=t})).next((()=>{if(!r.result)return this.Hi(t,e,i,n).next((t=>{r.result=t}))})).next((()=>{if(r.result)return;const n=new gd;return this.Ji(t,e,n).next((i=>{if(r.result=i,this.Ui)return this.Yi(t,e,n,i.size)}))})).next((()=>r.result))}Yi(t,e,n,i){return n.documentReadCount<this.Wi?(qa()<=O.DEBUG&&Ha("QueryEngine","SDK will not create cache indexes for query:",nh(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Cc.resolve()):(qa()<=O.DEBUG&&Ha("QueryEngine","Query:",nh(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(qa()<=O.DEBUG&&Ha("QueryEngine","The SDK decides to create cache indexes for query:",nh(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Yl(e))):Cc.resolve())}ji(t,e){if(Xl(e))return Cc.resolve(null);let n=Yl(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=Zl(e,null,"F"),n=Yl(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=vh(...i);return this.zi.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Zi(e,i);return this.Xi(e,s,r,n.readTime)?this.ji(t,Zl(e,null,"F")):this.es(t,s,e,n)}))))})))))}Hi(t,e,n,i){return Xl(e)||i.isEqual(fc.min())?Cc.resolve(null):this.zi.getDocuments(t,n).next((r=>{const s=this.Zi(e,r);return this.Xi(e,s,n,i)?Cc.resolve(null):(qa()<=O.DEBUG&&Ha("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nh(e)),this.es(t,s,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=fc.fromTimestamp(1e9===i?new dc(n+1,0):new dc(n,i));return new bc(r,yc.empty(),e)}(i,-1)).next((t=>t)))}))}Zi(t,e){let n=new Hc(rh(t));return e.forEach(((e,i)=>{ih(t,i)&&(n=n.add(i))})),n}Xi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ji(t,e,n){return qa()<=O.DEBUG&&Ha("QueryEngine","Using full collection scan to execute query:",nh(e)),this.zi.getDocumentsMatchingQuery(t,e,bc.min(),n)}es(t,e,n,i){return this.zi.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class yd{constructor(t,e,n,i){this.persistence=t,this.ts=e,this.serializer=i,this.ns=new Bc(hc),this.rs=new oh((t=>$l(t)),Kl),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new id(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function wd(t,e){const n=Xa(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=vh();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function bd(t){const e=Xa(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}function _d(t,e){const n=Xa(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Ed(t,e,n){const i=Xa(t),r=i.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!Rc(t))throw t;Ha("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.ns=i.ns.remove(e),i.rs.delete(r.target)}function Td(t,e,n){const i=Xa(t);let r=fc.min(),s=vh();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=Xa(t),r=i.rs.get(n);return void 0!==r?Cc.resolve(i.ns.get(r)):i.Qr.getTargetData(e,n)}(i,t,Yl(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.ts.getDocumentsMatchingQuery(t,e,n?r:fc.min(),n?s:vh()))).next((t=>(function(t,e,n){let i=t.ss.get(e)||fc.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.ss.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,hs:s})))))}class Id{constructor(){this.activeTargetIds=yh}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Cd{constructor(){this.no=new Id,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new Id,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Sd{io(t){}shutdown(){}}class kd{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Ha("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){Ha("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ad=null;function xd(){return null===Ad?Ad=268435456+Math.round(2147483648*Math.random()):Ad++,"0x"+Ad.toString(16)}const Rd={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Nd{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const Dd="WebChannelConnection";class Od extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${i}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get wo(){return!1}So(t,e,n,i,r){const s=xd(),o=this.bo(t,e.toUriEncodedString());Ha("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,i,r),this.Co(t,o,a,n).then((e=>(Ha("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw Ka("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,i,r,s){return this.So(t,e,n,i,r)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+Ba,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=Rd[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,i){const r=xd();return new Promise(((s,o)=>{const a=new Ma;a.setWithCredentials(!0),a.listenOnce(Da.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Na.NO_ERROR:const e=a.getResponseJson();Ha(Dd,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(e)),s(e);break;case Na.TIMEOUT:Ha(Dd,`RPC '${t}' ${r} timed out`),o(new Ya(Ja.DEADLINE_EXCEEDED,"Request time out"));break;case Na.HTTP_ERROR:const n=a.getStatus();if(Ha(Dd,`RPC '${t}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ja).indexOf(e)>=0?e:Ja.UNKNOWN}(e.status);o(new Ya(t,e.message))}else o(new Ya(Ja.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Ya(Ja.UNAVAILABLE,"Connection failed."));break;default:Wa()}}finally{Ha(Dd,`RPC '${t}' ${r} completed.`)}}));const c=JSON.stringify(i);Ha(Dd,`RPC '${t}' ${r} sending request:`,i),a.send(e,"POST",c,n,15)}))}Fo(t,e,n){const i=xd(),r=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=xa(),o=Ra(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const l=r.join("");Ha(Dd,`Creating RPC '${t}' stream ${i}: ${l}`,a);const h=s.createWebChannel(l,a);let u=!1,d=!1;const f=new Nd({lo:e=>{d?Ha(Dd,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(u||(Ha(Dd,`Opening RPC '${t}' stream ${i} transport.`),h.open(),u=!0),Ha(Dd,`RPC '${t}' stream ${i} sending:`,e),h.send(e))},ho:()=>h.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(h,Pa.EventType.OPEN,(()=>{d||Ha(Dd,`RPC '${t}' stream ${i} transport opened.`)})),p(h,Pa.EventType.CLOSE,(()=>{d||(d=!0,Ha(Dd,`RPC '${t}' stream ${i} transport closed`),f.Vo())})),p(h,Pa.EventType.ERROR,(e=>{d||(d=!0,Ka(Dd,`RPC '${t}' stream ${i} transport errored:`,e),f.Vo(new Ya(Ja.UNAVAILABLE,"The operation could not be completed")))})),p(h,Pa.EventType.MESSAGE,(e=>{var n;if(!d){const r=e.data[0];Qa(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Ha(Dd,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=tu[t];if(void 0!==e)return nu(e)}(e),r=o.message;void 0===n&&(n=Ja.INTERNAL,r="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new Ya(n,r)),h.close()}else Ha(Dd,`RPC '${t}' stream ${i} received:`,r),f.mo(r)}})),p(o,Oa.STAT_EVENT,(e=>{e.stat===La.PROXY?Ha(Dd,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===La.NOPROXY&&Ha(Dd,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function Ld(){return"undefined"!=typeof document?document:null}function Pd(t){return new bu(t,!0)}class Md{constructor(t,e,n=1e3,i=1.5,r=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=i,this.Oo=r,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),i=Math.max(0,e-n);i>0&&Ha("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,(()=>(this.Lo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class Ud{constructor(t,e,n,i,r,s,o,a){this.oi=t,this.$o=n,this.Uo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Md(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===Ja.RESOURCE_EXHAUSTED?($a(e.toString()),$a("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===Ja.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new Ya(Ja.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return Ha("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(Ha("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Fd extends Ud{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r}a_(t,e){return this.connection.Fo("Listen",t,e)}onMessage(t){this.jo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Wa()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(Qa(void 0===e||"string"==typeof e),Wc.fromBase64String(e||"")):(Qa(void 0===e||e instanceof Uint8Array),Wc.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Ja.UNKNOWN:nu(t.code);return new Ya(e,t.message||"")}(o);n=new du(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Ru(t,i.document.name),s=Cu(i.document.updateTime),o=i.document.createTime?Cu(i.document.createTime):fc.min(),a=new wl({mapValue:{fields:i.document.fields}}),c=_l.newFoundDocument(r,s,o,a),l=i.targetIds||[],h=i.removedTargetIds||[];n=new hu(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Ru(t,i.document),s=i.readTime?Cu(i.readTime):fc.min(),o=_l.newNoDocument(r,s),a=i.removedTargetIds||[];n=new hu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Ru(t,i.document),s=i.removedTargetIds||[];n=new hu([],s,r,null)}else{if(!("filter"in e))return Wa();{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:r}=t,s=new Zh(i,r),o=t.targetId;n=new uu(o,s)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return fc.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?fc.min():e.readTime?Cu(e.readTime):fc.min()}(t);return this.listener.u_(e,n)}c_(t){const e={};e.database=Du(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=Gl(i)?{documents:Pu(t,i)}:{query:Mu(t,i).ut},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=Tu(t,e.resumeToken);const i=_u(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(fc.min())>0){n.readTime=Eu(t,e.snapshotVersion.toTimestamp());const i=_u(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Wa()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.t_(e)}l_(t){const e={};e.database=Du(this.serializer),e.removeTarget=t,this.t_(e)}}class Vd extends Ud{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(Qa(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(Qa(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Cu(t.updateTime):Cu(e);return n.isEqual(fc.min())&&(n=Cu(e)),new Lh(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Cu(t.commitTime);return this.listener.T_(n,e)}return Qa(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=Du(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof qh)n={update:Lu(t,e.key,e.value)};else if(e instanceof Wh)n={delete:xu(t,e.key)};else if(e instanceof Hh)n={update:Lu(t,e.key,e.data),updateMask:$u(e.fieldMask)};else{if(!(e instanceof Qh))return Wa();n={verify:xu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Sh)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof kh)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof xh)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Nh)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw Wa()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Iu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Wa()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class jd extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new Ya(Ja.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.So(t,ku(e,n),i,r,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ja.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Ya(Ja.UNKNOWN,t.toString())}))}vo(t,e,n,i,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(t,ku(e,n),i,s,o,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ja.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Ya(Ja.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class Bd{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?($a(e),this.g_=!1):Ha("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class zd{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=r,this.M_.io((t=>{n.enqueueAndForget((async()=>{Jd(this)&&(Ha("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Xa(t);e.v_.add(4),await Hd(e),e.x_.set("Unknown"),e.v_.delete(4),await qd(e)}(this))}))})),this.x_=new Bd(n,i)}}async function qd(t){if(Jd(t))for(const e of t.F_)await e(!0)}async function Hd(t){for(const e of t.F_)await e(!1)}function $d(t,e){const n=Xa(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),Xd(n)?Qd(n):mf(n).Jo()&&Gd(n,e))}function Kd(t,e){const n=Xa(t),i=mf(n);n.C_.delete(e),i.Jo()&&Wd(n,e),0===n.C_.size&&(i.Jo()?i.Xo():Jd(n)&&n.x_.set("Unknown"))}function Gd(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fc.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}mf(t).c_(e)}function Wd(t,e){t.O_.Oe(e),mf(t).l_(e)}function Qd(t){t.O_=new pu({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),mf(t).start(),t.x_.p_()}function Xd(t){return Jd(t)&&!mf(t).Ho()&&t.C_.size>0}function Jd(t){return 0===Xa(t).v_.size}function Yd(t){t.O_=void 0}async function Zd(t){t.C_.forEach(((e,n)=>{Gd(t,e)}))}async function tf(t,e){Yd(t),Xd(t)?(t.x_.S_(e),Qd(t)):t.x_.set("Unknown")}async function ef(t,e,n){if(t.x_.set("Online"),e instanceof du&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.C_.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.C_.delete(i),t.O_.removeTarget(i))}(t,e)}catch(n){Ha("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await nf(t,n)}else if(e instanceof hu?t.O_.$e(e):e instanceof uu?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(fc.min()))try{const e=await bd(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.O_.it(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.C_.get(i);r&&t.C_.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.C_.get(e);if(!i)return;t.C_.set(e,i.withResumeToken(Wc.EMPTY_BYTE_STRING,i.snapshotVersion)),Wd(t,e);const r=new Gu(i.target,e,n,i.sequenceNumber);Gd(t,r)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){Ha("RemoteStore","Failed to raise snapshot:",e),await nf(t,e)}}async function nf(t,e,n){if(!Rc(e))throw e;t.v_.add(1),await Hd(t),t.x_.set("Offline"),n||(n=()=>bd(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ha("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await qd(t)}))}function rf(t,e){return e().catch((n=>nf(t,n,e)))}async function sf(t){const e=Xa(t),n=gf(e);let i=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;of(e);)try{const t=await _d(e.localStore,i);if(null===t){0===e.D_.length&&n.Xo();break}i=t.batchId,af(e,t)}catch(t){await nf(e,t)}cf(e)&&lf(e)}function of(t){return Jd(t)&&t.D_.length<10}function af(t,e){t.D_.push(e);const n=gf(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function cf(t){return Jd(t)&&!gf(t).Ho()&&t.D_.length>0}function lf(t){gf(t).start()}async function hf(t){gf(t).d_()}async function uf(t){const e=gf(t);for(const n of t.D_)e.I_(n.mutations)}async function df(t,e,n){const i=t.D_.shift(),r=Jh.from(i,e,n);await rf(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await sf(t)}async function ff(t,e){e&&gf(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return Wa();case Ja.CANCELLED:case Ja.UNKNOWN:case Ja.DEADLINE_EXCEEDED:case Ja.RESOURCE_EXHAUSTED:case Ja.INTERNAL:case Ja.UNAVAILABLE:case Ja.UNAUTHENTICATED:return!1;case Ja.INVALID_ARGUMENT:case Ja.NOT_FOUND:case Ja.ALREADY_EXISTS:case Ja.PERMISSION_DENIED:case Ja.FAILED_PRECONDITION:case Ja.ABORTED:case Ja.OUT_OF_RANGE:case Ja.UNIMPLEMENTED:case Ja.DATA_LOSS:return!0}}(t)&&t!==Ja.ABORTED}(e.code)){const n=t.D_.shift();gf(t).Zo(),await rf(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await sf(t)}}(t,e),cf(t)&&lf(t)}async function pf(t,e){const n=Xa(t);n.asyncQueue.verifyOperationInProgress(),Ha("RemoteStore","RemoteStore received new credentials");const i=Jd(n);n.v_.add(3),await Hd(n),i&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await qd(n)}function mf(t){return t.N_||(t.N_=function(t,e,n){const i=Xa(t);return i.R_(),new Fd(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:Zd.bind(null,t),To:tf.bind(null,t),u_:ef.bind(null,t)}),t.F_.push((async e=>{e?(t.N_.Zo(),Xd(t)?Qd(t):t.x_.set("Unknown")):(await t.N_.stop(),Yd(t))}))),t.N_}function gf(t){return t.B_||(t.B_=function(t,e,n){const i=Xa(t);return i.R_(),new Vd(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:hf.bind(null,t),To:ff.bind(null,t),E_:uf.bind(null,t),T_:df.bind(null,t)}),t.F_.push((async e=>{e?(t.B_.Zo(),await sf(t)):(await t.B_.stop(),t.D_.length>0&&(Ha("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}class vf{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Za,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new vf(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ya(Ja.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yf(t,e){if($a("AsyncQueue",`${e}: ${t}`),Rc(t))return new Ya(Ja.UNAVAILABLE,`${e}: ${t}`);throw t}class wf{constructor(t){this.comparator=t?(e,n)=>t(e,n)||yc.comparator(e.key,n.key):(t,e)=>yc.comparator(t.key,e.key),this.keyedMap=hh(),this.sortedSet=new Bc(this.comparator)}static emptySet(t){return new wf(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof wf))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new wf;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class bf{constructor(){this.L_=new Bc(yc.comparator)}track(t){const e=t.doc.key,n=this.L_.get(e);n?0!==t.type&&3===n.type?this.L_=this.L_.insert(e,t):3===t.type&&1!==n.type?this.L_=this.L_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.L_=this.L_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.L_=this.L_.remove(e):1===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):Wa():this.L_=this.L_.insert(e,t)}k_(){const t=[];return this.L_.inorderTraversal(((e,n)=>{t.push(n)})),t}}class _f{constructor(t,e,n,i,r,s,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new _f(t,e,wf.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&th(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Ef{constructor(){this.q_=void 0,this.Q_=[]}}class Tf{constructor(){this.queries=new oh((t=>eh(t)),th),this.onlineState="Unknown",this.K_=new Set}}async function If(t,e){const n=Xa(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new Ef),r)try{s.q_=await n.onListen(i)}catch(t){const n=yf(t,`Initialization of query '${nh(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&Af(n)}async function Cf(t,e){const n=Xa(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.Q_.indexOf(e);t>=0&&(s.Q_.splice(t,1),r=0===s.Q_.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function Sf(t,e){const n=Xa(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.Q_)e.W_(t)&&(i=!0);r.q_=t}}i&&Af(n)}function kf(t,e,n){const i=Xa(t),r=i.queries.get(e);if(r)for(const t of r.Q_)t.onError(n);i.queries.delete(e)}function Af(t){t.K_.forEach((t=>{t.next()}))}class xf{constructor(t,e,n){this.query=t,this.G_=e,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}W_(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new _f(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.z_?this.H_(t)&&(this.G_.next(t),e=!0):this.J_(t,this.onlineState)&&(this.Y_(t),e=!0),this.j_=t,e}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let e=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),e=!0),e}J_(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Z_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}H_(t){if(t.docChanges.length>0)return!0;const e=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}Y_(t){t=_f.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}class Rf{constructor(t){this.key=t}}class Nf{constructor(t){this.key=t}}class Df{constructor(t,e){this.query=t,this.oa=e,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=vh(),this.mutatedKeys=vh(),this.ua=rh(t),this.ca=new wf(this.ua)}get la(){return this.oa}ha(t,e){const n=e?e.Pa:new bf,i=e?e.ca:this.ca;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const l=i.get(t),h=ih(this.query,e)?e:null,u=!!l&&this.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;l&&h?l.data.isEqual(h.data)?u!==d&&(n.track({type:3,doc:h}),f=!0):this.Ia(l,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.ua(h,a)>0||c&&this.ua(h,c)<0)&&(o=!0)):!l&&h?(n.track({type:0,doc:h}),f=!0):l&&!h&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(o=!0)),f&&(h?(s=s.add(h),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{ca:s,Pa:n,Xi:o,mutatedKeys:r}}Ia(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const r=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;const s=t.Pa.k_();s.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Wa()}};return n(t)-n(e)}(t.type,e.type)||this.ua(t.doc,e.doc))),this.Ta(n),i=null!=i&&i;const o=e&&!i?this.Ea():[],a=0===this.aa.size&&this.current&&!i?1:0,c=a!==this._a;return this._a=a,0!==s.length||c?{snapshot:new _f(this.query,t.ca,r,s,t.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),da:o}:{da:o}}U_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new bf,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach((t=>this.oa=this.oa.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.oa=this.oa.delete(t))),this.current=t.current)}Ea(){if(!this.current)return[];const t=this.aa;this.aa=vh(),this.ca.forEach((t=>{this.Aa(t.key)&&(this.aa=this.aa.add(t.key))}));const e=[];return t.forEach((t=>{this.aa.has(t)||e.push(new Nf(t))})),this.aa.forEach((n=>{t.has(n)||e.push(new Rf(n))})),e}Ra(t){this.oa=t.hs,this.aa=vh();const e=this.ha(t.documents);return this.applyChanges(e,!0)}Va(){return _f.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class Of{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Lf{constructor(t){this.key=t,this.ma=!1}}class Pf{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new oh((t=>eh(t)),th),this.pa=new Map,this.ya=new Set,this.wa=new Bc(yc.comparator),this.Sa=new Map,this.ba=new od,this.Da={},this.Ca=new Map,this.va=td.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}async function Mf(t,e){const n=function(t){const e=Xa(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ff.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Yf.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jf.bind(null,e),e.fa.u_=Sf.bind(null,e.eventManager),e.fa.xa=kf.bind(null,e.eventManager),e}(t);let i,r;const s=n.ga.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.Va();else{const t=await function(t,e){const n=Xa(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Qr.getTargetData(t,e).next((r=>r?(i=r,Cc.resolve(i)):n.Qr.allocateTargetId(t).next((r=>(i=new Gu(e,r,"TargetPurposeListen",t.currentSequenceNumber),n.Qr.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.ns.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(t.targetId,t),n.rs.set(e,t.targetId)),t}))}(n.localStore,Yl(e)),s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await async function(t,e,n,i,r){t.Ma=(e,n,i)=>async function(t,e,n,i){let r=e.view.ha(n);r.Xi&&(r=await Td(t.localStore,e.query,!1).then((({documents:t})=>e.view.ha(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=i&&null!=i.targetMismatches.get(e.targetId),a=e.view.applyChanges(r,t.isPrimaryClient,s,o);return Gf(t,e.targetId,a.da),a.snapshot}(t,e,n,i);const s=await Td(t.localStore,e,!0),o=new Df(e,s.hs),a=o.ha(s.documents),c=lu.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),l=o.applyChanges(a,t.isPrimaryClient,c);Gf(t,n,l.da);const h=new Of(e,n,o);return t.ga.set(e,h),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),l.snapshot}(n,e,i,"current"===s,t.resumeToken),n.isPrimaryClient&&$d(n.remoteStore,t)}return r}async function Uf(t,e){const n=Xa(t),i=n.ga.get(e),r=n.pa.get(i.targetId);if(r.length>1)return n.pa.set(i.targetId,r.filter((t=>!th(t,e)))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ed(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),Kd(n.remoteStore,i.targetId),$f(n,i.targetId)})).catch(Ic)):($f(n,i.targetId),await Ed(n.localStore,i.targetId,!0))}async function Ff(t,e){const n=Xa(t);try{const t=await function(t,e){const n=Xa(t),i=e.snapshotVersion;let r=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.os.newChangeBuffer({trackRemovals:!0});r=n.ns;const o=[];e.targetChanges.forEach(((s,a)=>{const c=r.get(a);if(!c)return;o.push(n.Qr.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(t,s.addedDocuments,a))));let l=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?l=l.withResumeToken(Wc.EMPTY_BYTE_STRING,fc.min()).withLastLimboFreeSnapshotVersion(fc.min()):s.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(s.resumeToken,i)),r=r.insert(a,l),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,s)&&o.push(n.Qr.updateTargetData(t,l))}));let a=ch(),c=vh();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n){let i=vh(),r=vh();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=ch();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(fc.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):Ha("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{cs:i,ls:r}}))}(t,s,e.documentUpdates).next((t=>{a=t.cs,c=t.ls}))),!i.isEqual(fc.min())){const e=n.Qr.getLastRemoteSnapshotVersion(t).next((e=>n.Qr.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return Cc.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.ns=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Sa.get(e);i&&(Qa(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.ma=!0:t.modifiedDocuments.size>0?Qa(i.ma):t.removedDocuments.size>0&&(Qa(i.ma),i.ma=!1))})),await Xf(n,t,e)}catch(t){await Ic(t)}}function Vf(t,e,n){const i=Xa(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ga.forEach(((n,i)=>{const r=i.view.U_(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=Xa(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.U_(e)&&(i=!0)})),i&&Af(n)}(i.eventManager,e),t.length&&i.fa.u_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function jf(t,e,n){const i=Xa(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Sa.get(e),s=r&&r.key;if(s){let t=new Bc(yc.comparator);t=t.insert(s,_l.newNoDocument(s,fc.min()));const n=vh().add(s),r=new cu(fc.min(),new Map,new Bc(hc),t,n);await Ff(i,r),i.wa=i.wa.remove(s),i.Sa.delete(e),Qf(i)}else await Ed(i.localStore,e,!1).then((()=>$f(i,e,n))).catch(Ic)}async function Bf(t,e){const n=Xa(t),i=e.batch.batchId;try{const t=await function(t,e){const n=Xa(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=Cc.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);Qa(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=vh();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);Hf(n,i,null),qf(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Xf(n,t)}catch(t){await Ic(t)}}async function zf(t,e,n){const i=Xa(t);try{const t=await function(t,e){const n=Xa(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(Qa(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);Hf(i,e,n),qf(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Xf(i,t)}catch(n){await Ic(n)}}function qf(t,e){(t.Ca.get(e)||[]).forEach((t=>{t.resolve()})),t.Ca.delete(e)}function Hf(t,e,n){const i=Xa(t);let r=i.Da[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Da[i.currentUser.toKey()]=r}}function $f(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.pa.get(e))t.ga.delete(i),n&&t.fa.xa(i,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach((e=>{t.ba.containsKey(e)||Kf(t,e)}))}function Kf(t,e){t.ya.delete(e.path.canonicalString());const n=t.wa.get(e);null!==n&&(Kd(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),Qf(t))}function Gf(t,e,n){for(const i of n)i instanceof Rf?(t.ba.addReference(i.key,e),Wf(t,i)):i instanceof Nf?(Ha("SyncEngine","Document no longer in limbo: "+i.key),t.ba.removeReference(i.key,e),t.ba.containsKey(i.key)||Kf(t,i.key)):Wa()}function Wf(t,e){const n=e.key,i=n.path.canonicalString();t.wa.get(n)||t.ya.has(i)||(Ha("SyncEngine","New document in limbo: "+n),t.ya.add(i),Qf(t))}function Qf(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){const e=t.ya.values().next().value;t.ya.delete(e);const n=new yc(mc.fromString(e)),i=t.va.next();t.Sa.set(i,new Lf(n)),t.wa=t.wa.insert(n,i),$d(t.remoteStore,new Gu(Yl(Ql(n.path)),i,"TargetPurposeLimboResolution",Pc._e))}}async function Xf(t,e,n){const i=Xa(t),r=[],s=[],o=[];i.ga.isEmpty()||(i.ga.forEach(((t,a)=>{o.push(i.Ma(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=md.Ki(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.fa.u_(r),await async function(t,e){const n=Xa(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Cc.forEach(e,(e=>Cc.forEach(e.qi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Cc.forEach(e.Qi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!Rc(t))throw t;Ha("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.ns=n.ns.insert(e,r)}}}(i.localStore,s))}async function Jf(t,e){const n=Xa(t);if(!n.currentUser.isEqual(e)){Ha("SyncEngine","User change. New user:",e.toKey());const t=await wd(n.localStore,e);n.currentUser=e,function(t,e){t.Ca.forEach((t=>{t.forEach((t=>{t.reject(new Ya(Ja.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ca.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Xf(n,t.us)}}function Yf(t,e){const n=Xa(t),i=n.Sa.get(e);if(i&&i.ma)return vh().add(i.key);{let t=vh();const i=n.pa.get(e);if(!i)return t;for(const e of i){const i=n.ga.get(e);t=t.unionWith(i.view.la)}return t}}function Zf(t){const e=Xa(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Bf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zf.bind(null,e),e}class tp{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Pd(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,i){return new yd(t,e,n,i)}(this.persistence,new vd,t.initialUser,this.serializer)}createPersistence(t){return new dd(pd.Hr,this.serializer)}createSharedClientState(t){return new Cd}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ep{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Vf(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Jf.bind(null,this.syncEngine),await async function(t,e){const n=Xa(t);e?(n.v_.delete(2),await qd(n)):e||(n.v_.add(2),await Hd(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Tf}createDatastore(t){const e=Pd(t.databaseInfo.databaseId),n=function(t){return new Od(t)}(t.databaseInfo);return function(t,e,n,i){return new jd(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new zd(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,(t=>Vf(this.syncEngine,t,0)),kd.D()?new kd:new Sd)}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new Pf(t,e,n,i,r,s);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=Xa(t);Ha("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await Hd(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class np{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):$a("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class ip{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=ja.UNAUTHENTICATED,this.clientId=lc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Ha("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Ha("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ya(Ja.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Za;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=yf(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function rp(t,e){t.asyncQueue.verifyOperationInProgress(),Ha("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await wd(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function sp(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ha("FirestoreClient","Using user provided OfflineComponentProvider");try{await rp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===Ja.FAILED_PRECONDITION||t.code===Ja.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;Ka("Error using user provided cache. Falling back to memory cache: "+n),await rp(t,new tp)}}else Ha("FirestoreClient","Using default OfflineComponentProvider"),await rp(t,new tp);return t._offlineComponents}(t);Ha("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>pf(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>pf(e.remoteStore,n))),t._onlineComponents=e}async function op(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ha("FirestoreClient","Using user provided OnlineComponentProvider"),await sp(t,t._uninitializedComponentsProvider._online)):(Ha("FirestoreClient","Using default OnlineComponentProvider"),await sp(t,new ep))),t._onlineComponents}async function ap(t){const e=await op(t),n=e.eventManager;return n.onListen=Mf.bind(null,e.syncEngine),n.onUnlisten=Uf.bind(null,e.syncEngine),n}function cp(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const lp=new Map;function hp(t,e,n){if(!n)throw new Ya(Ja.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function up(t){if(!yc.isDocumentKey(t))throw new Ya(Ja.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dp(t){if(yc.isDocumentKey(t))throw new Ya(Ja.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Wa()}function pp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ya(Ja.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=fp(t);throw new Ya(Ja.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class mp{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Ya(Ja.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ya(Ja.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new Ya(Ja.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cp(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new Ya(Ja.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new Ya(Ja.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new Ya(Ja.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class gp{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ya(Ja.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Ya(Ja.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mp(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new ec;switch(t.type){case"firstParty":return new sc(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Ya(Ja.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=lp.get(t);e&&(Ha("ComponentProvider","Removing Datastore"),lp.delete(t),e.terminate())}(this),Promise.resolve()}}class vp{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new vp(this.firestore,t,this._query)}}class yp{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wp(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new yp(this.firestore,t,this._key)}}class wp extends vp{constructor(t,e,n){super(t,e,Ql(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new yp(this.firestore,null,new yc(t))}withConverter(t){return new wp(this.firestore,t,this._path)}}function bp(t,e,...n){if(t=k(t),hp("collection","path",e),t instanceof gp){const i=mc.fromString(e,...n);return dp(i),new wp(t,null,i)}{if(!(t instanceof yp||t instanceof wp))throw new Ya(Ja.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(mc.fromString(e,...n));return dp(i),new wp(t.firestore,null,i)}}function _p(t,e,...n){if(t=k(t),1===arguments.length&&(e=lc.newId()),hp("doc","path",e),t instanceof gp){const i=mc.fromString(e,...n);return up(i),new yp(t,null,new yc(i))}{if(!(t instanceof yp||t instanceof wp))throw new Ya(Ja.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(mc.fromString(e,...n));return up(i),new yp(t.firestore,t instanceof wp?t.converter:null,new yc(i))}}class Ep{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Md(this,"async_queue_retry"),this._u=()=>{const t=Ld();t&&Ha("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=Ld();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const e=Ld();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise((()=>{}));const e=new Za;return this.uu((()=>this.tu&&this.su?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.eu.push(t),this.cu())))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!Rc(t))throw t;Ha("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo((()=>this.cu()))}}uu(t){const e=this.Xa.then((()=>(this.iu=!0,t().catch((t=>{this.ru=t,this.iu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw $a("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.iu=!1,t))))));return this.Xa=e,e}enqueueAfterDelay(t,e,n){this.au(),this.ou.indexOf(t)>-1&&(e=0);const i=vf.createAndSchedule(this,t,e,n,(t=>this.lu(t)));return this.nu.push(i),i}au(){this.ru&&Wa()}verifyOperationInProgress(){}async hu(){let t;do{t=this.Xa,await t}while(t!==this.Xa)}Pu(t){for(const e of this.nu)if(e.timerId===t)return!0;return!1}Iu(t){return this.hu().then((()=>{this.nu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.hu()}))}Tu(t){this.ou.push(t)}lu(t){const e=this.nu.indexOf(t);this.nu.splice(e,1)}}class Tp extends gp{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Ep,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Cp(this),this._firestoreClient.terminate()}}function Ip(t){return t._firestoreClient||Cp(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Cp(t){var e,n,i;const r=t._freezeSettings(),s=function(t,e,n,i){return new nl(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,cp(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new ip(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}class Sp{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Sp(Wc.fromBase64String(t))}catch(t){throw new Ya(Ja.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Sp(Wc.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class kp{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Ya(Ja.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vc(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ap{constructor(t){this._methodName=t}}class xp{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ya(Ja.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ya(Ja.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return hc(this._lat,t._lat)||hc(this._long,t._long)}}const Rp=/^__.*__$/;class Np{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new Hh(t,this.data,this.fieldMask,e,this.fieldTransforms):new qh(t,this.data,e,this.fieldTransforms)}}class Dp{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new Hh(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Op(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Wa()}}class Lp{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Eu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new Lp(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.mu(t),i}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.Eu(),i}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return Kp(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(Op(this.du)&&Rp.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class Pp{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Pd(t)}Su(t,e,n,i=!1){return new Lp({du:t,methodName:e,wu:n,path:vc.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mp(t){const e=t._freezeSettings(),n=Pd(t._databaseId);return new Pp(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Up(t,e,n,i,r,s={}){const o=t.Su(s.merge||s.mergeFields?2:0,e,n,r);zp("Data must be an object, but it was:",o,i);const a=jp(i,o);let c,l;if(s.merge)c=new Kc(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=qp(e,i,n);if(!o.contains(r))throw new Ya(Ja.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Gp(t,r)||t.push(r)}c=new Kc(t),l=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=o.fieldTransforms;return new Np(new wl(a),c,l)}class Fp extends Ap{_toFieldTransform(t){if(2!==t.du)throw 1===t.du?t.pu(`${this._methodName}() can only appear at the top level of your update data`):t.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Fp}}function Vp(t,e){if(Bp(t=k(t)))return zp("Unsupported field value:",e,t),jp(t,e);if(t instanceof Ap)return function(t,e){if(!Op(e.du))throw e.pu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.pu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&4!==e.du)throw e.pu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=Vp(r,e.gu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=k(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return _h(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=dc.fromDate(t);return{timestampValue:Eu(e.serializer,n)}}if(t instanceof dc){const n=new dc(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Eu(e.serializer,n)}}if(t instanceof xp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Sp)return{bytesValue:Tu(e.serializer,t._byteString)};if(t instanceof yp){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.pu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Su(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.pu(`Unsupported field value: ${fp(t)}`)}(t,e)}function jp(t,e){const n={};return jc(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vc(t,((t,i)=>{const r=Vp(i,e.Ru(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function Bp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof dc||t instanceof xp||t instanceof Sp||t instanceof yp||t instanceof Ap)}function zp(t,e,n){if(!Bp(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=fp(n);throw"an object"===i?e.pu(t+" a custom object"):e.pu(t+" "+i)}}function qp(t,e,n){if((e=k(e))instanceof kp)return e._internalPath;if("string"==typeof e)return $p(t,e);throw Kp("Field path arguments must be of type string or ",t,!1,void 0,n)}const Hp=new RegExp("[~\\*/\\[\\]]");function $p(t,e,n){if(e.search(Hp)>=0)throw Kp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new kp(...e.split("."))._internalPath}catch(i){throw Kp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Kp(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new Ya(Ja.INVALID_ARGUMENT,a+t+c)}function Gp(t,e){return t.some((t=>t.isEqual(e)))}class Wp{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new yp(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new Qp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Xp("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class Qp extends Wp{data(){return super.data()}}function Xp(t,e){return"string"==typeof e?$p(t,e):e instanceof kp?e._internalPath:e._delegate._internalPath}class Jp{convertValue(t,e="none"){switch(sl(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Jc(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Yc(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Wa()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Vc(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new xp(Jc(t.latitude),Jc(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=tl(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(el(t));default:return null}}convertTimestamp(t){const e=Xc(t);return new dc(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=mc.fromString(t);Qa(Ku(n));const i=new il(n.get(1),n.get(3)),r=new yc(n.popFirst(5));return i.isEqual(e)||$a(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}function Yp(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Zp{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class tm extends Wp{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new em(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Xp("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class em extends tm{data(t={}){return super.data(t)}}class nm{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Zp(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new em(this._firestore,this._userDataWriter,n.key,n,new Zp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ya(Ja.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new em(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Zp(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new em(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Zp(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:im(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function im(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Wa()}}class rm extends Jp{constructor(t){super(),this.firestore=t}convertBytes(t){return new Sp(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new yp(this.firestore,null,e)}}function sm(t){t=pp(t,vp);const e=pp(t.firestore,Tp),n=Ip(e),i=new rm(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Ya(Ja.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),function(t,e,n={}){const i=new Za;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const s=new np({next:n=>{e.enqueueAndForget((()=>Cf(t,o))),n.fromCache&&"server"===i.source?r.reject(new Ya(Ja.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:t=>r.reject(t)}),o=new xf(n,s,{includeMetadataChanges:!0,Z_:!0});return If(t,o)}(await ap(t),t.asyncQueue,e,n,i))),i.promise}(n,t._query).then((n=>new nm(e,i,t,n)))}function om(t,e,n,...i){t=pp(t,yp);const r=pp(t.firestore,Tp),s=Mp(r);let o;return o="string"==typeof(e=k(e))||e instanceof kp?function(t,e,n,i,r,s){const o=t.Su(1,e,n),a=[qp(e,i,n)],c=[r];if(s.length%2!=0)throw new Ya(Ja.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(qp(e,s[t])),c.push(s[t+1]);const l=[],h=wl.empty();for(let t=a.length-1;t>=0;--t)if(!Gp(l,a[t])){const e=a[t];let n=c[t];n=k(n);const i=o.fu(e);if(n instanceof Fp)l.push(e);else{const t=Vp(n,i);null!=t&&(l.push(e),h.set(e,t))}}const u=new Kc(l);return new Dp(h,u,o.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.Su(1,e,n);zp("Data must be an object, but it was:",r,i);const s=[],o=wl.empty();Vc(i,((t,i)=>{const a=$p(e,t,n);i=k(i);const c=r.fu(a);if(i instanceof Fp)s.push(a);else{const t=Vp(i,c);null!=t&&(s.push(a),o.set(a,t))}}));const a=new Kc(s);return new Dp(o,a,r.fieldTransforms)}(s,"updateDoc",t._key,e),cm(r,[o.toMutation(t._key,Ph.exists(!0))])}function am(t,e){const n=pp(t.firestore,Tp),i=_p(t),r=Yp(t.converter,e);return cm(n,[Up(Mp(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,Ph.exists(!1))]).then((()=>i))}function cm(t,e){return function(t,e){const n=new Za;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=Zf(t);try{const t=await function(t,e){const n=Xa(t),i=dc.now(),r=e.reduce(((t,e)=>t.add(e.key)),vh());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=ch(),c=vh();return n.os.getEntries(t,r).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((r=>{s=r;const o=[];for(const t of e){const e=Bh(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new Hh(t.key,e,bl(e.value.mapValue),Ph.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:uh(s)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Da[t.currentUser.toKey()];i||(i=new Bc(hc)),i=i.insert(e,n),t.Da[t.currentUser.toKey()]=i}(i,t.batchId,n),await Xf(i,t.changes),await sf(i.remoteStore)}catch(t){const e=yf(t,"Failed to persist write");n.reject(e)}}(await function(t){return op(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Ip(t),e)}new WeakMap,function(t,e=!0){!function(t){Ba=t}(mt),ut(new A("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Tp(new ic(t.getProvider("auth-internal")),new ac(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ya(Ja.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new il(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),yt(Va,"4.4.1",t),yt(Va,"4.4.1","esm2017")}();const lm="firebasestorage.googleapis.com",hm="storageBucket";class um extends v{constructor(t,e,n=0){super(pm(t),`Firebase Storage: ${e} (${pm(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,um.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return pm(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var dm,fm;function pm(t){return"storage/"+t}function mm(){return new um(dm.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function gm(t){return new um(dm.INVALID_ARGUMENT,t)}function vm(){return new um(dm.APP_DELETED,"The Firebase app was deleted.")}function ym(t,e){return new um(dm.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function wm(t){throw new um(dm.INTERNAL_ERROR,"Internal error: "+t)}!function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(dm||(dm={}));class bm{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=bm.makeFromUrl(t,e)}catch(e){return new bm(t,"")}if(""===n.path)return n;throw i=t,new um(dm.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.");var i}static makeFromUrl(t,e){let n=null;const i="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(t){t.path_=decodeURIComponent(t.path)}const o=e.replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${e===lm?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let e=0;e<a.length;e++){const i=a[e],r=i.regex.exec(t);if(r){const t=r[i.indices.bucket];let e=r[i.indices.path];e||(e=""),n=new bm(t,e),i.postModify(n);break}}if(null==n)throw function(t){return new um(dm.INVALID_URL,"Invalid URL '"+t+"'.")}(t);return n}}class _m{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function Em(t){return"string"==typeof t||t instanceof String}function Tm(t){return Im()&&t instanceof Blob}function Im(){return"undefined"!=typeof Blob}function Cm(t,e,n,i){if(i<e)throw gm(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw gm(`Invalid value for '${t}'. Expected ${n} or less.`)}function Sm(t,e,n){let i=e;return null==n&&(i=`https://${e}`),`${n}://${i}/v0${t}`}function km(t){const e=encodeURIComponent;let n="?";for(const i in t)t.hasOwnProperty(i)&&(n=n+(e(i)+"=")+e(t[i])+"&");return n=n.slice(0,-1),n}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(fm||(fm={}));class Am{constructor(t,e,n,i,r,s,o,a,c,l,h,u=!0){this.url_=t,this.method_=e,this.headers_=n,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=h,this.retry=u,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((t,e)=>{this.resolve_=t,this.reject_=e,this.start_()}))}start_(){const t=(t,e)=>{const n=this.resolve_,i=this.reject_,r=e.connection;if(e.wasSuccessCode)try{const t=this.callback_(r,r.getResponse());!function(t){return void 0!==t}(t)?n():n(t)}catch(t){i(t)}else if(null!==r){const t=mm();t.serverResponse=r.getErrorText(),this.errorCallback_?i(this.errorCallback_(r,t)):i(t)}else e.canceled?i(this.appDelete_?vm():new um(dm.CANCELED,"User canceled the upload/download.")):i(new um(dm.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(0,new xm(!1,null,!0)):this.backoffId_=function(t,e,n){let i=1,r=null,s=null,o=!1,a=0;function c(){return 2===a}let l=!1;function h(...t){l||(l=!0,e.apply(null,t))}function u(e){r=setTimeout((()=>{r=null,t(f,c())}),e)}function d(){s&&clearTimeout(s)}function f(t,...e){if(l)return void d();if(t)return d(),void h.call(null,t,...e);if(c()||o)return d(),void h.call(null,t,...e);let n;i<64&&(i*=2),1===a?(a=2,n=0):n=1e3*(i+Math.random()),u(n)}let p=!1;function m(t){p||(p=!0,d(),l||(null!==r?(t||(a=2),clearTimeout(r),u(0)):t||(a=1)))}return u(0),s=setTimeout((()=>{o=!0,m(!0)}),n),m}(((t,e)=>{if(e)return void t(!1,new xm(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=t=>{const e=t.loaded,n=t.lengthComputable?t.total:-1;null!==this.progressCallback_&&this.progressCallback_(e,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const e=n.getErrorCode()===fm.NO_ERROR,r=n.getStatus();if(!e||function(t,e){const n=t>=500&&t<600,i=-1!==[408,429].indexOf(t),r=-1!==e.indexOf(t);return n||i||r}(r,this.additionalRetryCodes_)&&this.retry){const e=n.getErrorCode()===fm.ABORT;return void t(!1,new xm(!1,null,e))}const s=-1!==this.successCodes_.indexOf(r);t(!0,new xm(s,n))}))}),t,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class xm{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}function Rm(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Nm(...t){const e=Rm();if(void 0!==e){const n=new e;for(let e=0;e<t.length;e++)n.append(t[e]);return n.getBlob()}if(Im())return new Blob(t);throw new um(dm.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Dm={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Om{constructor(t,e){this.data=t,this.contentType=e||null}}function Lm(t){const e=[];for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<=127?e.push(i):i<=2047?e.push(192|i>>6,128|63&i):55296==(64512&i)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(i=65536|(1023&i)<<10|1023&t.charCodeAt(++n),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):e.push(239,191,189):56320==(64512&i)?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(e)}function Pm(t,e){switch(t){case Dm.BASE64:{const n=-1!==e.indexOf("-"),i=-1!==e.indexOf("_");if(n||i)throw ym(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case Dm.BASE64URL:{const n=-1!==e.indexOf("+"),i=-1!==e.indexOf("/");if(n||i)throw ym(t,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function(t){if("undefined"==typeof atob)throw new um(dm.UNSUPPORTED_ENVIRONMENT,"base-64 is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.");return atob(t)}(e)}catch(e){if(e.message.includes("polyfill"))throw e;throw ym(t,"Invalid character found")}const i=new Uint8Array(n.length);for(let t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i}class Mm{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(null===e)throw ym(Dm.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=e[1]||null;var i,r;null!=n&&(this.base64=(r=";base64",(i=n).length>=7&&i.substring(i.length-7)===r),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}class Um{constructor(t,e){let n=0,i="";Tm(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(Tm(this.data_)){const s=(n=this.data_,i=t,r=e,n.webkitSlice?n.webkitSlice(i,r):n.mozSlice?n.mozSlice(i,r):n.slice?n.slice(i,r):null);return null===s?null:new Um(s)}var n,i,r;{const n=new Uint8Array(this.data_.buffer,t,e-t);return new Um(n,!0)}}static getBlob(...t){if(Im()){const e=t.map((t=>t instanceof Um?t.data_:t));return new Um(Nm.apply(null,e))}{const e=t.map((t=>Em(t)?function(t,e){switch(t){case Dm.RAW:return new Om(Lm(e));case Dm.BASE64:case Dm.BASE64URL:return new Om(Pm(t,e));case Dm.DATA_URL:return new Om(function(t){const e=new Mm(t);return e.base64?Pm(Dm.BASE64,e.rest):function(t){let e;try{e=decodeURIComponent(t)}catch(t){throw ym(Dm.DATA_URL,"Malformed data URL.")}return Lm(e)}(e.rest)}(e),new Mm(e).contentType)}throw mm()}(Dm.RAW,t).data:t.data_));let n=0;e.forEach((t=>{n+=t.byteLength}));const i=new Uint8Array(n);let r=0;return e.forEach((t=>{for(let e=0;e<t.length;e++)i[r++]=t[e]})),new Um(i,!0)}}uploadData(){return this.data_}}function Fm(t){let e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function Vm(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function jm(t,e){return e}class Bm{constructor(t,e,n,i){this.server=t,this.local=e||t,this.writable=!!n,this.xform=i||jm}}let zm=null;function qm(){if(zm)return zm;const t=[];t.push(new Bm("bucket")),t.push(new Bm("generation")),t.push(new Bm("metageneration")),t.push(new Bm("name","fullPath",!0));const e=new Bm("name");e.xform=function(t,e){return function(t){return!Em(t)||t.length<2?t:Vm(t)}(e)},t.push(e);const n=new Bm("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new Bm("timeCreated")),t.push(new Bm("updated")),t.push(new Bm("md5Hash",null,!0)),t.push(new Bm("cacheControl",null,!0)),t.push(new Bm("contentDisposition",null,!0)),t.push(new Bm("contentEncoding",null,!0)),t.push(new Bm("contentLanguage",null,!0)),t.push(new Bm("contentType",null,!0)),t.push(new Bm("metadata","customMetadata",!0)),zm=t,zm}function Hm(t,e,n){const i=Fm(e);return null===i?null:function(t,e,n){const i={type:"file"},r=n.length;for(let t=0;t<r;t++){const r=n[t];i[r.local]=r.xform(i,e[r.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){const n=t.bucket,i=t.fullPath,r=new bm(n,i);return e._makeStorageReference(r)}})}(i,t),i}(t,i,n)}class $m{constructor(t,e,n,i){this.url=t,this.method=e,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Km(t){if(!t)throw mm()}function Gm(t){return function(e,n){let i;var r,s;return 401===e.getStatus()?i=e.getErrorText().includes("Firebase App Check token is invalid")?new um(dm.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new um(dm.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(s=t.bucket,i=new um(dm.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(r=t.path,i=new um(dm.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")):i=n,i.status=e.getStatus(),i.serverResponse=n.serverResponse,i}}function Wm(t,e,n,i,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let t="";for(let e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();o["Content-Type"]="multipart/related; boundary="+a;const c=function(t,e,n){const i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),i}(e,i,r),l="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+function(t,e){const n={},i=e.length;for(let r=0;r<i;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",h="\r\n--"+a+"--",u=Um.getBlob(l,i,h);if(null===u)throw new um(dm.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.");const d={name:c.fullPath},f=Sm(s,t.host,t._protocol),p=t.maxUploadRetryTime,m=new $m(f,"POST",function(t,e){return function(n,i){const r=Hm(t,i,e);return Km(null!==r),r}}(t,n),p);return m.urlParams=d,m.headers=o,m.body=u.uploadData(),m.errorHandler=Gm(e),m}let Qm=null;class Xm{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fm.NO_ERROR,this.sendPromise_=new Promise((t=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=fm.ABORT,t()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=fm.NETWORK_ERROR,t()})),this.xhr_.addEventListener("load",(()=>{t()}))}))}send(t,e,n,i){if(this.sent_)throw wm("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==i)for(const t in i)i.hasOwnProperty(t)&&this.xhr_.setRequestHeader(t,i[t].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw wm("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw wm("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}}getResponse(){if(!this.sent_)throw wm("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw wm("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class Jm extends Xm{initXhr(){this.xhr_.responseType="text"}}function Ym(){return Qm?Qm():new Jm}class Zm{constructor(t,e){this._service=t,this._location=e instanceof bm?e:bm.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Zm(t,e)}get root(){const t=new bm(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Vm(this._location.path)}get storage(){return this._service}get parent(){const t=function(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===t)return null;const e=new bm(this._location.bucket,t);return new Zm(this._service,e)}_throwIfRoot(t){if(""===this._location.path)throw function(t){return new um(dm.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)}}function tg(t){t._throwIfRoot("getDownloadURL");const e=function(t,e,n){const i=Sm(e.fullServerUrl(),t.host,t._protocol),r=t.maxOperationRetryTime,s=new $m(i,"GET",function(t,e){return function(n,i){const r=Hm(t,i,e);return Km(null!==r),function(t,e,n,i){const r=Fm(e);if(null===r)return null;if(!Em(r.downloadTokens))return null;const s=r.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((e=>{const r=t.bucket,s=t.fullPath;return Sm("/b/"+o(r)+"/o/"+o(s),n,i)+km({alt:"media",token:e})}))[0]}(r,i,t.host,t._protocol)}}(t,n),r);return s.errorHandler=function(t){const e=Gm(t);return function(n,i){let r=e(n,i);var s;return 404===n.getStatus()&&(s=t.path,r=new um(dm.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),r.serverResponse=i.serverResponse,r}}(e),s}(t.storage,t._location,qm());return t.storage.makeRequestWithTokens(e,Ym).then((t=>{if(null===t)throw new um(dm.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return t}))}function eg(t,e){if(t instanceof ig){const n=t;if(null==n._bucket)throw new um(dm.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+hm+"' property when initializing the app?");const i=new Zm(n,n._bucket);return null!=e?eg(i,e):i}return void 0!==e?function(t,e){const n=function(t,e){const n=e.split("/").filter((t=>t.length>0)).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),i=new bm(t._location.bucket,n);return new Zm(t.storage,i)}(t,e):t}function ng(t,e){const n=null==e?void 0:e[hm];return null==n?null:bm.makeFromBucketSpec(n,t)}class ig{constructor(t,e,n,i,r){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=lm,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?bm.makeFromBucketSpec(i,this._host):ng(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,null!=this._url?this._bucket=bm.makeFromBucketSpec(this._url,t):this._bucket=ng(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Cm("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Cm("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(null!==e)return e.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((t=>t.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Zm(this,t)}_makeRequest(t,e,n,i,r=!0){if(this._deleted)return new _m(vm());{const s=function(t,e,n,i,r,s,o=!0){const a=km(t.urlParams),c=t.url+a,l=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(l,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(l,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(l,s),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(l,i),new Am(c,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}(t,this._appId,n,i,e,this._firebaseVersion,r);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(t,e){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n,i).getPromise()}}const rg="@firebase/storage",sg="0.12.0",og="storage";function ag(t,e){return function(t,e){if(e&&/^[A-Za-z]+:\/\//.test(e)){if(t instanceof ig)return new Zm(t,e);throw gm("To use ref(service, url), the first argument must be a Storage instance.")}return eg(t,e)}(t=k(t),e)}ut(new A(og,(function(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new ig(n,i,r,e,mt)}),"PUBLIC").setMultipleInstances(!0)),yt(rg,sg,""),yt(rg,sg,"esm2017");var cg=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const lg=gt({apiKey:"AIzaSyAS_sGDbQYUNZAoF-ZqZcpjWtLQtBmDvsw",authDomain:"proyecto-dca-1b72d.firebaseapp.com",projectId:"proyecto-dca-1b72d",storageBucket:"proyecto-dca-1b72d.appspot.com",messagingSenderId:"272880735350",appId:"1:272880735350:web:f0dbcec16d1c028a4afb57",measurementId:"G-L13XCXHTB8"}),hg=function(t,e){const n="string"==typeof t?t:"(default)",i=dt("object"==typeof t?t:vt(),"firestore").getImmediate({identifier:n});if(!i._initialized){const t=h("firestore");t&&function(t,e,n,i={}){var r;const s=(t=pp(t,gp))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Ka("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=ja.MOCK_USER;else{e=p(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new Ya(Ja.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ja(s)}t._authCredentials=new nc(new tc(e,n))}}(i,...t)}return i}(lg),ug=function(t=vt()){const e=dt(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=dt(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(b(n.getOptions(),null!=e?e:{}))return t;Pt(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:fi,persistence:[Ln,vn,wn]}),i=d("authTokenSyncURL");if(i){const t=(r=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>vi)return;const i=null==e?void 0:e.token;yi!==i&&(yi=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){k(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,r){k(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var r;const s=l("auth");return s&&function(t,e,n){const i=Pe(t);Ft(i._canInitEmulator,i,"emulator-config-failed"),Ft(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=ze(e),{host:o,port:a}=function(t){const e=ze(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:qe(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:qe(e)}}}(e),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}(lg),dg=function(t=vt(),e){const n=dt(t=k(t),og).getImmediate({identifier:e}),i=h("storage");return i&&function(t,e,n,i={}){!function(t,e,n,i={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=i;r&&(t._overrideAuthToken="string"==typeof r?r:p(r,t.app.options.projectId))}(t,e,n,i)}(n,...i),n}();let fg=null;const pg=t=>{console.log(t),function(t,e,n){return async function(t,e){return dn(Pe(t),e)}(k(t),Ze.credential(e,n)).catch((async e=>{throw"auth/password-does-not-meet-requirements"===e.code&&fn(t),e}))}(ug,t.email,t.password).then((t=>cg(void 0,void 0,void 0,(function*(){const e=t.user;console.log(e.uid)})))).catch((t=>{const e=t.code,n=t.message;console.error(e,n)}))},mg=t=>cg(void 0,void 0,void 0,(function*(){const e=_p(hg,"users",t);return(yield function(t){t=pp(t,yp);const e=pp(t.firestore,Tp);return function(t,e,n={}){const i=new Za;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const s=new np({next:s=>{e.enqueueAndForget((()=>Cf(t,o)));const a=s.docs.has(n);!a&&s.fromCache?r.reject(new Ya(Ja.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&i&&"server"===i.source?r.reject(new Ya(Ja.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:t=>r.reject(t)}),o=new xf(Ql(n.path),s,{includeMetadataChanges:!0,Z_:!0});return If(t,o)}(await ap(t),t.asyncQueue,e,n,i))),i.promise}(Ip(e),t._key).then((n=>function(t,e,n){const i=n.docs.get(e._key),r=new rm(t);return new tm(t,r,e._key,i,new Zp(n.hasPendingWrites,n.fromCache),e.converter)}(e,t,n)))}(e)).data()})),gg=(t,e)=>cg(void 0,void 0,void 0,(function*(){(function(t,e,n){return function(t,e,n){t._throwIfRoot("uploadBytes");const i=Wm(t.storage,t._location,qm(),new Um(e,!0),n);return t.storage.makeRequestWithTokens(i,Ym).then((e=>({metadata:e,ref:t})))}(t=k(t),e,void 0)})(ag(dg,"imgsProfile/"+e),t).then((t=>{console.log("Uploaded a blob or file!")}))}));const vg=t=>({action:"navigate",payload:t});var yg;!function(t){t.LOGIN="LOGIN",t.HOME="HOME"}(yg||(yg={})),function(t,e,n,i){k(t).onAuthStateChanged((t=>{t?(null!==t.uid&&_g((t=>({action:"SETUSER",payload:t}))(t.uid)),_g(vg(yg.HOME))):_g(vg(yg.LOGIN))}),void 0,void 0)}(ug);let wg={screen:"",userId:"",userSongs:[],myUserSongs:[]},bg=[];const _g=t=>{const e=((t,e)=>{const{action:n,payload:i}=t;switch(n){case"navigate":e.screen=i;break;case"SETUSER":e.userId=i;break;case"GETUSERSONGS":e.userSongs=i;break;case"GETMYUSERSONGS":e.myUserSongs=i}return e})(t,JSON.parse(JSON.stringify(wg)));wg=e,bg.forEach((t=>t.render()))},Eg=t=>{bg=[...bg,t]};var Tg;!function(t){t.uid="uid",t.iconohome="iconohome",t.iconoexplore="iconoexplore",t.iconoprofile="iconoprofile"}(Tg||(Tg={}));class Ig extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,iconohome:null,iconoexplore:null,iconoprofile:null})}attributeChangedCallback(t,e,n){t===Tg.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t,n,i,r;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t<section class="menubar">\n\t\t<svg id="home">${this.iconohome}</svg>\n\t\t<img id="explore" src=${this.iconoexplore}></svg>\n\t\t<svg id="profile">${this.iconoprofile}</svg>\n\t\t\t</section>`);const s=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#home");null==s||s.addEventListener("click",(()=>{_g(vg("HOME"))}));const o=null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector("#explore");null==o||o.addEventListener("click",(()=>{_g(vg("EXPLORE"))}));const a=null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector("#profile");null==a||a.addEventListener("click",(()=>{_g(vg("PROFILE"))}));const c=this.ownerDocument.createElement("style");c.innerHTML=e.A,null===(r=this.shadowRoot)||void 0===r||r.appendChild(c)}}customElements.define("my-iconos",Ig);const Cg=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg"}];var Sg,kg=n(507);!function(t){t.uid="uid",t.logo="logo"}(Sg||(Sg={}));class Ag extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,logo:null})}attributeChangedCallback(t,e,n){t===Sg.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t,e;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n    <section class="header">\n\t\t<section class="logo">\n    <img src='${this.logo}'></img>\n\t\t</section>\n    </section>`);const n=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".logo");null==n||n.addEventListener("click",(()=>{_g(vg("HOME"))}));const i=this.ownerDocument.createElement("style");i.innerHTML=kg.A,null===(e=this.shadowRoot)||void 0===e||e.appendChild(i)}}customElements.define("my-header",Ag);const xg=[{id:1,name:"Susana GarcÃ­a",wave:"",image:"https://images.pexels.com/photos/3646160/pexels-photo-3646160.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",unlike:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"/></svg>',like:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6bc" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>',cantidadlike:"6,4k",share:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>',cantidadshare:"49k",comentar:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4l0 0 0 0 0 0 0 0 .3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"/></svg>',cantidadcomentar:"6,9k"}];var Rg,Ng=n(357);!function(t){t.unlike="unlike",t.like="like",t.cantidadlike="cantidadlike",t.share="share",t.cantidadshare="cantidadshare",t.comentar="comentar",t.cantidadcomentar="cantidadcomentar",t.profileuid="profileuid",t.name="name",t.image="image",t.wave="wave"}(Rg||(Rg={}));class Dg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({unlike:null,like:null,cantidadlike:null,share:null,cantidadshare:null,comentar:null,cantidadcomentar:null,profileuid:null,name:null,image:null,wave:null})}attributeChangedCallback(t,e,n){t===Rg.profileuid?this.profileuid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render(),this.attachEventHandlers()}attachEventHandlers(){var t,e;const n=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".like"),i=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".unlike");n&&i&&(n.addEventListener("click",(()=>{n.style.display="none",i.style.display="block",localStorage.setItem("likeState","block")})),i.addEventListener("click",(()=>{n.style.display="block",i.style.display="none",localStorage.setItem("likeState","none")})),"none"===localStorage.getItem("likeState")&&(n.style.display="none",i.style.display="block"))}render(){return function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){var t;if(this.shadowRoot){this.shadowRoot.innerHTML="";const e=this.ownerDocument.createElement("style");e.innerHTML=Ng.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e),(yield cg(void 0,void 0,void 0,(function*(){const t=yield sm(bp(hg,"waves")),e=[];return t.forEach((t=>{const n=t.data();e.push(Object.assign({id:t.id},n))})),e}))).forEach((t=>{var e;const n=document.createElement("section");n.className="cardEntera";const i=document.createElement("section");i.className="profile";const r=document.createElement("section");r.className="image";const s=document.createElement("img");s.src=this.image||"undefined",r.appendChild(s);const o=document.createElement("p");o.className="username",o.textContent=this.name||"No Username",i.appendChild(r),i.appendChild(o);const a=document.createElement("section");a.className="wave";const c=this.ownerDocument.createElement("p");c.innerText=t.wave,a.appendChild(c);const l=document.createElement("section");l.className="interacciones";const h=document.createElement("section");h.className="like_group";const u=document.createElement("svg");u.id="svg",u.className="unlike",u.innerHTML=this.unlike||"undefined";const d=document.createElement("svg");d.id="svg_like",d.className="like",d.style.display="none",d.innerHTML=this.like||"undefined";const f=document.createElement("p");f.textContent=this.cantidadlike||"undefined",h.appendChild(u),h.appendChild(d),h.appendChild(f);const p=document.createElement("section");p.className="share";const m=document.createElement("svg");m.id="svg",m.innerHTML=this.share||"undefined";const g=document.createElement("p");g.textContent=this.cantidadshare||"undefined",p.appendChild(m),p.appendChild(g);const v=document.createElement("section");v.className="comment";const y=document.createElement("svg");y.id="svg",y.innerHTML=this.comentar||"undefined";const w=document.createElement("p");w.textContent=this.cantidadcomentar||"undefined",v.appendChild(y),v.appendChild(w),l.appendChild(h),l.appendChild(p),l.appendChild(v),n.appendChild(i),n.appendChild(a),n.appendChild(l),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}))}}))}}customElements.define("my-card",Dg);var Og=n(9),Lg=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const Pg={wave:""};class Mg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Eg(this)}connectedCallback(){return Lg(this,void 0,void 0,(function*(){const t=yield mg(wg.userId);this.render(t)}))}changeWave(t){Pg.wave=t.target.value}submitForm(){var t;t=Pg,cg(void 0,void 0,void 0,(function*(){try{const e=bp(hg,"waves");yield am(e,t),console.log("se aÃ±adiÃ³ con Ã©xito")}catch(t){console.error(t)}}))}render(e){return Lg(this,void 0,void 0,(function*(){var n,i,r,s;if(this.shadowRoot){Cg.forEach((t=>{var e;const n=document.createElement("my-header");n.setAttribute(Sg.logo,t.logo),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const o=this.ownerDocument.createElement("h1");o.textContent="Share your wave!",null===(n=this.shadowRoot)||void 0===n||n.appendChild(o);const a=this.ownerDocument.createElement("input");a.placeholder="Enter your Wave",a.classList.add("image"),a.addEventListener("change",this.changeWave),this.shadowRoot.appendChild(a);const c=this.ownerDocument.createElement("button");c.innerText="Share",c.classList.add("save"),c.addEventListener("click",this.submitForm.bind(this)),null===(i=this.shadowRoot)||void 0===i||i.appendChild(c);const l=this.ownerDocument.createElement("h2");l.textContent="For You",null===(r=this.shadowRoot)||void 0===r||r.appendChild(l),xg.forEach((t=>{var n;const i=document.createElement("my-card");i.setAttribute(Rg.name,e.username),i.setAttribute(Rg.image,e.profile_image||"https://static.vecteezy.com/system/resources/thumbnails/005/129/844/small_2x/profile-user-icon-isolated-on-white-background-eps10-free-vector.jpg"),i.setAttribute(Rg.unlike,t.unlike),i.setAttribute(Rg.like,t.like),i.setAttribute(Rg.cantidadlike,t.cantidadlike),i.setAttribute(Rg.share,t.share),i.setAttribute(Rg.cantidadshare,t.cantidadshare),i.setAttribute(Rg.comentar,t.comentar),i.setAttribute(Rg.cantidadcomentar,t.cantidadcomentar),null===(n=this.shadowRoot)||void 0===n||n.appendChild(i)})),t.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(Tg.iconohome,t.iconohome),n.setAttribute(Tg.iconoexplore,t.iconoexplore),n.setAttribute(Tg.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const h=this.ownerDocument.createElement("style");h.innerHTML=Og.A,null===(s=this.shadowRoot)||void 0===s||s.appendChild(h)}}))}}customElements.define("app-dashboard",Mg);const Ug=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg",log_out:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1e1e1e" d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/></svg>'}];var Fg;!function(t){t.uid="uid",t.logo="logo",t.log_out="log_out"}(Fg||(Fg={}));class Vg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,logo:null,log_out:null})}attributeChangedCallback(t,e,n){t===Fg.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}logout(){indexedDB.deleteDatabase("firebase-heartbeat-database"),indexedDB.deleteDatabase("firebaseLocalStorageDb"),window.location.reload()}render(){if(this.shadowRoot){this.shadowRoot.innerHTML=`\n\t\t\t\t<section class="header">\n\t\t\t\t\t<section class="logo">\n\t\t\t\t\t\t<img src='${this.logo}'></img>\n\t\t\t\t\t</section>\n\n\t\t\t\t\t<button id="log_out">\n\t\t\t\t\t\t<svg class="log_out" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\n\t\t\t\t\t\t\t\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e\n\t\t\t\t\t\t\t<path fill="#1e1e1e" d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</section>\n\n\t\t\t\t<section class="modalContainer" style="display:none;">\n\t\t\t\t\t<form class="logout">\n\t\t\t\t\t\t<h2>You are logging out</h2>\n\t\t\t\t\t\t<section class="botones">\n\t\t\t\t\t\t<span role="button" class="Cancel">Cancel</span>\n\t\t\t\t\t\t<span role="button" class="Accept">Accept</span>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t</form>\n\t\t\t\t</section>\n\t\t\t`;const t=this.shadowRoot.querySelector(".modalContainer"),e=this.shadowRoot.querySelector("#log_out"),n=this.shadowRoot.querySelector(".Accept"),i=this.shadowRoot.querySelector(".Cancel");e.addEventListener("click",(()=>{t.style.display="block",document.body.style.overflow="hidden"})),window.addEventListener("click",(e=>{e.target==t&&(t.style.display="none",document.body.style.overflow="auto")})),n.addEventListener("click",(()=>{this.logout()})),i.addEventListener("click",(()=>{t.style.display="none",document.body.style.overflow="auto"}));const r=this.shadowRoot.querySelector(".logo");null==r||r.addEventListener("click",(()=>{_g(vg("HOME"))}));const s=this.ownerDocument.createElement("style");s.innerHTML=kg.A,this.shadowRoot.appendChild(s)}}}customElements.define("my-headerprofile",Vg);const jg=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1E1E1E" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'"https://i.pinimg.com/originals/94/67/f5/9467f504e83345d60816f9b87ac84588.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#ff9f1c" d="M399 384.2C376.9 345.8 335.4 320 288 320H224c-47.4 0-88.9 25.8-111 64.2c35.2 39.2 86.2 63.8 143 63.8s107.8-24.7 143-63.8zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 16a72 72 0 1 0 0-144 72 72 0 1 0 0 144z"/></svg>'}];var Bg,zg=n(831),qg=n(471);!function(t){t.artist="artist",t.song_title="song_title",t.image="image",t.top="top"}(Bg||(Bg={}));class Hg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({artist:null,song_title:null,image:null,top:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}render(){var t;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t<section class = "card">\n\n\n\t\t\t<p class="top">${this.top}</p>\n\n\t\t\t<section class= "imagen">\n\t\t\t<img src="${this.image}" alt= "cover album"></img>\n\t\t\t</section>\n\n\t\t\t<section class = "letters">\n\n\t\t\t<section class = "title">\n\t\t\t<p>${this.song_title}</p>\n\t\t\t</section>\n\n\t\t<section class = "artist">\n\t\t<p>${this.artist}</p>\n\t\t</section>\n\n\n\t\t</section>\n\n\t\t</section>\n    `);const e=this.ownerDocument.createElement("style");e.innerHTML=qg.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}}customElements.define("my-songs",Hg);var $g=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const Kg={top:"",artist:"",song_title:"",image:"",duration:"",idUser:""};var Gg;!function(t){t.profile_image="profile_image",t.username="username",t.fav_song="fav_song",t.completeName="completeName"}(Gg||(Gg={}));class Wg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Eg(this)}static get observedAttributes(){return Object.keys({profile_image:null,username:null,fav_song:null,completeName:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){return $g(this,void 0,void 0,(function*(){if(0===wg.userSongs.length){const t=yield function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(void 0,void 0,void 0,(function*(){return{action:"GETUSERSONGS",payload:yield cg(void 0,void 0,void 0,(function*(){const t=yield sm(bp(hg,"playlist")),e=[];return t.forEach((t=>{const n=t.data();e.push(Object.assign({id:t.id},n))})),e}))}}));_g(t)}else this.render()}))}submitForm(){var t;Kg.idUser=wg.userId,t=Kg,cg(void 0,void 0,void 0,(function*(){try{const e=bp(hg,"playlist");yield am(e,t),console.log("se aÃ±adiÃ³ con Ã©xito")}catch(t){console.error(t)}}))}changeArtist(t){Kg.artist=t.target.value}changeTitle(t){Kg.song_title=t.target.value}changeImage(t){Kg.image=t.target.value}render(){return $g(this,void 0,void 0,(function*(){var t,e,n,i,r,s,o,a,c,l,h,u,d,f,p,m,g;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t<section class="todo">\n\t\t<section class="profile">\n\t\t<section class="profileimg">\n\t\t<img src="${this.profile_image}"></img>\n\t\t</section>\n\t\t<h1>${this.username}</h1>\n\t\t<Button class="edit" id="edit">Edit picture</Button>\n\t\t<button id="ButtonSong">\n\t\t<p class="fav_song"><svg class="pin"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgb(46, 196, 182);transform: ;msFilter:;"><path d="M15 11.586V6h2V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2h2v5.586l-2.707 1.707A.996.996 0 0 0 6 14v2a1 1 0 0 0 1 1h4v3l1 2 1-2v-3h4a1 1 0 0 0 1-1v-2a.996.996 0 0 0-.293-.707L15 11.586z"></path></svg></svg>\n\t\t${this.fav_song}</p>\n\t\t</section>\n\t\t<section class="name-following">\n\t\t<p class="name">${this.completeName}</p>\n\t\t<p class="following">100 following</p>\n\t\t</section>\n\t\t<p class="followers">238 followers</p>\n\t\t<Button class="playlist">Playlists</Button>\n\t\t</section>\n\t\t</section>\n\n\t\t<section class="modalContainer" style="display:none;">\n\t\t<form class="waveSong">\n\t\t    <span class="close">X</span>\n\t\t    <h2>What's your wave song at the moment?</h2>\n\t\t    <textarea id="writtenSong" name="wave"></textarea>\n\t\t    <span role="button" class="post">Post</span>\n\t\t</form>\n\t\t</section>\n\n\t\t<section id="modalContainerProfileImg" style="display:none;">\n\t\t<form class="profileImgForm">\n\t\t    <h2>Set your new profile image</h2>\n\t\t\t\t<section class="fileContainer">\n\t\t\t\t<input role="button" class="File"></input>\n\t\t\t\t</section>\n\t\t\t\t<textarea id="newProfileImage" name="profileImage" placeholder="Or insert URL"></textarea>\n\t\t\t\t<section class="botones">\n\t\t\t\t<span role="button" class="Cancel">Cancel</span>\n\t\t    <span role="button" class="Accept">Done</span>\n\t\t\t\t</section>\n\t\t</form>\n\t\t</section>\n\t\t`);const v=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".File");v.type="file",v.addEventListener("change",(()=>{var t,e;const n=null===(t=v.files)||void 0===t?void 0:t[0];n&&gg(n,wg.userId),null===(e=this.shadowRoot)||void 0===e||e.appendChild(v)}));const y=yield(t=>cg(void 0,void 0,void 0,(function*(){localStorage.getItem("imgProfile");const e=ag(dg,"imgsProfile/"+t);return yield function(t){return tg(t=k(t))}(ag(e)).then((t=>t)).catch((t=>{console.error(t)}))})))(wg.userId),w=null===(e=this.ownerDocument)||void 0===e?void 0:e.createElement("img");w.src=String(y),null===(n=this.shadowRoot)||void 0===n||n.appendChild(w);const b=this.ownerDocument.createElement("h1");b.textContent="Add your own song",b.classList.add("h1Add"),null===(i=this.shadowRoot)||void 0===i||i.appendChild(b);const _=this.ownerDocument.createElement("section");_.classList.add("create-song");const E=this.ownerDocument.createElement("input");E.placeholder="Add an artist",E.classList.add("artist"),E.addEventListener("change",this.changeArtist),_.appendChild(E);const T=this.ownerDocument.createElement("input");T.placeholder="Add the song title",T.classList.add("title"),T.addEventListener("change",this.changeTitle),_.appendChild(T);const I=this.ownerDocument.createElement("input");I.placeholder="Add the album cover",I.classList.add("coverImage"),I.addEventListener("change",this.changeImage),_.appendChild(I),null===(r=this.shadowRoot)||void 0===r||r.appendChild(_);const C=this.ownerDocument.createElement("button");C.innerText="Save",C.classList.add("save"),C.addEventListener("click",this.submitForm),null===(s=this.shadowRoot)||void 0===s||s.appendChild(C),wg.userSongs.forEach((t=>{var e;const n=this.ownerDocument.createElement("my-songs");n.setAttribute(Bg.top,"â"),n.setAttribute(Bg.image,t.image),n.setAttribute(Bg.artist,t.artist),n.setAttribute(Bg.song_title,t.song_title),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const S=null===(o=this.shadowRoot)||void 0===o?void 0:o.querySelector(".modalContainer"),A=null===(a=this.shadowRoot)||void 0===a?void 0:a.querySelector("#ButtonSong"),x=null===(c=this.shadowRoot)||void 0===c?void 0:c.querySelector(".close");(null===(l=this.shadowRoot)||void 0===l?void 0:l.querySelector(".post")).addEventListener("click",(()=>$g(this,void 0,void 0,(function*(){var t;const e=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#writtenSong"),n=e.value;var i;i=n,cg(void 0,void 0,void 0,(function*(){const t=_p(hg,"users",wg.userId);yield om(t,{fav_song:i})})),e.value="",S.style.display="none",document.body.style.overflow="auto"})))),(null===(h=this.shadowRoot)||void 0===h?void 0:h.querySelector(".post")).addEventListener("click",(t=>{var e;t.preventDefault();const n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#writtenSong"),i=n.value;console.log("Entered wave:",i),n.value="",S.style.display="none",R.style.overflow="auto"}));const R=document.body;R&&(A.addEventListener("click",(()=>{S.style.display="block",R.style.overflow="hidden"})),x.addEventListener("click",(()=>{S.style.display="none",R.style.overflow="auto",window.addEventListener("click",(t=>{t.target==S&&(S.style.display="none",R.style.overflow="auto")}))})));const N=null===(u=this.shadowRoot)||void 0===u?void 0:u.querySelector("#modalContainerProfileImg"),D=null===(d=this.shadowRoot)||void 0===d?void 0:d.querySelector("#edit"),O=null===(f=this.shadowRoot)||void 0===f?void 0:f.querySelector(".Accept"),L=null===(p=this.shadowRoot)||void 0===p?void 0:p.querySelector(".Cancel");D.addEventListener("click",(()=>{N.style.display="block",document.body.style.overflow="hidden"})),O.addEventListener("click",(()=>$g(this,void 0,void 0,(function*(){var t;const e=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#newProfileImage");var n;n=e.value,cg(void 0,void 0,void 0,(function*(){const t=_p(hg,"users",wg.userId);yield om(t,{profile_image:n})})),e.value="",N.style.display="none",document.body.style.overflow="auto"})))),(null===(m=this.shadowRoot)||void 0===m?void 0:m.querySelector(".Accept")).addEventListener("click",(t=>{var e;t.preventDefault();const n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#newProfileImage"),i=n.value;console.log("Entered wave:",i),n.value="",N.style.display="none",R.style.overflow="auto"})),L.addEventListener("click",(()=>{N.style.display="none",document.body.style.overflow="auto"})),window.addEventListener("click",(t=>{t.target===N&&(N.style.display="none",document.body.style.overflow="auto")}));const P=this.ownerDocument.createElement("style");P.innerHTML=zg.A,null===(g=this.shadowRoot)||void 0===g||g.appendChild(P)}))}}customElements.define("my-perfil",Wg);var Qg=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};class Xg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Eg(this)}connectedCallback(){return Qg(this,void 0,void 0,(function*(){console.log(wg.userId);const t=yield mg(wg.userId);this.render(t)}))}render(t){return Qg(this,void 0,void 0,(function*(){var e;this.shadowRoot&&Ug.forEach((t=>{var e;const n=document.createElement("my-headerprofile");n.setAttribute(Fg.logo,t.logo),n.setAttribute(Fg.log_out,t.log_out),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const n=document.createElement("my-perfil");n.setAttribute(Gg.profile_image,t.profile_image||"https://static.vecteezy.com/system/resources/thumbnails/005/129/844/small_2x/profile-user-icon-isolated-on-white-background-eps10-free-vector.jpg"),n.setAttribute(Gg.username,t.username),n.setAttribute(Gg.completeName,t.completeName),n.setAttribute(Gg.fav_song,t.fav_song||"Add Your Wave Song"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n),jg.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(Tg.iconohome,t.iconohome),n.setAttribute(Tg.iconoexplore,t.iconoexplore),n.setAttribute(Tg.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}))}))}}customElements.define("app-perfil",Xg);var Jg,Yg=n(499);!function(t){t.uid="uid",t.name="name",t.photo="photo",t.profile="profile",t.song="song"}(Jg||(Jg={}));class Zg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,photo:null,name:null,profile:null,song:null})}attributeChangedCallback(t,e,n){t===Jg.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\n\t\t<section class="card" style="background-image: url('${this.photo}');background-position-x: center;background-size: cover;">\n\t\t<section class="todo">\n\t\t<section class= "image">\n\t\t<img src='${this.profile}'></img>\n    <p>${this.name}</p>\n\t\t</section>\n\t\t<section class="song">\n    <h3>${this.song}</h3>\n\t\t</section>\n\t\t</section>\n\t\t</section>\n\t\t`);const e=this.ownerDocument.createElement("style");e.innerHTML=Yg.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}}customElements.define("my-friend",Zg);const tv=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1E1E1E" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'\t"https://i.pinimg.com/originals/33/ff/00/33ff00839226a94f68b571016bc6d99c.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgb(32, 32, 32);transform: ;msFilter:;"><path d="M12 2C6.579 2 2 6.579 2 12s4.579 10 10 10 10-4.579 10-10S17.421 2 12 2zm0 5c1.727 0 3 1.272 3 3s-1.273 3-3 3c-1.726 0-3-1.272-3-3s1.274-3 3-3zm-5.106 9.772c.897-1.32 2.393-2.2 4.106-2.2h2c1.714 0 3.209.88 4.106 2.2C15.828 18.14 14.015 19 12 19s-3.828-.86-5.106-2.228z"></path></svg>'}];var ev=n(628);class nv extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Eg(this)}connectedCallback(){return function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){const t=yield cg(void 0,void 0,void 0,(function*(){const t=[];return(yield sm(bp(hg,"Friends-playlist"))).forEach((e=>{t.push(e.data())})),t})),e=yield cg(void 0,void 0,void 0,(function*(){const t=[];return(yield sm(bp(hg,"Songs"))).forEach((e=>{t.push(e.data())})),t}));console.log(t,e),this.render(t,e)}))}render(t,e){var n,i,r,s;this.shadowRoot&&Cg.forEach((t=>{var e;const n=document.createElement("my-header");n.setAttribute(Sg.logo,t.logo),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)})),tv.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(Tg.iconohome,t.iconohome),n.setAttribute(Tg.iconoexplore,t.iconoexplore),n.setAttribute(Tg.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const o=this.ownerDocument.createElement("h1");o.textContent="On trending",null===(n=this.shadowRoot)||void 0===n||n.appendChild(o),e.forEach(((t,e)=>{var n;const i=document.createElement("my-songs");i.setAttribute(Bg.top,t.top),i.setAttribute(Bg.song_title,t.song_title),i.setAttribute(Bg.artist,t.artist),i.setAttribute(Bg.image,t.image),i.setAttribute("data-index",(e+1).toString()),null===(n=this.shadowRoot)||void 0===n||n.appendChild(i)}));const a=this.ownerDocument.createElement("h1");a.textContent="My friends playlist",null===(i=this.shadowRoot)||void 0===i||i.appendChild(a);const c=this.ownerDocument.createElement("section");c.classList.add("playlists"),t.forEach((t=>{const e=document.createElement("my-friend");console.log(t),e.setAttribute(Jg.name,t.name),e.setAttribute(Jg.profile,t.profile),e.setAttribute(Jg.photo,t.photo),e.setAttribute(Jg.song,t.song),c.appendChild(e)})),null===(r=this.shadowRoot)||void 0===r||r.appendChild(c);const l=this.ownerDocument.createElement("style");l.innerHTML=ev.A,null===(s=this.shadowRoot)||void 0===s||s.appendChild(l)}}customElements.define("app-explore",nv);var iv=n(835);const rv={email:"",username:"",completeName:"",password:""};var sv;!function(t){t.logo="logo",t.google="google",t.facebook="facebook",t.outlook="outlook"}(sv||(sv={}));class ov extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({logo:null,google:null,facebook:null,outlook:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}changeEmail(t){var e;rv.email=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value}changePassword(t){var e;rv.password=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value}changeUsername(t){var e;rv.username=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value}changeCompleteName(t){var e;rv.completeName=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value}submitForm(){var t;(async function(t,e,n){const i=Pe(t),r=Be(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",an),s=await r.catch((e=>{throw"auth/password-does-not-meet-requirements"===e.code&&fn(t),e})),o=await cn._fromIdTokenResponse(i,"signIn",s);return await i._updateCurrentUser(o.user),o})(ug,(t=rv).email,t.password).then((e=>cg(void 0,void 0,void 0,(function*(){const n=e.user;fg=n.uid,console.log(n.uid);try{const e=_p(hg,"users",n.uid),i={id:n.uid,username:t.username,completeName:t.completeName};console.log(i),yield function(t,e,n){t=pp(t,yp);const i=pp(t.firestore,Tp),r=Yp(t.converter,e,n);return cm(i,[Up(Mp(i),"setDoc",t._key,r,null!==t.converter,n).toMutation(t._key,Ph.none())])}(e,i),alert("Se creÃ³ el usuario")}catch(t){console.error(t)}})))).catch((t=>{const e=t.code,n=t.message;console.error(e,n)}))}render(){if(this.shadowRoot){const t=this.ownerDocument.createElement("section");t.classList.add("todo");const e=this.ownerDocument.createElementNS("http://www.w3.org/2000/svg","svg");e.classList.add("svg"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("height","35"),e.setAttribute("width","35"),e.setAttribute("viewBox","0 0 320 512"),e.innerHTML='\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec4b6" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/>',t.appendChild(e);const n=this.ownerDocument.createElement("img");n.classList.add("logo"),n.src=this.logo||"undefined",t.appendChild(n);const i=this.ownerDocument.createElement("section");i.classList.add("info");const r=this.ownerDocument.createElement("h1");r.classList.add("text_create"),r.textContent="Create your account",i.appendChild(r),t.appendChild(i),this.shadowRoot.appendChild(t);const s=this.ownerDocument.createElement("section");s.classList.add("inputs");const o=this.ownerDocument.createElement("input");o.placeholder="Correo electronico",o.addEventListener("change",this.changeEmail),s.appendChild(o);const a=this.ownerDocument.createElement("input");a.placeholder="Username",a.addEventListener("change",this.changeUsername),s.appendChild(a);const c=this.ownerDocument.createElement("input");c.placeholder="Name and Last name",c.addEventListener("change",this.changeCompleteName),s.appendChild(c);const l=this.ownerDocument.createElement("input");l.placeholder="ContraseÃ±a",l.addEventListener("change",this.changePassword),s.appendChild(l);const h=this.ownerDocument.createElement("button");h.innerText="Registrarme",h.addEventListener("click",this.submitForm),s.appendChild(h),this.shadowRoot.appendChild(s);const u=this.ownerDocument.createElement("section");u.classList.add("todo");const d=this.ownerDocument.createElement("p");d.classList.add("text"),d.textContent="Or sign up with",u.appendChild(d);const f=this.ownerDocument.createElement("section");f.id="apps";const p=this.ownerDocument.createElement("img");p.classList.add("google"),p.src=this.google||"undefined",f.appendChild(p);const m=this.ownerDocument.createElement("img");m.classList.add("facebook"),m.src=this.facebook||"undefined",f.appendChild(m);const g=this.ownerDocument.createElement("img");g.classList.add("outlook"),g.src=this.outlook||"undefined",f.appendChild(g),u.appendChild(f);const v=this.ownerDocument.createElement("section");v.classList.add("already_have");const y=this.ownerDocument.createElement("p");y.classList.add("text"),y.textContent="Already have an account?",v.appendChild(y);const w=this.ownerDocument.createElement("p");w.classList.add("signup_btn"),w.textContent="Log In",v.appendChild(w),u.appendChild(v),this.shadowRoot.appendChild(u),e.addEventListener("click",(()=>{_g(vg("PROFILE"))})),w.addEventListener("click",(()=>{_g(vg("LOGIN"))}));const b=this.ownerDocument.createElement("style");b.innerHTML=iv.A,this.shadowRoot.appendChild(b)}}}customElements.define("my-register",ov);const av=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg",google:"https://cdn1.iconfinder.com/data/icons/google-s-logo/150/Google_Icons-09-512.png",facebook:"https://upload.wikimedia.org/wikipedia/commons/6/6c/Facebook_Logo_2023.png",outlook:"https://seeklogo.com/images/M/microsoft-outlook-logo-188AB32C94-seeklogo.com.png"}];class cv extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Eg(this)}connectedCallback(){this.render()}render(){this.shadowRoot&&av.forEach((t=>{var e;const n=document.createElement("my-register");n.setAttribute(sv.logo,t.logo),n.setAttribute(sv.google,t.google),n.setAttribute(sv.facebook,t.facebook),n.setAttribute(sv.outlook,t.outlook),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}))}}customElements.define("app-register",cv);const lv={email:"",password:""};var hv;!function(t){t.logo="logo",t.google="google",t.facebook="facebook",t.outlook="outlook"}(hv||(hv={}));class uv extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({logo:null,google:null,facebook:null,outlook:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}changeEmail(t){var e;lv.email=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value}changePassword(t){var e;lv.password=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value}submitForm(){pg(lv)}render(){var t,e,n,i,r;this.shadowRoot&&(this.shadowRoot.innerHTML="");const s=document.createElement("section");s.className="todo";const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("class","svg"),o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("height","35"),o.setAttribute("width","35"),o.setAttribute("viewBox","0 0 320 512");const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("fill","#2ec4b6"),a.setAttribute("d","M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"),o.appendChild(a);const c=document.createElement("img");c.className="logo",c.src=this.logo||"undefined";const l=document.createElement("section");l.className="info";const h=document.createElement("h1");h.className="text_create",h.textContent="Log in to your account";const u=document.createElement("section");u.className="inputs";const d=document.createElement("form"),f=document.createElement("input");f.type="Email",f.addEventListener("change",this.changeEmail),f.placeholder="Email";const p=document.createElement("input");p.type="Password",p.addEventListener("change",this.changePassword),p.placeholder="Password",u.appendChild(d),d.appendChild(f),d.appendChild(p);const m=document.createElement("button");m.id="login",m.type="submit",m.addEventListener("click",this.submitForm),m.textContent="Log In",d.appendChild(m);const g=document.createElement("p");g.className="text",g.textContent="Or sign in with";const v=document.createElement("section");v.id="apps";const y=document.createElement("img");y.className="google",y.src=this.google||"undefined";const w=document.createElement("img");w.className="facebook",w.src=this.facebook||"undefined";const b=document.createElement("img");b.className="outlook",b.src=this.outlook||"undefined",v.appendChild(y),v.appendChild(w),v.appendChild(b);const _=document.createElement("section");_.className="already_have";const E=document.createElement("p");E.className="text",E.textContent="Don't have an account?";const T=document.createElement("p");T.className="signup_btn",T.textContent="Sign Up",_.appendChild(E),_.appendChild(T),l.appendChild(h),l.appendChild(u),s.appendChild(o),s.appendChild(c),s.appendChild(l),s.appendChild(g),s.appendChild(v),s.appendChild(_),null===(t=this.shadowRoot)||void 0===t||t.appendChild(s);const I=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".svg");null==I||I.addEventListener("click",(()=>{_g(vg("PROFILE"))}));const C=null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector(".signup_btn");null==C||C.addEventListener("click",(()=>{_g(vg("REGISTER"))}));const S=null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector("#login");null==S||S.addEventListener("click",(()=>{_g(vg("DASHBOARD"))}));const k=this.ownerDocument.createElement("style");k.innerHTML=iv.A,null===(r=this.shadowRoot)||void 0===r||r.appendChild(k)}}customElements.define("my-login",uv);class dv extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Eg(this)}connectedCallback(){this.render()}render(){this.shadowRoot&&av.forEach((t=>{var e;const n=document.createElement("my-login");n.setAttribute(hv.logo,t.logo),n.setAttribute(hv.google,t.google),n.setAttribute(hv.facebook,t.facebook),n.setAttribute(hv.outlook,t.outlook),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}))}}customElements.define("app-login",dv);class fv extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),Eg(this)}connectedCallback(){this.render()}render(){var t,e,n,i,r;switch(this.shadowRoot&&(this.shadowRoot.innerHTML=""),wg.screen){case"HOME":const s=this.ownerDocument.createElement("app-dashboard");null===(t=this.shadowRoot)||void 0===t||t.appendChild(s);break;case"EXPLORE":const o=this.ownerDocument.createElement("app-explore");null===(e=this.shadowRoot)||void 0===e||e.appendChild(o);break;case"PROFILE":const a=this.ownerDocument.createElement("app-perfil");null===(n=this.shadowRoot)||void 0===n||n.appendChild(a);break;case"REGISTER":const c=this.ownerDocument.createElement("app-register");null===(i=this.shadowRoot)||void 0===i||i.appendChild(c);break;case"LOGIN":const l=this.ownerDocument.createElement("app-login");null===(r=this.shadowRoot)||void 0===r||r.appendChild(l)}}}customElements.define("app-container",fv)})()})();