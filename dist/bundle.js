/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={471:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,".card {\n\tfont-family: 'inter';\n\tbackground-color: rgb(237, 237, 237);\n\twidth: 90%;\n\tpadding: 10px;\n\tborder-radius: 10px;\n\tmargin-left: 5%;\n\tmargin-top: 10px;\n\tmargin-bottom: 10px;\n\tdisplay: flex;\n\talign-items: center;\n\tcolor: rgb(30, 30, 30);\n}\n\n.top {\n\tmargin: 10px;\n\tmargin-right: 20px;\n\tfont-family: 'inter';\n\tfont-weight: 600;\n\tcolor: rgba(30, 30, 30, 0.7);\n}\n\n.artist {\n\tfont-size: 12px;\n\tmargin-top: 2px;\n}\n\n.title {\n\tfont-size: 15px;\n\tfont-weight: 600;\n\tmargin: 0;\n}\n\n.letters {\n\tmargin-left: 10px;\n}\n\nimg {\n\theight: 50px;\n\twidth: 50px;\n\tborder-radius: 5px;\n}\n\n.imagen {\n\tjustify-content: center;\n}\n\np {\n\tmargin-top: 0%;\n\tmargin-bottom: 0%;\n}\n",""]);const a=o},357:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,".image img {\n\twidth: 100%;\n\theight: 100%;\n\tobject-fit: cover;\n}\n\n#wave {\n\tmargin-left: 10px;\n\tmargin-top: 10px;\n}\n\n.image {\n\twidth: 30px;\n\theight: 30px;\n\tborder-radius: 50%;\n\toverflow: hidden;\n\tmargin: 10px;\n}\n\n.comment,\n.like_group,\n.share {\n\tmargin-left: 15px;\n\tmargin-right: 15px;\n}\n\n.cardEntera {\n\tbackground-color: rgb(255, 255, 255);\n\twidth: 70%;\n\theight: 15%;\n\tpadding: 10px;\n\tmargin-bottom: 10px;\n\tborder-radius: 10px;\n\tbox-shadow: 0 4px 8px rgba(0, 0, 0.3, 0.3);\n\tmargin-left: 15%;\n\tmargin-top: 2%;\n\tfont-family: 'inter';\n\tcolor: #1e1e1e;\n}\n\n.profile {\n\tdisplay: flex;\n\talign-items: center;\n}\n.interacciones {\n\tdisplay: flex;\n\tcolor: #2ec4b6;\n\talign-items: center;\n\tjustify-content: end;\n}\n.like_group,\n.share,\n.comment {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n#svg {\n\twidth: 26px;\n\theight: 26px;\n\tmargin: 3px;\n}\n\n#svg_like {\n\twidth: 26px;\n\theight: 26px;\n\tmargin: 3px;\n}\n\n.username {\n\tfont-weight: 700;\n}\n\np {\n\tmargin: 0;\n}\n",""]);const a=o},499:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,"p {\n\tfont-family: 'inter';\n\tfont-size: 14px;\n\tcolor: white;\n}\n.image img {\n\twidth: 30px;\n\theight: 30px; /* Ancho del contenedor */ /* Altura del contenedor */\n\toverflow: hidden; /* Oculta cualquier contenido que exceda los límites del contenedor */\n\tdisplay: block; /* Asegura que la imagen se comporte como un bloque */\n\tborder-radius: 50%; /* Hace que la imagen sea circular */\n\tmargin: 10px;\n}\n\n.image {\n\tdisplay: flex;\n}\n\n.song {\n\tfont-family: 'inter';\n\tfont-weight: 400;\n\tfont-size: 20px;\n\twidth: 280px;\n\talign-items: flex-start;\n\tcolor: white;\n\tmargin-left: 65px;\n\tmargin-top: 0;\n}\n\nh3 {\n\tmargin-top: 0;\n}\n.card {\n\twidth: 400px;\n\theight: 180px;\n\tborder-radius: 20px;\n\tmargin: 20px;\n}\n\n.todo {\n\tposition: relative;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.7);\n\tz-index: 1;\n\tborder-radius: 20px;\n}\n",""]);const a=o},507:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,".header {\n\tbackground-color: rgb(255, 255, 255);\n\theight: 10vh;\n\tbox-shadow: 0 4px 4px rgba(0, 0, 0, 0.1);\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n\n#perfil {\n\theight: 50px;\n\twidth: 50px;\n\tmargin-right: 2%;\n}\n\n.header img {\n\tmargin-left: 5%;\n}\n\n.logo img {\n\theight: 10vh;\n\tmargin-left: 20px;\n\tcursor: pointer;\n}\n\nsvg {\n\tmargin-right: 20px;\n\tcursor: pointer;\n}\n",""]);const a=o},67:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,".menubar {\n\tdisplay: flex;\n\tjustify-content: space-evenly;\n\tposition: fixed;\n\tbottom: 0;\n\talign-items: center;\n\twidth: 100%;\n\theight: 10vh;\n\tbackground-color: white;\n\tz-index: 2;\n\tbox-shadow: 0 -4px 4px rgba(0, 0, 0, 0.1);\n}\n\n#home,\n#chats,\n#profile {\n\theight: 30px;\n\twidth: 30px;\n\tcursor: pointer;\n}\n\n#explore {\n\theight: 24px;\n\twidth: 34px;\n\tcursor: pointer;\n}\n\n@media screen and (max-width: 768px) {\n\t.menubar {\n\t\tdisplay: flex;\n\t\tjustify-content: space-evenly;\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\talign-items: center;\n\t\twidth: 100%;\n\t\theight: 8vh;\n\t\tbackground-color: white;\n\t\tbox-shadow: 0 -4px 4px rgba(0, 0, 0, 0.1);\n\t}\n}\n",""]);const a=o},831:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,".profile {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tflex-direction: column;\n\tfont-family: 'inter';\n\tmargin-top: 30px;\n}\n\n#ButtonSong {\n\tbackground-color: transparent;\n\tborder: none;\n\tcursor: pointer;\n}\n\n#writtenSong {\n\tpadding: 4%;\n\tmargin-top: 2%;\n\tmargin-bottom: 6%;\n\twidth: 40%;\n\tborder-radius: 30px;\n}\n\n.waveSong {\n\tbackground-color: white;\n\tpadding: 20px;\n\tborder-radius: 40px;\n\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\twidth: 60%;\n\theight: 40%;\n\toverflow-y: auto;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tposition: relative;\n\tmargin: auto;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n}\n\n.modalContainer {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.5);\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-family: Arial;\n}\n\n.post {\n\tbackground-color: #2ec4b6;\n\tborder: none;\n\tborder-radius: 50px;\n\tcursor: pointer;\n\theight: 40px;\n\twidth: 120px;\n\ttransition: background-color 0.2s ease;\n\tcolor: white;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\nh2 {\n\tcolor: #ff9f1c;\n\tfont-size: 25px;\n}\n\n.close {\n\tmargin-left: 90%;\n\tmargin-top: 2%;\n\tright: 50px;\n\tcursor: pointer;\n\tfont-family: Arial;\n\tcolor: #2ec4b6;\n}\n\n.image {\n\theight: 200px;\n\tborder-radius: 100px;\n}\n\n.pin {\n\theight: 24px;\n\twidth: 24px;\n}\n\nh1 {\n\tfont-size: 24px;\n\tmargin-bottom: 0;\n\tfont-weight: 700;\n\tcolor: #1e1e1e;\n}\n\n.edit {\n\tbackground-color: transparent;\n\tborder-width: 0;\n\tcolor: #ff9f1c;\n\tcursor: pointer;\n\tfont-family: 'inter';\n\tfont-size: 16px;\n\tmargin-top: 0;\n\tfont-weight: 500;\n}\n\n.fav_song {\n\tdisplay: flex;\n\talign-items: center;\n\tfont-weight: 500;\n\tfont-size: 25px;\n\tcolor: rgb(46, 196, 182);\n\tcursor: pointer;\n}\n\n.name-following {\n\tdisplay: flex;\n\talign-items: center;\n\tflex-direction: row;\n\tjustify-content: center;\n\tfont-family: 'Inter';\n}\n\n.name {\n\tmargin: 5px;\n\tborder: 2px solid rgba(30, 30, 30, 0.2);\n\tborder-radius: 10px;\n\theight: 30px;\n\twidth: 193px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 16px;\n\tcolor: #1e1e1e;\n}\n\n.following {\n\tmargin: 5px;\n\tborder: 2px solid rgba(30, 30, 30, 0.2);\n\tborder-radius: 10px;\n\theight: 30px;\n\twidth: 193px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 16px;\n\tcolor: #1e1e1e;\n\tcursor: pointer;\n}\n\n.followers {\n\theight: 55px;\n\twidth: 400px;\n\tbackground-color: #2ec4b6;\n\tfont-weight: 500;\n\tcolor: white;\n\tborder-radius: 12px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 18px;\n\tmargin: 4px;\n\tbox-shadow: 2px 2px 7px rgba(0, 0, 0, 0.4);\n\tcursor: pointer;\n}\n\n.playlist {\n\theight: 35px;\n\twidth: 400px;\n\tbackground-color: #ff9f1c;\n\tfont-weight: 500;\n\tcolor: white;\n\tborder-radius: 10px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 15px;\n\tmargin: 4px;\n\tborder: none;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\tmargin-top: 8px;\n\tcursor: pointer;\n}\n\n.todo {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tfont-family: 'inter';\n}\n\n.playlist:hover {\n\tbackground-color: #ffbf69;\n}\n",""]);const a=o},835:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,"input {\n\twidth: 70vh;\n\tpadding: 10px;\n\tmargin: 2vh;\n\tborder: none;\n\tborder-radius: 12px;\n\tfont-size: 15px;\n\tcolor: rgba(30, 30, 30, 0.8);\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\theight: 4vh;\n}\n\n.info {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n}\n\nsvg {\n\tmargin-top: 40px;\n\theight: 35px;\n\twidth: 35px;\n\tcursor: pointer;\n\tposition: absolute;\n\tmargin-right: 90%;\n}\n\ninput:focus {\n\tborder-color: #2ec4b6;\n\toutline: none;\n}\n\n.logo {\n\twidth: 40vh;\n}\n\n.todo {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\talign-content: center;\n\tfont-family: 'inter';\n}\n\n.google {\n\twidth: 9vh;\n\tmargin-right: 100px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tcursor: pointer;\n}\n\n.facebook {\n\twidth: 6vh;\n\tmargin-right: 100px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tpadding: 8px;\n\tbackground-color: #fdfdfd;\n\tcursor: pointer;\n}\n\n.outlook {\n\twidth: 6vh;\n\tmargin: 10px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tpadding: 8px;\n\tbackground-color: #fdfdfd;\n\tcursor: pointer;\n}\n\n#apps {\n\tdisplay: flex;\n\talign-items: center;\n}\n\nbutton {\n\twidth: 73vh;\n\tpadding: 10px;\n\tmargin: 2vh;\n\tborder: none;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n\tcolor: white;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\theight: 6vh;\n\tbackground-color: #2ec4b6;\n\tcursor: pointer;\n\ttransition: 0.3s;\n}\n\nbutton:hover {\n\tbackground-color: #ffbf69;\n}\n\nform {\n\tdisplay: flex;\n\tjustify-content: center;\n\tflex-direction: column;\n}\n\n.text_create {\n\tcolor: rgba(30, 30, 30, 0.6);\n\tmargin-bottom: 25px;\n\tmargin-left: 12px;\n\tmargin-top: 0;\n\tfont-weight: 600;\n}\n\n.text {\n\tcolor: rgba(30, 30, 30, 0.6);\n\tmargin-top: 45px;\n\tmargin-bottom: 45px;\n\tmargin-right: 10px;\n\tfont-weight: 500;\n}\n\n.already_have {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.signup_btn {\n\tcursor: pointer;\n\tcolor: #ff9f1c;\n}\n\n@media screen and (max-width: 768px) {\n\tinput {\n\t\twidth: 50vh;\n\t\tpadding: 10px;\n\t\tmargin: 2vh;\n\t\tborder: none;\n\t\tborder-radius: 12px;\n\t\tfont-size: 15px;\n\t\tcolor: rgba(30, 30, 30, 0.8);\n\t\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\t\theight: 4vh;\n\t}\n}\n",""]);const a=o},9:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,"input {\n\twidth: 30%;\n\theight: 15%;\n\tpadding: 10px;\n\tmargin: 10px;\n\tborder: 2px solid #ccc;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n\tmargin-left: 15%;\n\tmargin-bottom: 30px;\n}\n\nbody {\n\tcolor: #ccc;\n}\n\nh1 {\n\tfont-family: 'inter';\n\tmargin-left: 15%;\n\tfont-size: 30px;\n\tpadding-top: 50px;\n\tcolor: #1e1e1e;\n\tmargin-top: 0;\n}\n\nh2 {\n\tfont-family: 'inter';\n\tmargin-left: 15%;\n\tfont-size: 30px;\n\tmargin-top: 10px;\n\tcolor: #969696;\n\tmargin-bottom: 20px;\n}\n\ninput:focus {\n\tborder-color: #ff9f1c;\n\toutline: none;\n}\n\nbutton {\n\tpadding: 10px 40px;\n\tfont-size: 16px;\n\tborder: none;\n\tborder-radius: 5px;\n\tbackground-color: #ff9f1c;\n\tcolor: white;\n\tcursor: pointer;\n\ttransition: 0.3s;\n\tmargin-top: 20px;\n\tmargin-bottom: 20px;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n}\n\nbutton:hover {\n\tbackground-color: #ffbf69;\n}\n\n.input-btn {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n",""]);const a=o},628:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,"h1 {\n\tfont-family: 'inter';\n\tmargin-left: 20px;\n\tfont-size: 30px;\n\tmargin-top: 60px;\n\tcolor: #1e1e1e;\n}\n\n.playlists {\n\tdisplay: flex;\n\toverflow-x: auto;\n\tmax-width: 100%;\n\tpadding-bottom: 20px;\n}\n\n.my-friend {\n\tflex: 0 0 auto;\n\tmargin-right: 20px;\n}\n",""]);const a=o},11:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),s=n.n(i),r=n(314),o=n.n(r)()(s());o.push([t.id,".h1Add {\n\tfont-size: 24px;\n\tmargin-bottom: 15px;\n\tcolor: #1e1e1e;\n\tfont-weight: 700;\n\tfont-family: 'Inter';\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tposition: relative;\n\tz-index: 2;\n\tmargin-top: 30px;\n}\n\n.artist,\n.title,\n.image {\n\twidth: 20%;\n\tpadding: 10px;\n\tmargin: 4px;\n\tborder: 2px solid #ccc;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n\tposition: relative;\n\tz-index: 2;\n}\n\n.create-song {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.artist:focus,\n.title:focus,\n.image:focus {\n\tborder-color: #ff9f1c;\n\toutline: none;\n}\n\n.save {\n\tpadding: 10px 65px;\n\tfont-size: 16px;\n\tborder: none;\n\tborder-radius: 5px;\n\tbackground-color: #ff9f1c;\n\tcolor: white;\n\tcursor: pointer;\n\ttransition: 0.3s;\n\tmargin-left: 45%;\n\tmargin-top: 20px;\n\tmargin-bottom: 20px;\n}\n.save:hover {\n\tbackground-color: #ffbf69;\n}\n",""]);const a=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,s,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);i&&o[h[0]]||(void 0!==r&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=r),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),s&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=s):h[4]="".concat(s)),e.push(h))}},e}},601:t=>{t.exports=function(t){return t[1]}}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={id:i,exports:{}};return t[i](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{const t=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#ff9f1c" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'"https://i.pinimg.com/originals/94/67/f5/9467f504e83345d60816f9b87ac84588.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="27" height="27" viewBox="0 0 24 24" style="fill: rgb(32, 32, 32);transform: ;msFilter:;"><path d="M12 2C6.579 2 2 6.579 2 12s4.579 10 10 10 10-4.579 10-10S17.421 2 12 2zm0 5c1.727 0 3 1.272 3 3s-1.273 3-3 3c-1.726 0-3-1.272-3-3s1.274-3 3-3zm-5.106 9.772c.897-1.32 2.393-2.2 4.106-2.2h2c1.714 0 3.209.88 4.106 2.2C15.828 18.14 14.015 19 12 19s-3.828-.86-5.106-2.228z"></path></svg>'}];var e,i=n(67);!function(t){t.STORE="STORE"}(e||(e={}));let s=(({key:t,defaultValue:e})=>{const n=localStorage.getItem(t)||sessionStorage.getItem(t);return n?JSON.parse(n):e})({key:e.STORE,defaultValue:{screen:"REGISTER"}}),r=[];const o=t=>{const n=((t,e)=>{const{action:n,payload:i}=t;return"navigate"===n&&(e.screen=i),e})(t,JSON.parse(JSON.stringify(s)));var i;s=n,i=n,(({key:t,value:e,session:n=!1})=>{const i=n?sessionStorage:localStorage,s=JSON.stringify(e);i.setItem(t,s)})({key:e.STORE,value:i,session:!1}),r.forEach((t=>t.render()))},a=t=>{r=[...r,t]},c=t=>({action:"navigate",payload:t});var l;!function(t){t.uid="uid",t.iconohome="iconohome",t.iconoexplore="iconoexplore",t.iconoprofile="iconoprofile"}(l||(l={}));class h extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,iconohome:null,iconoexplore:null,iconoprofile:null})}attributeChangedCallback(t,e,n){t===l.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t,e,n,s;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t<section class="menubar">\n\t\t<svg id="home">${this.iconohome}</svg>\n\t\t<img id="explore" src=${this.iconoexplore}></svg>\n\t\t<svg id="profile">${this.iconoprofile}</svg>\n\t\t\t</section>`);const r=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#home");null==r||r.addEventListener("click",(()=>{o(c("HOME"))}));const a=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#explore");null==a||a.addEventListener("click",(()=>{o(c("EXPLORE"))}));const l=null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector("#profile");null==l||l.addEventListener("click",(()=>{o(c("PROFILE"))}));const h=this.ownerDocument.createElement("style");h.innerHTML=i.A,null===(s=this.shadowRoot)||void 0===s||s.appendChild(h)}}customElements.define("my-iconos",h);const u=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg"}];var d,f=n(507);!function(t){t.uid="uid",t.logo="logo"}(d||(d={}));class p extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,logo:null})}attributeChangedCallback(t,e,n){t===d.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t,e;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n    <section class="header">\n\t\t<section class="logo">\n    <img src='${this.logo}'></img>\n\t\t</section>\n    </section>`);const n=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".logo");null==n||n.addEventListener("click",(()=>{o(c("HOME"))}));const i=this.ownerDocument.createElement("style");i.innerHTML=f.A,null===(e=this.shadowRoot)||void 0===e||e.appendChild(i)}}customElements.define("my-header",p);const g=[{id:1,name:"Susana García",wave:"",image:"https://images.pexels.com/photos/3646160/pexels-photo-3646160.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",unlike:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"/></svg>',like:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6bc" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>',cantidadlike:"6,4k",share:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>',cantidadshare:"49k",comentar:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4l0 0 0 0 0 0 0 0 .3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"/></svg>',cantidadcomentar:"6,9k"}];var m,v=n(357);!function(t){t.unlike="unlike",t.like="like",t.cantidadlike="cantidadlike",t.share="share",t.cantidadshare="cantidadshare",t.comentar="comentar",t.cantidadcomentar="cantidadcomentar",t.profileuid="profileuid",t.name="name",t.image="image",t.wave="wave"}(m||(m={}));class y extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({unlike:null,like:null,cantidadlike:null,share:null,cantidadshare:null,comentar:null,cantidadcomentar:null,profileuid:null,name:null,image:null,wave:null})}attributeChangedCallback(t,e,n){t===m.profileuid?this.profileuid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render(),this.attachEventHandlers()}attachEventHandlers(){var t,e;const n=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".like"),i=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".unlike");n&&i&&(n.addEventListener("click",(()=>{n.style.display="none",i.style.display="block",localStorage.setItem("likeState","block")})),i.addEventListener("click",(()=>{n.style.display="block",i.style.display="none",localStorage.setItem("likeState","none")})),"none"===localStorage.getItem("likeState")&&(n.style.display="none",i.style.display="block"))}render(){var t;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t<section class= "cardEntera">\n\t\t\t<section class= profile>\n\t\t\t<section class="image">\n\t\t\t<img src="${this.image}"></img>\n\t\t\t</section>\n\t\t\t<p class="username">${this.name||"No Username"}</p>\n\t\t\t</section>\n\n\t\t\t<section class='wave'>\n\t\t\t<p id='wave'>${this.wave}</p>\n\t\t\t</section>\n\n\t\t\t<section class="interacciones">\n\t\t\t<section class="like_group">\n\t\t\t<svg id="svg" class="unlike">${this.unlike}</svg>\n\t\t\t<svg id="svg_like" class="like" style="display: none;">${this.like}</svg>\n\t\t\t<p>${this.cantidadlike}</p>\n\t\t\t</section>\n\n\t\t\t<sections class='share'>\n\t\t\t<svg id="svg">${this.share}</svg>\n\t\t\t<p>${this.cantidadshare}</p>\n\t\t\t</sections>\n\n\t\t\t<section class='comment'>\n\t\t\t<svg id="svg">${this.comentar}</svg>\n\t\t\t<p>${this.cantidadcomentar}</p>\n\t\t\t</section>\n\t\t\t</section>\n\t\t\t</section>`);const e=this.ownerDocument.createElement("style");e.innerHTML=v.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}}customElements.define("my-card",y);const w=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},b={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=s>>2,h=(3&s)<<4|o>>4;let u=(15&o)<<2|c>>6,d=63&c;a||(d=64,r||(u=64)),i.push(n[l],n[h],n[u],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(w(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],r=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==r||null==o||null==a)throw new _;const c=s<<2|r>>4;if(i.push(c),64!==o){const t=r<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class _ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const E=function(t){return function(t){const e=w(t);return b.encodeByteArray(e,!0)}(t).replace(/\./g,"")},T=function(t){try{return b.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},I=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&T(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},S=t=>{var e,n;return null===(n=null===(e=I())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},C=()=>{var t;return null===(t=I())||void 0===t?void 0:t.config},k=t=>{var e;return null===(e=I())||void 0===e?void 0:e[`_${t}`]};class A{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function x(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function R(){try{return"object"==typeof indexedDB}catch(t){return!1}}class D extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,D.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,N.prototype.create)}}class N{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(L,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new D(i,o,n)}}const L=/\{\$([^}]+)}/g;function O(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(P(n)&&P(r)){if(!O(n,r))return!1}else if(n!==r)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function P(t){return null!==t&&"object"==typeof t}function M(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function F(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function U(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class V{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=j),void 0===i.error&&(i.error=j),void 0===i.complete&&(i.complete=j);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function j(){}function B(t){return t&&t._delegate?t._delegate:t}class z{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const q="[DEFAULT]";class ${constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new A;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:q})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=q){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=q){return this.instances.has(t)}getOptions(t=q){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===q?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=q){return this.component?this.component.multipleInstances?t:q:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class H{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new $(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const K=[];var G;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(G||(G={}));const W={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},Q=G.INFO,J={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},X=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=J[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class Y{constructor(t){this.name=t,this._logLevel=Q,this._logHandler=X,this._userLogHandler=null,K.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in G))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?W[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...t),this._logHandler(this,G.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...t),this._logHandler(this,G.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,G.INFO,...t),this._logHandler(this,G.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,G.WARN,...t),this._logHandler(this,G.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...t),this._logHandler(this,G.ERROR,...t)}}const Z=(t,e)=>e.some((e=>t instanceof e));let tt,et;const nt=new WeakMap,it=new WeakMap,st=new WeakMap,rt=new WeakMap,ot=new WeakMap;let at={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return it.get(t);if("objectStoreNames"===e)return t.objectStoreNames||st.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return lt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function ct(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(et||(et=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ht(this),t),lt(nt.get(this))}:function(...t){return lt(e.apply(ht(this),t))}:function(t,...n){const i=e.call(ht(this),t,...n);return st.set(i,t.sort?t.sort():[t]),lt(i)}:(t instanceof IDBTransaction&&function(t){if(it.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));it.set(t,e)}(t),Z(t,tt||(tt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,at):t);var e}function lt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(lt(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&nt.set(e,t)})).catch((()=>{})),ot.set(e,t),e}(t);if(rt.has(t))return rt.get(t);const e=ct(t);return e!==t&&(rt.set(t,e),ot.set(e,t)),e}const ht=t=>ot.get(t),ut=["get","getKey","getAll","getAllKeys","count"],dt=["put","add","delete","clear"],ft=new Map;function pt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(ft.get(e))return ft.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=dt.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!ut.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return ft.set(e,r),r}var gt;gt=at,at={...gt,get:(t,e,n)=>pt(t,e)||gt.get(t,e,n),has:(t,e)=>!!pt(t,e)||gt.has(t,e)};class mt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const vt="@firebase/app",yt="0.9.26",wt=new Y("@firebase/app"),bt="[DEFAULT]",_t={[vt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Et=new Map,Tt=new Map;function It(t,e){try{t.container.addComponent(e)}catch(n){wt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function St(t){const e=t.name;if(Tt.has(e))return wt.debug(`There were multiple attempts to register component ${e}.`),!1;Tt.set(e,t);for(const e of Et.values())It(e,t);return!0}function Ct(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const kt=new N("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class At{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new z("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw kt.create("app-deleted",{appName:this._name})}}const xt="10.7.2";function Rt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:bt,automaticDataCollectionEnabled:!1},e),s=i.name;if("string"!=typeof s||!s)throw kt.create("bad-app-name",{appName:String(s)});if(n||(n=C()),!n)throw kt.create("no-options");const r=Et.get(s);if(r){if(O(n,r.options)&&O(i,r.config))return r;throw kt.create("duplicate-app",{appName:s})}const o=new H(s);for(const t of Tt.values())o.addComponent(t);const a=new At(n,i,o);return Et.set(s,a),a}function Dt(t=bt){const e=Et.get(t);if(!e&&t===bt&&C())return Rt();if(!e)throw kt.create("no-app",{appName:t});return e}function Nt(t,e,n){var i;let s=null!==(i=_t[t])&&void 0!==i?i:t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const t=[`Unable to register library "${s}" with version "${e}":`];return r&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void wt.warn(t.join(" "))}St(new z(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}const Lt="firebase-heartbeat-database",Ot=1,Pt="firebase-heartbeat-store";let Mt=null;function Ft(){return Mt||(Mt=function(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=lt(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(lt(o.result),t.oldVersion,t.newVersion,lt(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(t=>s(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(Lt,Ot,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Pt)}catch(t){console.warn(t)}}}).catch((t=>{throw kt.create("idb-open",{originalErrorMessage:t.message})}))),Mt}async function Ut(t,e){try{const n=(await Ft()).transaction(Pt,"readwrite"),i=n.objectStore(Pt);await i.put(e,Vt(t)),await n.done}catch(t){if(t instanceof D)wt.warn(t.message);else{const e=kt.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});wt.warn(e.message)}}}function Vt(t){return`${t.name}!${t.options.appId}`}class jt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new zt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Bt();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Bt(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),qt(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),qt(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),s=E(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Bt(){return(new Date).toISOString().substring(0,10)}class zt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!R()&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=await Ft();return await e.transaction(Pt).objectStore(Pt).get(Vt(t))}catch(t){if(t instanceof D)wt.warn(t.message);else{const e=kt.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});wt.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ut(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ut(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function qt(t){return E(JSON.stringify({version:2,heartbeats:t})).length}St(new z("platform-logger",(t=>new mt(t)),"PRIVATE")),St(new z("heartbeat",(t=>new jt(t)),"PRIVATE")),Nt(vt,yt,""),Nt(vt,yt,"esm2017"),Nt("fire-js",""),Nt("firebase","10.7.2","app");var $t,Ht="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Kt={},Gt=Gt||{},Wt=Ht||self;function Qt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Jt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Xt="closure_uid_"+(1e9*Math.random()>>>0),Yt=0;function Zt(t,e,n){return t.call.apply(t.bind,arguments)}function te(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ee(t,e,n){return(ee=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Zt:te).apply(null,arguments)}function ne(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ie(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[n].apply(t,s)}}function se(){this.s=this.s,this.o=this.o}se.prototype.s=!1,se.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Xt)&&t[Xt]||(t[Xt]=++Yt))},se.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const re=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function oe(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function ae(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Qt(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let s=0;s<i;s++)t[e+s]=n[s]}else t.push(n)}}function ce(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var le=function(){if(!Wt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};Wt.addEventListener("test",t,e),Wt.removeEventListener("test",t,e)}catch(t){}return t}();function he(t){return/^[\s\xa0]*$/.test(t)}function ue(){var t=Wt.navigator;return t&&(t=t.userAgent)?t:""}function de(t){return-1!=ue().indexOf(t)}function fe(t){return fe[" "](t),t}fe[" "]=function(){};var pe,ge,me,ve=de("Opera"),ye=de("Trident")||de("MSIE"),we=de("Edge"),be=we||ye,_e=de("Gecko")&&!(-1!=ue().toLowerCase().indexOf("webkit")&&!de("Edge"))&&!(de("Trident")||de("MSIE"))&&!de("Edge"),Ee=-1!=ue().toLowerCase().indexOf("webkit")&&!de("Edge");function Te(){var t=Wt.document;return t?t.documentMode:void 0}t:{var Ie="",Se=(ge=ue(),_e?/rv:([^\);]+)(\)|;)/.exec(ge):we?/Edge\/([\d\.]+)/.exec(ge):ye?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ge):Ee?/WebKit\/(\S+)/.exec(ge):ve?/(?:Version)[ \/]?(\S+)/.exec(ge):void 0);if(Se&&(Ie=Se?Se[1]:""),ye){var Ce=Te();if(null!=Ce&&Ce>parseFloat(Ie)){pe=String(Ce);break t}}pe=Ie}Wt.document&&ye?me=Te()||parseInt(pe,10)||void 0:me=void 0;var ke=me;function Ae(t,e){if(ce.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(_e){t:{try{fe(e.nodeName);var s=!0;break t}catch(t){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:xe[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ae.$.h.call(this)}}ie(Ae,ce);var xe={2:"touch",3:"pen",4:"mouse"};Ae.prototype.h=function(){Ae.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Re="closure_listenable_"+(1e6*Math.random()|0),De=0;function Ne(t,e,n,i,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=s,this.key=++De,this.fa=this.ia=!1}function Le(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Oe(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function Pe(t){const e={};for(const n in t)e[n]=t[n];return e}const Me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Fe(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<Me.length;e++)n=Me[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Ue(t){this.src=t,this.g={},this.h=0}function Ve(t,e){var n=e.type;if(n in t.g){var i,s=t.g[n],r=re(s,e);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(Le(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function je(t,e,n,i){for(var s=0;s<t.length;++s){var r=t[s];if(!r.fa&&r.listener==e&&r.capture==!!n&&r.la==i)return s}return-1}Ue.prototype.add=function(t,e,n,i,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=je(t,e,i,s);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Ne(e,this.src,r,!!i,s)).ia=n,t.push(e)),e};var Be="closure_lm_"+(1e6*Math.random()|0),ze={};function qe(t,e,n,i,s){if(i&&i.once)return He(t,e,n,i,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)qe(t,e[r],n,i,s);return null}return n=Ye(n),t&&t[Re]?t.O(e,n,Jt(i)?!!i.capture:!!i,s):$e(t,e,n,!1,i,s)}function $e(t,e,n,i,s,r){if(!e)throw Error("Invalid event type");var o=Jt(s)?!!s.capture:!!s,a=Je(t);if(a||(t[Be]=a=new Ue(t)),(n=a.add(e,n,i,o,r)).proxy)return n;if(i=function(){const t=Qe;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)le||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),i,s);else if(t.attachEvent)t.attachEvent(We(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function He(t,e,n,i,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)He(t,e[r],n,i,s);return null}return n=Ye(n),t&&t[Re]?t.P(e,n,Jt(i)?!!i.capture:!!i,s):$e(t,e,n,!0,i,s)}function Ke(t,e,n,i,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)Ke(t,e[r],n,i,s);else i=Jt(i)?!!i.capture:!!i,n=Ye(n),t&&t[Re]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=je(r=t.g[e],n,i,s))&&(Le(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--))):t&&(t=Je(t))&&(e=t.g[e.toString()],t=-1,e&&(t=je(e,n,i,s)),(n=-1<t?e[t]:null)&&Ge(n))}function Ge(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[Re])Ve(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(We(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Je(e))?(Ve(n,t),0==n.h&&(n.src=null,e[Be]=null)):Le(t)}}}function We(t){return t in ze?ze[t]:ze[t]="on"+t}function Qe(t,e){if(t.fa)t=!0;else{e=new Ae(e,this);var n=t.listener,i=t.la||t.src;t.ia&&Ge(t),t=n.call(i,e)}return t}function Je(t){return(t=t[Be])instanceof Ue?t:null}var Xe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ye(t){return"function"==typeof t?t:(t[Xe]||(t[Xe]=function(e){return t.handleEvent(e)}),t[Xe])}function Ze(){se.call(this),this.i=new Ue(this),this.S=this,this.J=null}function tn(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new ce(e,t);else if(e instanceof ce)e.target=e.target||t;else{var s=e;Fe(e=new ce(i,t),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];s=en(o,i,!0,e)&&s}if(s=en(o=e.g=t,i,!0,e)&&s,s=en(o,i,!1,e)&&s,n)for(r=0;r<n.length;r++)s=en(o=e.g=n[r],i,!1,e)&&s}function en(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Ve(t.i,o),s=!1!==a.call(c,i)&&s}}return s&&!i.defaultPrevented}ie(Ze,se),Ze.prototype[Re]=!0,Ze.prototype.removeEventListener=function(t,e,n,i){Ke(this,t,e,n,i)},Ze.prototype.N=function(){if(Ze.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)Le(n[i]);delete e.g[t],e.h--}}this.J=null},Ze.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Ze.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var nn=Wt.JSON.stringify;function sn(){var t=un;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var rn=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new on),(t=>t.reset()));class on{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function an(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function cn(t){Wt.setTimeout((()=>{throw t}),0)}let ln,hn=!1,un=new class{constructor(){this.h=this.g=null}add(t,e){const n=rn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},dn=()=>{const t=Wt.Promise.resolve(void 0);ln=()=>{t.then(fn)}};var fn=()=>{for(var t;t=sn();){try{t.h.call(t.g)}catch(t){cn(t)}var e=rn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}hn=!1};function pn(t,e){Ze.call(this),this.h=t||1,this.g=e||Wt,this.j=ee(this.qb,this),this.l=Date.now()}function gn(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function mn(t,e,n){if("function"==typeof t)n&&(t=ee(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ee(t.handleEvent,t)}return 2147483647<Number(e)?-1:Wt.setTimeout(t,e||0)}function vn(t){t.g=mn((()=>{t.g=null,t.i&&(t.i=!1,vn(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}ie(pn,Ze),($t=pn.prototype).ga=!1,$t.T=null,$t.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),tn(this,"tick"),this.ga&&(gn(this),this.start()))}},$t.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},$t.N=function(){pn.$.N.call(this),gn(this),delete this.g};class yn extends se{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:vn(this)}N(){super.N(),this.g&&(Wt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function wn(t){se.call(this),this.h=t,this.g={}}ie(wn,se);var bn=[];function _n(t,e,n,i){Array.isArray(n)||(n&&(bn[0]=n.toString()),n=bn);for(var s=0;s<n.length;s++){var r=qe(e,n[s],i||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function En(t){Oe(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ge(t)}),t),t.g={}}function Tn(){this.g=!0}function In(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return nn(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}wn.prototype.N=function(){wn.$.N.call(this),En(this)},wn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Tn.prototype.Ea=function(){this.g=!1},Tn.prototype.info=function(){};var Sn={},Cn=null;function kn(){return Cn=Cn||new Ze}function An(t){ce.call(this,Sn.Ta,t)}function xn(t){const e=kn();tn(e,new An(e))}function Rn(t,e){ce.call(this,Sn.STAT_EVENT,t),this.stat=e}function Dn(t){const e=kn();tn(e,new Rn(e,t))}function Nn(t,e){ce.call(this,Sn.Ua,t),this.size=e}function Ln(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Wt.setTimeout((function(){t()}),e)}Sn.Ta="serverreachability",ie(An,ce),Sn.STAT_EVENT="statevent",ie(Rn,ce),Sn.Ua="timingevent",ie(Nn,ce);var On={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Pn={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Mn(){}function Fn(t){return t.h||(t.h=t.i())}function Un(){}Mn.prototype.h=null;var Vn,jn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Bn(){ce.call(this,"d")}function zn(){ce.call(this,"c")}function qn(){}function $n(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new wn(this),this.P=Kn,t=be?125:void 0,this.V=new pn(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Hn}function Hn(){this.i=null,this.g="",this.h=!1}ie(Bn,ce),ie(zn,ce),ie(qn,Mn),qn.prototype.g=function(){return new XMLHttpRequest},qn.prototype.i=function(){return{}},Vn=new qn;var Kn=45e3,Gn={},Wn={};function Qn(t,e,n){t.L=1,t.A=pi(li(e)),t.u=n,t.S=!0,Jn(t,null)}function Jn(t,e){t.G=Date.now(),ti(t),t.B=li(t.A);var n=t.B,i=t.W;Array.isArray(i)||(i=[String(i)]),ki(n.i,"t",i),t.o=0,n=t.l.J,t.h=new Hn,t.g=ks(t.l,n?e:null,!t.u),0<t.O&&(t.M=new yn(ee(t.Pa,t,t.g),t.O)),_n(t.U,t.g,"readystatechange",t.nb),e=t.I?Pe(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),xn(),function(t,e,n,i,s,r){t.info((function(){if(t.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var h=l[0];l=l[1];var u=h.split("_");o=2<=u.length&&"type"==u[1]?o+(h+"=")+l+"&":o+(h+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function Xn(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Yn(t,e,n){let i,s=!0;for(;!t.J&&t.o<n.length;){if(i=Zn(t,n),i==Wn){4==e&&(t.s=4,Dn(14),s=!1),In(t.j,t.m,null,"[Incomplete Response]");break}if(i==Gn){t.s=4,Dn(15),In(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}In(t.j,t.m,i,null),ri(t,i)}Xn(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,Dn(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),ws(e),e.M=!0,Dn(11))):(In(t.j,t.m,n,"[Invalid Chunked Response]"),si(t),ii(t))}function Zn(t,e){var n=t.o,i=e.indexOf("\n",n);return-1==i?Wn:(n=Number(e.substring(n,i)),isNaN(n)?Gn:(i+=1)+n>e.length?Wn:(e=e.slice(i,i+n),t.o=i+n,e))}function ti(t){t.Y=Date.now()+t.P,ei(t,t.P)}function ei(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=Ln(ee(t.lb,t),e)}function ni(t){t.C&&(Wt.clearTimeout(t.C),t.C=null)}function ii(t){0==t.l.H||t.J||Es(t.l,t)}function si(t){ni(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,gn(t.V),En(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function ri(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Oi(n.i,t)))if(!t.K&&Oi(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;_s(n),us(n)}ys(n),Dn(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&0==n.A&&!n.v&&(n.v=Ln(ee(n.ib,n),6e3));if(1>=Li(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else Is(n,11)}else if((t.K||n.g==t)&&_s(n),!he(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const e=l[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const s=l[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));const h=l[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=i.i;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(Pi(r,r.h),r.h=null))}if(i.F){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,fi(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((i=n).wa=Cs(i,i.J?i.pa:null,i.Y),o.K){Mi(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.C&&(ni(a),ti(a)),i.g=o}else vs(i);0<n.j.length&&fs(n)}else"stop"!=l[0]&&"close"!=l[0]||Is(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Is(n,7):hs(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}xn()}catch(t){}}function oi(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Qt(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Qt(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Qt(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),s=i.length,r=0;r<s;r++)e.call(void 0,i[r],n&&n[r],t)}($t=$n.prototype).setTimeout=function(t){this.P=t},$t.nb=function(t){t=t.target;const e=this.M;e&&3==ss(t)?e.l():this.Pa(t)},$t.Pa=function(t){try{if(t==this.g)t:{const h=ss(this.g);var e=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||be||this.g&&(this.h.h||this.g.ja()||rs(this.g)))){this.J||4!=h||7==e||xn(),ni(this);var n=this.g.da();this.ca=n;e:if(Xn(this)){var i=rs(this.g);t="";var s=i.length,r=4==ss(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){si(this),ii(this);var o="";break e}this.h.i=new Wt.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:r&&e==s-1});i.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,i,s,r,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+r+" "+o}))}(this.j,this.v,this.B,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!he(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.s=3,Dn(12),si(this),ii(this);break t}In(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ri(this,n)}this.S?(Yn(this,h,o),be&&this.i&&3==h&&(_n(this.U,this.V,"tick",this.mb),this.V.start())):(In(this.j,this.m,o,null),ri(this,o)),4==h&&si(this),this.i&&!this.J&&(4==h?Es(this.l,this):(this.i=!1,ti(this)))}else(function(t){const e={};t=(t.g&&2<=ss(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(he(t[i]))continue;var n=an(t[i]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const r=e[s]||[];e[s]=r,r.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Dn(12)):(this.s=0,Dn(13)),si(this),ii(this)}}}catch(t){}},$t.mb=function(){if(this.g){var t=ss(this.g),e=this.g.ja();this.o<e.length&&(ni(this),Yn(this,t,e),this.i&&4!=t&&ti(this))}},$t.cancel=function(){this.J=!0,si(this)},$t.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(xn(),Dn(17)),si(this),this.s=2,ii(this)):ei(this,this.Y-t)};var ai=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ci(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof ci){this.h=t.h,hi(this,t.j),this.s=t.s,this.g=t.g,ui(this,t.m),this.l=t.l;var e=t.i,n=new Ti;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),di(this,n),this.o=t.o}else t&&(e=String(t).match(ai))?(this.h=!1,hi(this,e[1]||"",!0),this.s=gi(e[2]||""),this.g=gi(e[3]||"",!0),ui(this,e[4]),this.l=gi(e[5]||"",!0),di(this,e[6]||"",!0),this.o=gi(e[7]||"")):(this.h=!1,this.i=new Ti(null,this.h))}function li(t){return new ci(t)}function hi(t,e,n){t.j=n?gi(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ui(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function di(t,e,n){e instanceof Ti?(t.i=e,function(t,e){e&&!t.j&&(Ii(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Si(this,e),ki(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=mi(e,_i)),t.i=new Ti(e,t.h))}function fi(t,e,n){t.i.set(e,n)}function pi(t){return fi(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function gi(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function mi(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,vi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function vi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ci.prototype.toString=function(){var t=[],e=this.j;e&&t.push(mi(e,yi,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(mi(e,yi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(mi(n,"/"==n.charAt(0)?bi:wi,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",mi(n,Ei)),t.join("")};var yi=/[#\/\?@]/g,wi=/[#\?:]/g,bi=/[#\?]/g,_i=/[#\?@]/g,Ei=/#/g;function Ti(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ii(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var r=t[n].substring(0,i);s=t[n].substring(i+1)}else r=t[n];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Si(t,e){Ii(t),e=Ai(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ci(t,e){return Ii(t),e=Ai(t,e),t.g.has(e)}function ki(t,e,n){Si(t,e),0<n.length&&(t.i=null,t.g.set(Ai(t,e),oe(n)),t.h+=n.length)}function Ai(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}($t=Ti.prototype).add=function(t,e){Ii(this),this.i=null,t=Ai(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},$t.forEach=function(t,e){Ii(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},$t.ta=function(){Ii(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const s=t[i];for(let t=0;t<s.length;t++)n.push(e[i])}return n},$t.Z=function(t){Ii(this);let e=[];if("string"==typeof t)Ci(this,t)&&(e=e.concat(this.g.get(Ai(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},$t.set=function(t,e){return Ii(this),this.i=null,Ci(this,t=Ai(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},$t.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},$t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const r=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var s=r;""!==o[i]&&(s+="="+encodeURIComponent(String(o[i]))),t.push(s)}}return this.i=t.join("&")};var xi=class{constructor(t,e){this.g=t,this.map=e}};function Ri(t){this.l=t||Di,t=Wt.PerformanceNavigationTiming?0<(t=Wt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Wt.g&&Wt.g.Ka&&Wt.g.Ka()&&Wt.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Di=10;function Ni(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Li(t){return t.h?1:t.g?t.g.size:0}function Oi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Pi(t,e){t.g?t.g.add(e):t.h=e}function Mi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Fi(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return oe(t.i)}Ri.prototype.cancel=function(){if(this.i=Fi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Ui=class{stringify(t){return Wt.JSON.stringify(t,void 0)}parse(t){return Wt.JSON.parse(t,void 0)}};function Vi(){this.g=new Ui}function ji(t,e,n){const i=n||"";try{oi(t,(function(t,n){let s=t;Jt(t)&&(s=nn(t)),e.push(i+n+"="+encodeURIComponent(s))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Bi(t,e,n,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch(t){}}function zi(t){this.l=t.ec||null,this.j=t.ob||!1}function qi(t,e){Ze.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=$i,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ie(zi,Mn),zi.prototype.g=function(){return new qi(this.l,this.j)},zi.prototype.i=function(t){return function(){return t}}({}),ie(qi,Ze);var $i=0;function Hi(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function Ki(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Gi(t)}function Gi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}($t=qi.prototype).open=function(t,e){if(this.readyState!=$i)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Gi(this)},$t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Wt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},$t.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ki(this)),this.readyState=$i},$t.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Gi(this)),this.g&&(this.readyState=3,Gi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Wt.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Hi(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},$t.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ki(this):Gi(this),3==this.readyState&&Hi(this)}},$t.Za=function(t){this.g&&(this.response=this.responseText=t,Ki(this))},$t.Ya=function(t){this.g&&(this.response=t,Ki(this))},$t.ka=function(){this.g&&Ki(this)},$t.setRequestHeader=function(t,e){this.v.append(t,e)},$t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},$t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(qi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Wi=Wt.JSON.parse;function Qi(t){Ze.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Ji,this.L=this.M=!1}ie(Qi,Ze);var Ji="",Xi=/^https?$/i,Yi=["POST","PUT"];function Zi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,ts(t),ns(t)}function ts(t){t.F||(t.F=!0,tn(t,"complete"),tn(t,"error"))}function es(t){if(t.h&&void 0!==Gt&&(!t.C[1]||4!=ss(t)||2!=t.da()))if(t.v&&4==ss(t))mn(t.La,0,t);else if(tn(t,"readystatechange"),4==ss(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var s=String(t.I).match(ai)[1]||null;!s&&Wt.self&&Wt.self.location&&(s=Wt.self.location.protocol.slice(0,-1)),i=!Xi.test(s?s.toLowerCase():"")}n=i}if(n)tn(t,"complete"),tn(t,"success");else{t.m=6;try{var r=2<ss(t)?t.g.statusText:""}catch(t){r=""}t.j=r+" ["+t.da()+"]",ts(t)}}finally{ns(t)}}}function ns(t,e){if(t.g){is(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||tn(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function is(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Wt.clearTimeout(t.A),t.A=null)}function ss(t){return t.g?t.g.readyState:0}function rs(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Ji:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function os(t){let e="";return Oe(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function as(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=os(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):fi(t,e,n))}function cs(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ls(t){this.Ga=0,this.j=[],this.l=new Tn,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=cs("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=cs("baseRetryDelayMs",5e3,t),this.hb=cs("retryDelaySeedMs",1e4,t),this.eb=cs("forwardChannelMaxRetries",2,t),this.xa=cs("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Ri(t&&t.concurrentRequestLimit),this.Ja=new Vi,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function hs(t){if(ds(t),3==t.H){var e=t.W++,n=li(t.I);if(fi(n,"SID",t.K),fi(n,"RID",e),fi(n,"TYPE","terminate"),gs(t,n),(e=new $n(t,t.l,e)).L=2,e.A=pi(li(n)),n=!1,Wt.navigator&&Wt.navigator.sendBeacon)try{n=Wt.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&Wt.Image&&((new Image).src=e.A,n=!0),n||(e.g=ks(e.l,null),e.g.ha(e.A)),e.G=Date.now(),ti(e)}Ss(t)}function us(t){t.g&&(ws(t),t.g.cancel(),t.g=null)}function ds(t){us(t),t.u&&(Wt.clearTimeout(t.u),t.u=null),_s(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Wt.clearTimeout(t.m),t.m=null)}function fs(t){if(!Ni(t.i)&&!t.m){t.m=!0;var e=t.Na;ln||dn(),hn||(ln(),hn=!0),un.add(e,t),t.C=0}}function ps(t,e){var n;n=e?e.m:t.W++;const i=li(t.I);fi(i,"SID",t.K),fi(i,"RID",n),fi(i,"AID",t.V),gs(t,i),t.o&&t.s&&as(i,t.o,t.s),n=new $n(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=ms(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Pi(t.i,n),Qn(n,i,e)}function gs(t,e){t.na&&Oe(t.na,(function(t,n){fi(e,n,t)})),t.h&&oi({},(function(t,n){fi(e,n,t)}))}function ms(t,e,n){n=Math.min(t.j.length,n);var i=t.h?ee(t.h.Va,t.h,t):null;t:{var s=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let r=!0;for(let o=0;o<n;o++){let n=s[o].g;const a=s[o].map;if(n-=e,0>n)e=Math.max(0,s[o].g-100),r=!1;else try{ji(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(r){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function vs(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;ln||dn(),hn||(ln(),hn=!0),un.add(e,t),t.A=0}}function ys(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Ln(ee(t.Ma,t),Ts(t,t.A)),t.A++,0))}function ws(t){null!=t.B&&(Wt.clearTimeout(t.B),t.B=null)}function bs(t){t.g=new $n(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=li(t.wa);fi(e,"RID","rpc"),fi(e,"SID",t.K),fi(e,"AID",t.V),fi(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&fi(e,"TO",t.qa),fi(e,"TYPE","xmlhttp"),gs(t,e),t.o&&t.s&&as(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=pi(li(e)),n.u=null,n.S=!0,Jn(n,t)}function _s(t){null!=t.v&&(Wt.clearTimeout(t.v),t.v=null)}function Es(t,e){var n=null;if(t.g==e){_s(t),ws(t),t.g=null;var i=2}else{if(!Oi(t.i,e))return;n=e.F,Mi(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.u?e.u.length:0,e=Date.now()-e.G;var s=t.C;tn(i=kn(),new Nn(i,n)),fs(t)}else vs(t);else if(3==(s=e.s)||0==s&&0<e.ca||!(1==i&&function(t,e){return!(Li(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Ln(ee(t.Na,t,e),Ts(t,t.C)),t.C++,0)))}(t,e)||2==i&&ys(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Is(t,5);break;case 4:Is(t,10);break;case 3:Is(t,6);break;default:Is(t,2)}}function Ts(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Is(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=ee(t.pb,t);n||(n=new ci("//www.google.com/images/cleardot.gif"),Wt.location&&"http"==Wt.location.protocol||hi(n,"https"),pi(n)),function(t,e){const n=new Tn;if(Wt.Image){const i=new Image;i.onload=ne(Bi,n,i,"TestLoadImage: loaded",!0,e),i.onerror=ne(Bi,n,i,"TestLoadImage: error",!1,e),i.onabort=ne(Bi,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=ne(Bi,n,i,"TestLoadImage: timeout",!1,e),Wt.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else Dn(2);t.H=0,t.h&&t.h.za(e),Ss(t),ds(t)}function Ss(t){if(t.H=0,t.ma=[],t.h){const e=Fi(t.i);0==e.length&&0==t.j.length||(ae(t.ma,e),ae(t.ma,t.j),t.i.i.length=0,oe(t.j),t.j.length=0),t.h.ya()}}function Cs(t,e,n){var i=n instanceof ci?li(n):new ci(n);if(""!=i.g)e&&(i.g=e+"."+i.g),ui(i,i.m);else{var s=Wt.location;i=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var r=new ci(null);i&&hi(r,i),e&&(r.g=e),s&&ui(r,s),n&&(r.l=n),i=r}return n=t.F,e=t.Da,n&&e&&fi(i,n,e),fi(i,"VER",t.ra),gs(t,i),i}function ks(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Qi(new zi({ob:n})):new Qi(t.va)).Oa(t.J),e}function As(){}function xs(){if(ye&&!(10<=Number(ke)))throw Error("Environmental error: no available transport.")}function Rs(t,e){Ze.call(this),this.g=new ls(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!he(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!he(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Ls(this)}function Ds(t){Bn.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Ns(){zn.call(this),this.status=1}function Ls(t){this.g=t}function Os(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Ps(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var s=0;16>s;++s)i[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)i[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var r=t.g[3],o=e+(r^n&(s^r))+i[0]+3614090360&4294967295;o=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=(n=(s=(r=(e=n+(o<<7&4294967295|o>>>25))+((o=r+(s^e&(n^s))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(r^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(s^r))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^e&(n^s))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(r^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(s^r))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^e&(n^s))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(r^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(s^r))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=r+(s^e&(n^s))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=s+(n^r&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^s&(r^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^r&(n^s))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(r^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(s^r))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^r&(n^s))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(r^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(s^r))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^r&(n^s))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(r^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(s^r))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(s^r&(n^s))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^s&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=s+(e^n&(r^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(s^r))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^s^r)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^s)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^r)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^s)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^r)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^s)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^s^r)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^s)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=s+(r^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(s^r^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(s^(n|~r))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~s))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(r|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(s^(n|~r))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~s))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(r|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(s^(n|~r))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~s))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=s+(e^(r|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(s|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((r=(e=n+((o=e+(s^(n|~r))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~s))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((s=r+((o=s+(e^(r|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+r&4294967295}function Ms(t,e){this.h=e;for(var n=[],i=!0,s=t.length-1;0<=s;s--){var r=0|t[s];i&&r==e||(n[s]=r,i=!1)}this.g=n}($t=Qi.prototype).Oa=function(t){this.M=t},$t.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Vn.g(),this.C=this.u?Fn(this.u):Fn(Vn),this.g.onreadystatechange=ee(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Zi(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),s=Wt.FormData&&t instanceof Wt.FormData,!(0<=re(Yi,e))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{is(this),0<this.B&&((this.L=function(t){return ye&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ee(this.ua,this)):this.A=mn(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Zi(this,t)}},$t.ua=function(){void 0!==Gt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,tn(this,"timeout"),this.abort(8))},$t.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,tn(this,"complete"),tn(this,"abort"),ns(this))},$t.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ns(this,!0)),Qi.$.N.call(this)},$t.La=function(){this.s||(this.G||this.v||this.l?es(this):this.kb())},$t.kb=function(){es(this)},$t.isActive=function(){return!!this.g},$t.da=function(){try{return 2<ss(this)?this.g.status:-1}catch(t){return-1}},$t.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},$t.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Wi(e)}},$t.Ia=function(){return this.m},$t.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},($t=ls.prototype).ra=8,$t.H=1,$t.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new $n(this,this.l,t);let r=this.s;if(this.U&&(r?(r=Pe(r),Fe(r,this.U)):r=this.U),null!==this.o||this.O||(s.I=r,r=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=ms(this,s,e),fi(n=li(this.I),"RID",t),fi(n,"CVER",22),this.F&&fi(n,"X-HTTP-Session-Id",this.F),gs(this,n),r&&(this.O?e="headers="+encodeURIComponent(String(os(r)))+"&"+e:this.o&&as(n,this.o,r)),Pi(this.i,s),this.bb&&fi(n,"TYPE","init"),this.P?(fi(n,"$req",e),fi(n,"SID","null"),s.aa=!0,Qn(s,n,null)):Qn(s,n,e),this.H=2}}else 3==this.H&&(t?ps(this,t):0==this.j.length||Ni(this.i)||ps(this))},$t.Ma=function(){if(this.u=null,bs(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Ln(ee(this.jb,this),t)}},$t.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Dn(10),us(this),bs(this))},$t.ib=function(){null!=this.v&&(this.v=null,us(this),ys(this),Dn(19))},$t.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Dn(2)):(this.l.info("Failed to ping google.com"),Dn(1))},$t.isActive=function(){return!!this.h&&this.h.isActive(this)},($t=As.prototype).Ba=function(){},$t.Aa=function(){},$t.za=function(){},$t.ya=function(){},$t.isActive=function(){return!0},$t.Va=function(){},xs.prototype.g=function(t,e){return new Rs(t,e)},ie(Rs,Ze),Rs.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Dn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Cs(t,null,t.Y),fs(t)},Rs.prototype.close=function(){hs(this.g)},Rs.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=nn(t),t=n);e.j.push(new xi(e.fb++,t)),3==e.H&&fs(e)},Rs.prototype.N=function(){this.g.h=null,delete this.j,hs(this.g),delete this.g,Rs.$.N.call(this)},ie(Ds,Bn),ie(Ns,zn),ie(Ls,As),Ls.prototype.Ba=function(){tn(this.g,"a")},Ls.prototype.Aa=function(t){tn(this.g,new Ds(t))},Ls.prototype.za=function(t){tn(this.g,new Ns)},Ls.prototype.ya=function(){tn(this.g,"b")},ie(Os,(function(){this.blockSize=-1})),Os.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Os.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,s=this.h,r=0;r<e;){if(0==s)for(;r<=n;)Ps(this,t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[s++]=t.charCodeAt(r++),s==this.blockSize){Ps(this,i),s=0;break}}else for(;r<e;)if(i[s++]=t[r++],s==this.blockSize){Ps(this,i),s=0;break}}this.h=s,this.i+=e},Os.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var Fs={};function Us(t){return-128<=t&&128>t?function(t,e){var n=Fs;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new Ms([0|t],0>t?-1:0)}(t)}(t):new Ms([0|t],0>t?-1:0)}function Vs(t){if(isNaN(t)||!isFinite(t))return Bs;if(0>t)return Ks(Vs(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=js;return new Ms(e,0)}var js=4294967296,Bs=Us(0),zs=Us(1),qs=Us(16777216);function $s(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function Hs(t){return-1==t.h}function Ks(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new Ms(n,~t.h).add(zs)}function Gs(t,e){return t.add(Ks(e))}function Ws(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Qs(t,e){this.g=t,this.h=e}function Js(t,e){if($s(e))throw Error("division by zero");if($s(t))return new Qs(Bs,Bs);if(Hs(t))return e=Js(Ks(t),e),new Qs(Ks(e.g),Ks(e.h));if(Hs(e))return e=Js(t,Ks(e)),new Qs(Ks(e.g),e.h);if(30<t.g.length){if(Hs(t)||Hs(e))throw Error("slowDivide_ only works with positive integers.");for(var n=zs,i=e;0>=i.X(t);)n=Xs(n),i=Xs(i);var s=Ys(n,1),r=Ys(i,1);for(i=Ys(i,2),n=Ys(n,2);!$s(i);){var o=r.add(i);0>=o.X(t)&&(s=s.add(n),r=o),i=Ys(i,1),n=Ys(n,1)}return e=Gs(t,s.R(e)),new Qs(s,e)}for(s=Bs;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(r=Vs(n)).R(e);Hs(o)||0<o.X(t);)o=(r=Vs(n-=i)).R(e);$s(r)&&(r=zs),s=s.add(r),t=Gs(t,o)}return new Qs(s,t)}function Xs(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new Ms(n,t.h)}function Ys(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,s=[],r=0;r<i;r++)s[r]=0<e?t.D(r+n)>>>e|t.D(r+n+1)<<32-e:t.D(r+n);return new Ms(s,t.h)}($t=Ms.prototype).ea=function(){if(Hs(this))return-Ks(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:js+i)*e,e*=js}return t},$t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if($s(this))return"0";if(Hs(this))return"-"+Ks(this).toString(t);for(var e=Vs(Math.pow(t,6)),n=this,i="";;){var s=Js(n,e).g,r=((0<(n=Gs(n,s.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if($s(n=s))return r+i;for(;6>r.length;)r="0"+r;i=r+i}},$t.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},$t.X=function(t){return Hs(t=Gs(this,t))?-1:$s(t)?0:1},$t.abs=function(){return Hs(this)?Ks(this):this},$t.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,s=0;s<=e;s++){var r=i+(65535&this.D(s))+(65535&t.D(s)),o=(r>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);i=o>>>16,r&=65535,o&=65535,n[s]=o<<16|r}return new Ms(n,-2147483648&n[n.length-1]?-1:0)},$t.R=function(t){if($s(this)||$s(t))return Bs;if(Hs(this))return Hs(t)?Ks(this).R(Ks(t)):Ks(Ks(this).R(t));if(Hs(t))return Ks(this.R(Ks(t)));if(0>this.X(qs)&&0>t.X(qs))return Vs(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<t.g.length;s++){var r=this.D(i)>>>16,o=65535&this.D(i),a=t.D(s)>>>16,c=65535&t.D(s);n[2*i+2*s]+=o*c,Ws(n,2*i+2*s),n[2*i+2*s+1]+=r*c,Ws(n,2*i+2*s+1),n[2*i+2*s+1]+=o*a,Ws(n,2*i+2*s+1),n[2*i+2*s+2]+=r*a,Ws(n,2*i+2*s+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new Ms(n,0)},$t.gb=function(t){return Js(this,t).h},$t.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new Ms(n,this.h&t.h)},$t.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new Ms(n,this.h|t.h)},$t.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new Ms(n,this.h^t.h)},xs.prototype.createWebChannel=xs.prototype.g,Rs.prototype.send=Rs.prototype.u,Rs.prototype.open=Rs.prototype.m,Rs.prototype.close=Rs.prototype.close,On.NO_ERROR=0,On.TIMEOUT=8,On.HTTP_ERROR=6,Pn.COMPLETE="complete",Un.EventType=jn,jn.OPEN="a",jn.CLOSE="b",jn.ERROR="c",jn.MESSAGE="d",Ze.prototype.listen=Ze.prototype.O,Qi.prototype.listenOnce=Qi.prototype.P,Qi.prototype.getLastError=Qi.prototype.Sa,Qi.prototype.getLastErrorCode=Qi.prototype.Ia,Qi.prototype.getStatus=Qi.prototype.da,Qi.prototype.getResponseJson=Qi.prototype.Wa,Qi.prototype.getResponseText=Qi.prototype.ja,Qi.prototype.send=Qi.prototype.ha,Qi.prototype.setWithCredentials=Qi.prototype.Oa,Os.prototype.digest=Os.prototype.l,Os.prototype.reset=Os.prototype.reset,Os.prototype.update=Os.prototype.j,Ms.prototype.add=Ms.prototype.add,Ms.prototype.multiply=Ms.prototype.R,Ms.prototype.modulo=Ms.prototype.gb,Ms.prototype.compare=Ms.prototype.X,Ms.prototype.toNumber=Ms.prototype.ea,Ms.prototype.toString=Ms.prototype.toString,Ms.prototype.getBits=Ms.prototype.D,Ms.fromNumber=Vs,Ms.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return Ks(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Vs(Math.pow(n,8)),s=Bs,r=0;r<e.length;r+=8){var o=Math.min(8,e.length-r),a=parseInt(e.substring(r,r+o),n);8>o?(o=Vs(Math.pow(n,o)),s=s.R(o).add(Vs(a))):s=(s=s.R(i)).add(Vs(a))}return s};var Zs=Kt.createWebChannelTransport=function(){return new xs},tr=Kt.getStatEventTarget=function(){return kn()},er=Kt.ErrorCode=On,nr=Kt.EventType=Pn,ir=Kt.Event=Sn,sr=Kt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},rr=(Kt.FetchXmlHttpFactory=zi,Kt.WebChannel=Un),or=Kt.XhrIo=Qi,ar=Kt.Md5=Os,cr=Kt.Integer=Ms;const lr="@firebase/firestore";class hr{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}hr.UNAUTHENTICATED=new hr(null),hr.GOOGLE_CREDENTIALS=new hr("google-credentials-uid"),hr.FIRST_PARTY=new hr("first-party-uid"),hr.MOCK_USER=new hr("mock-user");let ur="10.7.2";const dr=new Y("@firebase/firestore");function fr(){return dr.logLevel}function pr(t,...e){if(dr.logLevel<=G.DEBUG){const n=e.map(vr);dr.debug(`Firestore (${ur}): ${t}`,...n)}}function gr(t,...e){if(dr.logLevel<=G.ERROR){const n=e.map(vr);dr.error(`Firestore (${ur}): ${t}`,...n)}}function mr(t,...e){if(dr.logLevel<=G.WARN){const n=e.map(vr);dr.warn(`Firestore (${ur}): ${t}`,...n)}}function vr(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function yr(t="Unexpected state"){const e=`FIRESTORE (${ur}) INTERNAL ASSERTION FAILED: `+t;throw gr(e),new Error(e)}function wr(t,e){t||yr()}function br(t,e){return t}const _r={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Er extends D{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Tr{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Ir{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Sr{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(hr.UNAUTHENTICATED)))}shutdown(){}}class Cr{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class kr{constructor(t){this.t=t,this.currentUser=hr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new Tr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Tr,t.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const e=s;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{pr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(pr("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Tr)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(pr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(wr("string"==typeof e.accessToken),new Ir(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return wr(null===t||"string"==typeof t),new hr(t)}}class Ar{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=hr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class xr{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new Ar(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(hr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Rr{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Dr{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&pr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,pr("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{pr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):pr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(wr("string"==typeof t.token),this.R=t.token,new Rr(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Nr(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Lr{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=Nr(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function Or(t,e){return t<e?-1:t>e?1:0}function Pr(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class Mr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Er(_r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Er(_r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Er(_r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Er(_r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Mr.fromMillis(Date.now())}static fromDate(t){return Mr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Mr(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Or(this.nanoseconds,t.nanoseconds):Or(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Fr{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Fr(t)}static min(){return new Fr(new Mr(0,0))}static max(){return new Fr(new Mr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ur{constructor(t,e,n){void 0===e?e=0:e>t.length&&yr(),void 0===n?n=t.length-e:n>t.length-e&&yr(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Ur.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Ur?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),s=e.get(i);if(n<s)return-1;if(n>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Vr extends Ur{construct(t,e,n){return new Vr(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Er(_r.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Vr(e)}static emptyPath(){return new Vr([])}}const jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Br extends Ur{construct(t,e,n){return new Br(t,e,n)}static isValidIdentifier(t){return jr.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Br.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Br(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Er(_r.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let r=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Er(_r.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Er(_r.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(r=!r,i++):"."!==e||r?(n+=e,i++):(s(),i++)}if(s(),r)throw new Er(_r.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Br(e)}static emptyPath(){return new Br([])}}class zr{constructor(t){this.path=t}static fromPath(t){return new zr(Vr.fromString(t))}static fromName(t){return new zr(Vr.fromString(t).popFirst(5))}static empty(){return new zr(Vr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Vr.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Vr.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new zr(new Vr(t.slice()))}}function qr(t){return new $r(t.readTime,t.key,-1)}class $r{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new $r(Fr.min(),zr.empty(),-1)}static max(){return new $r(Fr.max(),zr.empty(),-1)}}function Hr(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=zr.comparator(t.documentKey,e.documentKey),0!==n?n:Or(t.largestBatchId,e.largestBatchId))}const Kr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Gr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Wr(t){if(t.code!==_r.FAILED_PRECONDITION||t.message!==Kr)throw t;pr("LocalStore","Unexpectedly lost primary lease")}class Qr{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&yr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Qr(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Qr?e:Qr.resolve(e)}catch(t){return Qr.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Qr.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Qr.reject(e)}static resolve(t){return new Qr(((e,n)=>{e(t)}))}static reject(t){return new Qr(((e,n)=>{n(t)}))}static waitFor(t){return new Qr(((e,n)=>{let i=0,s=0,r=!1;t.forEach((t=>{++i,t.next((()=>{++s,r&&s===i&&e()}),(t=>n(t)))})),r=!0,s===i&&e()}))}static or(t){let e=Qr.resolve(!1);for(const n of t)e=e.next((t=>t?Qr.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Qr(((n,i)=>{const s=t.length,r=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;e(t[c]).next((t=>{r[c]=t,++o,o===s&&n(r)}),(t=>i(t)))}}))}static doWhile(t,e){return new Qr(((n,i)=>{const s=()=>{!0===t()?e().next((()=>{s()}),i):n()};s()}))}}class Jr{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new Tr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Zr(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=so(e.target.error);this.V.reject(new Zr(t,n))}}static open(t,e,n,i){try{return new Jr(e,t.transaction(i,n))}catch(t){throw new Zr(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(pr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new eo(e)}}class Xr{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===Xr.S(x())&&gr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return pr("SimpleDb","Removing database:",t),no(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!R())return!1;if(Xr.C())return!0;const t=x(),e=Xr.S(t),n=0<e&&e<10,i=Xr.v(t),s=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||s)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(pr("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=t=>{const n=t.target.result;e(n)},i.onblocked=()=>{n(new Zr(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=e=>{const i=e.target.error;"VersionError"===i.name?n(new Er(_r.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new Er(_r.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new Zr(t,i))},i.onupgradeneeded=t=>{pr("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,i.transaction,t.oldVersion,this.version).next((()=>{pr("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,i){const s="readonly"===e;let r=0;for(;;){++r;try{this.db=await this.O(t);const e=Jr.open(this.db,t,s?"readonly":"readwrite",n),r=i(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),Qr.reject(t)))).toPromise();return r.catch((()=>{})),await e.m,r}catch(t){const e=t,n="FirebaseError"!==e.name&&r<3;if(pr("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Yr{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return no(this.k.delete())}}class Zr extends Er{constructor(t,e){super(_r.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function to(t){return"IndexedDbTransactionError"===t.name}class eo{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(pr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(pr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),no(n)}add(t){return pr("SimpleDb","ADD",this.store.name,t,t),no(this.store.add(t))}get(t){return no(this.store.get(t)).next((e=>(void 0===e&&(e=null),pr("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return pr("SimpleDb","DELETE",this.store.name,t),no(this.store.delete(t))}count(){return pr("SimpleDb","COUNT",this.store.name),no(this.store.count())}W(t,e){const n=this.options(t,e),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const t=i.getAll(n.range);return new Qr(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new Qr(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){pr("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const i=this.cursor(n);return this.G(i,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const i=this.cursor(n);return this.G(i,e)}Z(t){const e=this.cursor({});return new Qr(((n,i)=>{e.onerror=t=>{const e=so(t.target.error);i(e)},e.onsuccess=e=>{const i=e.target.result;i?t(i.primaryKey,i.value).next((t=>{t?i.continue():n()})):n()}}))}G(t,e){const n=[];return new Qr(((i,s)=>{t.onerror=t=>{s(t.target.error)},t.onsuccess=t=>{const s=t.target.result;if(!s)return void i();const r=new Yr(s),o=e(s.primaryKey,s.value,r);if(o instanceof Qr){const t=o.catch((t=>(r.done(),Qr.reject(t))));n.push(t)}r.isDone?i():null===r.$?s.continue():s.continue(r.$)}})).next((()=>Qr.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function no(t){return new Qr(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=so(t.target.error);n(e)}}))}let io=!1;function so(t){const e=Xr.S(x());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new Er("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return io||(io=!0,setTimeout((()=>{throw t}),0)),t}}return t}class ro{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function oo(t){return null==t}function ao(t){return 0===t&&1/t==-1/0}ro._e=-1;function co(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ho(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class uo{constructor(t,e){this.comparator=t,this.root=e||po.EMPTY}insert(t,e){return new uo(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,po.BLACK,null,null))}remove(t){return new uo(this.comparator,this.root.remove(t,this.comparator).copy(null,null,po.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new fo(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new fo(this.root,t,this.comparator,!1)}getReverseIterator(){return new fo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new fo(this.root,t,this.comparator,!0)}}class fo{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class po{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:po.RED,this.left=null!=i?i:po.EMPTY,this.right=null!=s?s:po.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,s){return new po(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return po.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return po.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,po.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,po.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw yr();if(this.right.isRed())throw yr();const t=this.left.check();if(t!==this.right.check())throw yr();return t+(this.isRed()?0:1)}}po.EMPTY=null,po.RED=!0,po.BLACK=!1,po.EMPTY=new class{constructor(){this.size=0}get key(){throw yr()}get value(){throw yr()}get color(){throw yr()}get left(){throw yr()}get right(){throw yr()}copy(t,e,n,i,s){return this}insert(t,e,n){return new po(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class go{constructor(t){this.comparator=t,this.data=new uo(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new mo(this.data.getIterator())}getIteratorFrom(t){return new mo(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof go))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new go(this.comparator);return e.data=t,e}}class mo{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class vo{constructor(t){this.fields=t,t.sort(Br.comparator)}static empty(){return new vo([])}unionWith(t){let e=new go(Br.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new vo(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Pr(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class yo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class wo{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new yo("Invalid base64 string: "+t):t}}(t);return new wo(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new wo(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Or(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}wo.EMPTY_BYTE_STRING=new wo("");const bo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(t){if(wr(!!t),"string"==typeof t){let e=0;const n=bo.exec(t);if(wr(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Eo(t.seconds),nanos:Eo(t.nanos)}}function Eo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?wo.fromBase64String(t):wo.fromUint8Array(t)}function Io(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function So(t){const e=t.mapValue.fields.__previous_value__;return Io(e)?So(e):e}function Co(t){const e=_o(t.mapValue.fields.__local_write_time__.timestampValue);return new Mr(e.seconds,e.nanos)}class ko{constructor(t,e,n,i,s,r,o,a,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class Ao{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Ao("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Ao&&t.projectId===this.projectId&&t.database===this.database}}const xo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ro(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Io(t)?4:qo(t)?9007199254740991:10:yr()}function Do(t,e){if(t===e)return!0;const n=Ro(t);if(n!==Ro(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Co(t).isEqual(Co(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=_o(t.timestampValue),i=_o(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return To(t.bytesValue).isEqual(To(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Eo(t.geoPointValue.latitude)===Eo(e.geoPointValue.latitude)&&Eo(t.geoPointValue.longitude)===Eo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Eo(t.integerValue)===Eo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Eo(t.doubleValue),i=Eo(e.doubleValue);return n===i?ao(n)===ao(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Pr(t.arrayValue.values||[],e.arrayValue.values||[],Do);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(co(n)!==co(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Do(n[t],i[t])))return!1;return!0}(t,e);default:return yr()}}function No(t,e){return void 0!==(t.values||[]).find((t=>Do(t,e)))}function Lo(t,e){if(t===e)return 0;const n=Ro(t),i=Ro(e);if(n!==i)return Or(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Or(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Eo(t.integerValue||t.doubleValue),i=Eo(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Oo(t.timestampValue,e.timestampValue);case 4:return Oo(Co(t),Co(e));case 5:return Or(t.stringValue,e.stringValue);case 6:return function(t,e){const n=To(t),i=To(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=Or(n[t],i[t]);if(0!==e)return e}return Or(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Or(Eo(t.latitude),Eo(e.latitude));return 0!==n?n:Or(Eo(t.longitude),Eo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Lo(n[t],i[t]);if(e)return e}return Or(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===xo.mapValue&&e===xo.mapValue)return 0;if(t===xo.mapValue)return 1;if(e===xo.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),s=e.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let t=0;t<i.length&&t<r.length;++t){const e=Or(i[t],r[t]);if(0!==e)return e;const o=Lo(n[i[t]],s[r[t]]);if(0!==o)return o}return Or(i.length,r.length)}(t.mapValue,e.mapValue);default:throw yr()}}function Oo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Or(t,e);const n=_o(t),i=_o(e),s=Or(n.seconds,i.seconds);return 0!==s?s:Or(n.nanos,i.nanos)}function Po(t){return Mo(t)}function Mo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=_o(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return To(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return zr.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Mo(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const s of e)i?i=!1:n+=",",n+=`${s}:${Mo(t.fields[s])}`;return n+"}"}(t.mapValue):yr()}function Fo(t){return!!t&&"integerValue"in t}function Uo(t){return!!t&&"arrayValue"in t}function Vo(t){return!!t&&"nullValue"in t}function jo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bo(t){return!!t&&"mapValue"in t}function zo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return lo(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=zo(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=zo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function qo(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class $o{constructor(t){this.value=t}static empty(){return new $o({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Bo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=zo(e)}setAll(t){let e=Br.emptyPath(),n={},i=[];t.forEach(((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=s.popLast()}t?n[s.lastSegment()]=zo(t):i.push(s.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,n,i)}delete(t){const e=this.field(t.popLast());Bo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Do(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Bo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){lo(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new $o(zo(this.value))}}function Ho(t){const e=[];return lo(t.fields,((t,n)=>{const i=new Br([t]);if(Bo(n)){const t=Ho(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new vo(e)}class Ko{constructor(t,e,n,i,s,r,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=s,this.data=r,this.documentState=o}static newInvalidDocument(t){return new Ko(t,0,Fr.min(),Fr.min(),Fr.min(),$o.empty(),0)}static newFoundDocument(t,e,n,i){return new Ko(t,1,e,Fr.min(),n,i,0)}static newNoDocument(t,e){return new Ko(t,2,e,Fr.min(),Fr.min(),$o.empty(),0)}static newUnknownDocument(t,e){return new Ko(t,3,e,Fr.min(),Fr.min(),$o.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Fr.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=$o.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=$o.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fr.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ko&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ko(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Go{constructor(t,e){this.position=t,this.inclusive=e}}function Wo(t,e,n){let i=0;for(let s=0;s<t.position.length;s++){const r=e[s],o=t.position[s];if(i=r.field.isKeyField()?zr.comparator(zr.fromName(o.referenceValue),n.key):Lo(o,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function Qo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Do(t.position[n],e.position[n]))return!1;return!0}class Jo{constructor(t,e="asc"){this.field=t,this.dir=e}}function Xo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Yo{}class Zo extends Yo{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new oa(t,e,n):"array-contains"===e?new ha(t,n):"in"===e?new ua(t,n):"not-in"===e?new da(t,n):"array-contains-any"===e?new fa(t,n):new Zo(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new aa(t,n):new ca(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Lo(e,this.value)):null!==e&&Ro(this.value)===Ro(e)&&this.matchesComparison(Lo(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return yr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ta extends Yo{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new ta(t,e)}matches(t){return ea(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function ea(t){return"and"===t.op}function na(t){return function(t){for(const e of t.filters)if(e instanceof ta)return!1;return!0}(t)&&ea(t)}function ia(t){if(t instanceof Zo)return t.field.canonicalString()+t.op.toString()+Po(t.value);if(na(t))return t.filters.map((t=>ia(t))).join(",");{const e=t.filters.map((t=>ia(t))).join(",");return`${t.op}(${e})`}}function sa(t,e){return t instanceof Zo?function(t,e){return e instanceof Zo&&t.op===e.op&&t.field.isEqual(e.field)&&Do(t.value,e.value)}(t,e):t instanceof ta?function(t,e){return e instanceof ta&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&sa(n,e.filters[i])),!0)}(t,e):void yr()}function ra(t){return t instanceof Zo?function(t){return`${t.field.canonicalString()} ${t.op} ${Po(t.value)}`}(t):t instanceof ta?function(t){return t.op.toString()+" {"+t.getFilters().map(ra).join(" ,")+"}"}(t):"Filter"}class oa extends Zo{constructor(t,e,n){super(t,e,n),this.key=zr.fromName(n.referenceValue)}matches(t){const e=zr.comparator(t.key,this.key);return this.matchesComparison(e)}}class aa extends Zo{constructor(t,e){super(t,"in",e),this.keys=la(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class ca extends Zo{constructor(t,e){super(t,"not-in",e),this.keys=la(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function la(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>zr.fromName(t.referenceValue)))}class ha extends Zo{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Uo(e)&&No(e.arrayValue,this.value)}}class ua extends Zo{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&No(this.value.arrayValue,e)}}class da extends Zo{constructor(t,e){super(t,"not-in",e)}matches(t){if(No(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!No(this.value.arrayValue,e)}}class fa extends Zo{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Uo(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>No(this.value.arrayValue,t)))}}class pa{constructor(t,e=null,n=[],i=[],s=null,r=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=o,this.ce=null}}function ga(t,e=null,n=[],i=[],s=null,r=null,o=null){return new pa(t,e,n,i,s,r,o)}function ma(t){const e=br(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>ia(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),oo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Po(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Po(t))).join(",")),e.ce=t}return e.ce}function va(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Xo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!sa(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qo(t.startAt,e.startAt)&&Qo(t.endAt,e.endAt)}function ya(t){return zr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class wa{constructor(t,e=null,n=[],i=[],s=null,r="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function ba(t){return new wa(t)}function _a(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Ea(t){const e=br(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new go(Br.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new Jo(i,n))})),t.has(Br.keyField().canonicalString())||e.le.push(new Jo(Br.keyField(),n))}return e.le}function Ta(t){const e=br(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return ga(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new Jo(t.field,e)}));const n=t.endAt?new Go(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Go(t.startAt.position,t.startAt.inclusive):null;return ga(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}(e,Ea(t))),e.he}function Ia(t,e,n){return new wa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Sa(t,e){return va(Ta(t),Ta(e))&&t.limitType===e.limitType}function Ca(t){return`${ma(Ta(t))}|lt:${t.limitType}`}function ka(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>ra(t))).join(", ")}]`),oo(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Po(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Po(t))).join(",")),`Target(${e})`}(Ta(t))}; limitType=${t.limitType})`}function Aa(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):zr.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Ea(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Wo(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,Ea(t),e)||t.endAt&&!function(t,e,n){const i=Wo(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,Ea(t),e))}(t,e)}function xa(t){return(e,n)=>{let i=!1;for(const s of Ea(t)){const t=Ra(s,e,n);if(0!==t)return t;i=i||s.field.isKeyField()}return 0}}function Ra(t,e,n){const i=t.field.isKeyField()?zr.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),s=n.data.field(t);return null!==i&&null!==s?Lo(i,s):yr()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return yr()}}class Da{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){lo(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return ho(this.inner)}size(){return this.innerSize}}const Na=new uo(zr.comparator);function La(){return Na}const Oa=new uo(zr.comparator);function Pa(...t){let e=Oa;for(const n of t)e=e.insert(n.key,n);return e}function Ma(t){let e=Oa;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Fa(){return Va()}function Ua(){return Va()}function Va(){return new Da((t=>t.toString()),((t,e)=>t.isEqual(e)))}const ja=new uo(zr.comparator),Ba=new go(zr.comparator);function za(...t){let e=Ba;for(const n of t)e=e.add(n);return e}const qa=new go(Or);function $a(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ao(e)?"-0":e}}function Ha(t){return{integerValue:""+t}}function Ka(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ao(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Ha(e):$a(t,e)}class Ga{constructor(){this._=void 0}}function Wa(t,e,n){return t instanceof Xa?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Io(e)&&(e=So(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ya?Za(t,e):t instanceof tc?ec(t,e):function(t,e){const n=Ja(t,e),i=ic(n)+ic(t.Ie);return Fo(n)&&Fo(t.Ie)?Ha(i):$a(t.serializer,i)}(t,e)}function Qa(t,e,n){return t instanceof Ya?Za(t,e):t instanceof tc?ec(t,e):n}function Ja(t,e){return t instanceof nc?function(t){return Fo(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Xa extends Ga{}class Ya extends Ga{constructor(t){super(),this.elements=t}}function Za(t,e){const n=sc(e);for(const e of t.elements)n.some((t=>Do(t,e)))||n.push(e);return{arrayValue:{values:n}}}class tc extends Ga{constructor(t){super(),this.elements=t}}function ec(t,e){let n=sc(e);for(const e of t.elements)n=n.filter((t=>!Do(t,e)));return{arrayValue:{values:n}}}class nc extends Ga{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function ic(t){return Eo(t.integerValue||t.doubleValue)}function sc(t){return Uo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class rc{constructor(t,e){this.version=t,this.transformResults=e}}class oc{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new oc}static exists(t){return new oc(void 0,t)}static updateTime(t){return new oc(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ac(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class cc{}function lc(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new wc(t.key,oc.none()):new pc(t.key,t.data,oc.none());{const n=t.data,i=$o.empty();let s=new go(Br.comparator);for(let t of e.fields)if(!s.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),s=s.add(t)}return new gc(t.key,i,new vo(s.toArray()),oc.none())}}function hc(t,e,n){t instanceof pc?function(t,e,n){const i=t.value.clone(),s=vc(t.fieldTransforms,e,n.transformResults);i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof gc?function(t,e,n){if(!ac(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=vc(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(mc(t)),s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function uc(t,e,n,i){return t instanceof pc?function(t,e,n,i){if(!ac(t.precondition,e))return n;const s=t.value.clone(),r=yc(t.fieldTransforms,i,e);return s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null}(t,e,n,i):t instanceof gc?function(t,e,n,i){if(!ac(t.precondition,e))return n;const s=yc(t.fieldTransforms,i,e),r=e.data;return r.setAll(mc(t)),r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return ac(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function dc(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),s=Ja(i.transform,t||null);null!=s&&(null===n&&(n=$o.empty()),n.set(i.field,s))}return n||null}function fc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Pr(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ya&&e instanceof Ya||t instanceof tc&&e instanceof tc?Pr(t.elements,e.elements,Do):t instanceof nc&&e instanceof nc?Do(t.Ie,e.Ie):t instanceof Xa&&e instanceof Xa}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class pc extends cc{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class gc extends cc{constructor(t,e,n,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function mc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function vc(t,e,n){const i=new Map;wr(t.length===n.length);for(let s=0;s<n.length;s++){const r=t[s],o=r.transform,a=e.data.field(r.field);i.set(r.field,Qa(o,a,n[s]))}return i}function yc(t,e,n){const i=new Map;for(const s of t){const t=s.transform,r=n.data.field(s.field);i.set(s.field,Wa(t,r,e))}return i}class wc extends cc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bc extends cc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class _c{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&hc(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=uc(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=uc(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Ua();return this.mutations.forEach((i=>{const s=t.get(i.key),r=s.overlayedDocument;let o=this.applyToLocalView(r,s.mutatedFields);o=e.has(i.key)?null:o;const a=lc(r,o);null!==a&&n.set(i.key,a),r.isValidDocument()||r.convertToNoDocument(Fr.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),za())}isEqual(t){return this.batchId===t.batchId&&Pr(this.mutations,t.mutations,((t,e)=>fc(t,e)))&&Pr(this.baseMutations,t.baseMutations,((t,e)=>fc(t,e)))}}class Ec{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){wr(t.mutations.length===n.length);let i=ja;const s=t.mutations;for(let t=0;t<s.length;t++)i=i.insert(s[t].key,n[t].version);return new Ec(t,e,n,i)}}class Tc{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Ic{constructor(t,e){this.count=t,this.unchangedNames=e}}var Sc,Cc;function kc(t){if(void 0===t)return gr("GRPC error has no .code"),_r.UNKNOWN;switch(t){case Sc.OK:return _r.OK;case Sc.CANCELLED:return _r.CANCELLED;case Sc.UNKNOWN:return _r.UNKNOWN;case Sc.DEADLINE_EXCEEDED:return _r.DEADLINE_EXCEEDED;case Sc.RESOURCE_EXHAUSTED:return _r.RESOURCE_EXHAUSTED;case Sc.INTERNAL:return _r.INTERNAL;case Sc.UNAVAILABLE:return _r.UNAVAILABLE;case Sc.UNAUTHENTICATED:return _r.UNAUTHENTICATED;case Sc.INVALID_ARGUMENT:return _r.INVALID_ARGUMENT;case Sc.NOT_FOUND:return _r.NOT_FOUND;case Sc.ALREADY_EXISTS:return _r.ALREADY_EXISTS;case Sc.PERMISSION_DENIED:return _r.PERMISSION_DENIED;case Sc.FAILED_PRECONDITION:return _r.FAILED_PRECONDITION;case Sc.ABORTED:return _r.ABORTED;case Sc.OUT_OF_RANGE:return _r.OUT_OF_RANGE;case Sc.UNIMPLEMENTED:return _r.UNIMPLEMENTED;case Sc.DATA_LOSS:return _r.DATA_LOSS;default:return yr()}}(Cc=Sc||(Sc={}))[Cc.OK=0]="OK",Cc[Cc.CANCELLED=1]="CANCELLED",Cc[Cc.UNKNOWN=2]="UNKNOWN",Cc[Cc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Cc[Cc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Cc[Cc.NOT_FOUND=5]="NOT_FOUND",Cc[Cc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Cc[Cc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Cc[Cc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Cc[Cc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Cc[Cc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Cc[Cc.ABORTED=10]="ABORTED",Cc[Cc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Cc[Cc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Cc[Cc.INTERNAL=13]="INTERNAL",Cc[Cc.UNAVAILABLE=14]="UNAVAILABLE",Cc[Cc.DATA_LOSS=15]="DATA_LOSS";const Ac=new cr([4294967295,4294967295],0);function xc(t){const e=(new TextEncoder).encode(t),n=new ar;return n.update(e),new Uint8Array(n.digest())}function Rc(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new cr([n,i],0),new cr([s,r],0)]}class Dc{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new Nc(`Invalid padding: ${e}`);if(n<0)throw new Nc(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new Nc(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new Nc(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=cr.fromNumber(this.Te)}de(t,e,n){let i=t.add(e.multiply(cr.fromNumber(n)));return 1===i.compare(Ac)&&(i=new cr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=xc(t),[n,i]=Rc(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);if(!this.Ae(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),r=new Dc(s,i,e);return n.forEach((t=>r.insert(t))),r}insert(t){if(0===this.Te)return;const e=xc(t),[n,i]=Rc(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);this.Re(e)}}Re(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class Nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Lc{constructor(t,e,n,i,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,Oc.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Lc(Fr.min(),i,new uo(Or),La(),za())}}class Oc{constructor(t,e,n,i,s){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Oc(n,e,za(),za(),za())}}class Pc{constructor(t,e,n,i){this.Ve=t,this.removedTargetIds=e,this.key=n,this.me=i}}class Mc{constructor(t,e){this.targetId=t,this.fe=e}}class Fc{constructor(t,e,n=wo.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Uc{constructor(){this.ge=0,this.pe=Bc(),this.ye=wo.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=za(),e=za(),n=za();return this.pe.forEach(((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:yr()}})),new Oc(this.ye,this.we,t,e,n)}Fe(){this.Se=!1,this.pe=Bc()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,wr(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Vc{constructor(t){this.Le=t,this.ke=new Map,this.qe=La(),this.Qe=jc(),this.Ke=new uo(Or)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,(e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(e);break;case 3:this.je(e)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.Ce(t.resumeToken));break;default:yr()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach(((t,n)=>{this.je(n)&&e(n)}))}Je(t){const e=t.targetId,n=t.fe.count,i=this.Ye(e);if(i){const s=i.target;if(ya(s))if(0===n){const t=new zr(s.path);this.We(e,t,Ko.newNoDocument(t,Fr.min()))}else wr(1===n);else{const i=this.Ze(e);if(i!==n){const n=this.Xe(t),s=n?this.et(n,t,i):1;if(0!==s){this.He(e);const t=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,t)}}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=e;let r,o;try{r=To(n).toUint8Array()}catch(t){if(t instanceof yo)return mr("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new Dc(r,i,s)}catch(t){return mr(t instanceof Nc?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.Te?null:o}et(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Le.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const s=this.Le.nt(),r=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;t.mightContain(r)||(this.We(e,n,null),i++)})),i}it(t){const e=new Map;this.ke.forEach(((n,i)=>{const s=this.Ye(i);if(s){if(n.current&&ya(s.target)){const e=new zr(s.target.path);null!==this.qe.get(e)||this.st(i,e)||this.We(i,e,Ko.newNoDocument(e,t))}n.De&&(e.set(i,n.ve()),n.Fe())}}));let n=za();this.Qe.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ye(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.qe.forEach(((e,n)=>n.setReadTime(t)));const i=new Lc(t,e,this.Ke,this.qe,n);return this.qe=La(),this.Qe=jc(),this.Ke=new uo(Or),i}Ue(t,e){if(!this.je(t))return;const n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,e)?i.Me(e,1):i.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new Uc,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new go(Or),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||pr("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new Uc),this.Le.getRemoteKeysForTarget(t).forEach((e=>{this.We(t,e,null)}))}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function jc(){return new uo(zr.comparator)}function Bc(){return new uo(zr.comparator)}const zc={asc:"ASCENDING",desc:"DESCENDING"},qc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$c={and:"AND",or:"OR"};class Hc{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Kc(t,e){return t.useProto3Json||oo(e)?e:{value:e}}function Gc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Wc(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Qc(t,e){return Gc(t,e.toTimestamp())}function Jc(t){return wr(!!t),Fr.fromTimestamp(function(t){const e=_o(t);return new Mr(e.seconds,e.nanos)}(t))}function Xc(t,e){return Yc(t,e).canonicalString()}function Yc(t,e){const n=function(t){return new Vr(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Zc(t){const e=Vr.fromString(t);return wr(vl(e)),e}function tl(t,e){return Xc(t.databaseId,e.path)}function el(t,e){const n=Zc(e);if(n.get(1)!==t.databaseId.projectId)throw new Er(_r.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Er(_r.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new zr(sl(n))}function nl(t,e){return Xc(t.databaseId,e)}function il(t){return new Vr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function sl(t){return wr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function rl(t,e,n){return{name:tl(t,e),fields:n.value.mapValue.fields}}function ol(t,e){return{documents:[nl(t,e.path)]}}function al(t,e){const n={structuredQuery:{}},i=e.path;let s;null!==e.collectionGroup?(s=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=nl(t,s);const r=function(t){if(0!==t.length)return gl(ta.create(t,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const o=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:fl(t.field),direction:hl(t.dir)}}(t)))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Kc(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ut:n,parent:s}}function cl(t){let e=function(t){const e=Zc(t);return 4===e.length?Vr.emptyPath():sl(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){wr(1===i);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=function(t){const e=ll(t);return e instanceof ta&&na(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new Jo(pl(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,oo(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Go(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new Go(n,e)}(n.endAt)),function(t,e,n,i,s,r,o,a){return new wa(t,e,n,i,s,r,o,a)}(e,s,o,r,a,"F",c,l)}function ll(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=pl(t.unaryFilter.field);return Zo.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=pl(t.unaryFilter.field);return Zo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=pl(t.unaryFilter.field);return Zo.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=pl(t.unaryFilter.field);return Zo.create(s,"!=",{nullValue:"NULL_VALUE"});default:return yr()}}(t):void 0!==t.fieldFilter?function(t){return Zo.create(pl(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return yr()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return ta.create(t.compositeFilter.filters.map((t=>ll(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return yr()}}(t.compositeFilter.op))}(t):yr()}function hl(t){return zc[t]}function ul(t){return qc[t]}function dl(t){return $c[t]}function fl(t){return{fieldPath:t.canonicalString()}}function pl(t){return Br.fromServerFormat(t.fieldPath)}function gl(t){return t instanceof Zo?function(t){if("=="===t.op){if(jo(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NAN"}};if(Vo(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(jo(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NOT_NAN"}};if(Vo(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fl(t.field),op:ul(t.op),value:t.value}}}(t):t instanceof ta?function(t){const e=t.getFilters().map((t=>gl(t)));return 1===e.length?e[0]:{compositeFilter:{op:dl(t.op),filters:e}}}(t):yr()}function ml(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function vl(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class yl{constructor(t,e,n,i,s=Fr.min(),r=Fr.min(),o=wo.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new yl(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new yl(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new yl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new yl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class wl{constructor(t){this.ct=t}}function bl(t){const e=cl({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ia(e,e.limit,"L"):e}class _l{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(Eo(t.integerValue));else if("doubleValue"in t){const n=Eo(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),ao(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(To(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?qo(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):yr()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),zr.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}_l.bt=new _l;class El{constructor(){this._n=new Tl}addToCollectionParentIndex(t,e){return this._n.add(e),Qr.resolve()}getCollectionParents(t,e){return Qr.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return Qr.resolve()}deleteFieldIndex(t,e){return Qr.resolve()}deleteAllFieldIndexes(t){return Qr.resolve()}createTargetIndexes(t,e){return Qr.resolve()}getDocumentsMatchingTarget(t,e){return Qr.resolve(null)}getIndexType(t,e){return Qr.resolve(0)}getFieldIndexes(t,e){return Qr.resolve([])}getNextCollectionGroupToUpdate(t){return Qr.resolve(null)}getMinOffset(t,e){return Qr.resolve($r.min())}getMinOffsetFromCollectionGroup(t,e){return Qr.resolve($r.min())}updateCollectionGroup(t,e,n){return Qr.resolve()}updateIndexEntries(t,e){return Qr.resolve()}}class Tl{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new go(Vr.comparator),s=!i.has(n);return this.index[e]=i.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new go(Vr.comparator)).toArray()}}new Uint8Array(0);class Il{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Il(t,Il.DEFAULT_COLLECTION_PERCENTILE,Il.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Il.DEFAULT_COLLECTION_PERCENTILE=10,Il.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Il.DEFAULT=new Il(41943040,Il.DEFAULT_COLLECTION_PERCENTILE,Il.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Il.DISABLED=new Il(-1,0,0);class Sl{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new Sl(0)}static Bn(){return new Sl(-1)}}class Cl{constructor(){this.changes=new Da((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ko.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Qr.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class kl{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Al{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&uc(n.mutation,t,vo.empty(),Mr.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,za()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=za()){const i=Fa();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=Pa();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Fa();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,za())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let s=La();const r=Va(),o=Va();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof gc)?s=s.insert(e.key,e):void 0!==o?(r.set(e.key,o.mutation.getFieldMask()),uc(o.mutation,e,o.mutation.getFieldMask(),Mr.now())):r.set(e.key,vo.empty())})),this.recalculateAndSaveOverlays(t,s).next((t=>(t.forEach(((t,e)=>r.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new kl(e,null!==(n=r.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=Va();let i=new uo(((t,e)=>t-e)),s=za();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const s of t)s.keys().forEach((t=>{const r=e.get(t);if(null===r)return;let o=n.get(t)||vo.empty();o=s.applyToLocalView(r,o),n.set(t,o);const a=(i.get(s.batchId)||za()).add(t);i=i.insert(s.batchId,a)}))})).next((()=>{const r=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,l=Ua();c.forEach((t=>{if(!s.has(t)){const i=lc(e.get(t),n.get(t));null!==i&&l.set(t,i),s=s.add(t)}})),r.push(this.documentOverlayCache.saveOverlays(t,a,l))}return Qr.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return zr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((s=>{const r=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-s.size):Qr.resolve(Fa());let o=-1,a=s;return r.next((e=>Qr.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(e)?Qr.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,s))).next((()=>this.computeViews(t,a,e,za()))).next((t=>({batchId:o,changes:Ma(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new zr(e)).next((t=>{let e=Pa();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const s=e.collectionGroup;let r=Pa();return this.indexManager.getCollectionParents(t,s).next((o=>Qr.forEach(o,(o=>{const a=function(t,e){return new wa(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(s));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((r=>(s=r,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,s,i)))).next((t=>{s.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,Ko.newInvalidDocument(i)))}));let n=Pa();return t.forEach(((t,i)=>{const r=s.get(t);void 0!==r&&uc(r.mutation,i,vo.empty(),Mr.now()),Aa(e,i)&&(n=n.insert(t,i))})),n}))}}class xl{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return Qr.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Jc(t.createTime)}}(e)),Qr.resolve()}getNamedQuery(t,e){return Qr.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:bl(t.bundledQuery),readTime:Jc(t.readTime)}}(e)),Qr.resolve()}}class Rl{constructor(){this.overlays=new uo(zr.comparator),this.hr=new Map}getOverlay(t,e){return Qr.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Fa();return Qr.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ht(t,e,i)})),Qr.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),Qr.resolve()}getOverlaysForCollection(t,e,n){const i=Fa(),s=e.length+1,r=new zr(e.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const t=o.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===s&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Qr.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let s=new uo(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=Fa(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Fa(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Qr.resolve(o)}ht(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Tc(e,n));let s=this.hr.get(e);void 0===s&&(s=za(),this.hr.set(e,s)),this.hr.set(e,s.add(n.key))}}class Dl{constructor(){this.Pr=new go(Nl.Ir),this.Tr=new go(Nl.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new Nl(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new Nl(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new zr(new Vr([])),n=new Nl(e,t),i=new Nl(e,t+1),s=[];return this.Tr.forEachInRange([n,i],(t=>{this.Ar(t),s.push(t.key)})),s}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new zr(new Vr([])),n=new Nl(e,t),i=new Nl(e,t+1);let s=za();return this.Tr.forEachInRange([n,i],(t=>{s=s.add(t.key)})),s}containsKey(t){const e=new Nl(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Nl{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return zr.comparator(t.key,e.key)||Or(t.pr,e.pr)}static Er(t,e){return Or(t.pr,e.pr)||zr.comparator(t.key,e.key)}}class Ll{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new go(Nl.Ir)}checkEmpty(t){return Qr.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new _c(s,e,n,i);this.mutationQueue.push(r);for(const e of i)this.wr=this.wr.add(new Nl(e.key,s)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Qr.resolve(r)}lookupMutationBatch(t,e){return Qr.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.br(n),s=i<0?0:i;return Qr.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Qr.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return Qr.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Nl(e,0),i=new Nl(e,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([n,i],(t=>{const e=this.Sr(t.pr);s.push(e)})),Qr.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new go(Or);return e.forEach((t=>{const e=new Nl(t,0),i=new Nl(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,i],(t=>{n=n.add(t.pr)}))})),Qr.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let s=n;zr.isDocumentKey(s)||(s=s.child(""));const r=new Nl(new zr(s),0);let o=new go(Or);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.pr)),!0)}),r),Qr.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){wr(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Qr.forEach(e.mutations,(i=>{const s=new Nl(i.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new Nl(e,0),i=this.wr.firstAfterOrEqual(n);return Qr.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Qr.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Ol{constructor(t){this.vr=t,this.docs=new uo(zr.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),s=i?i.size:0,r=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Qr.resolve(n?n.document.mutableCopy():Ko.newInvalidDocument(e))}getEntries(t,e){let n=La();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Ko.newInvalidDocument(t))})),Qr.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let s=La();const r=e.path,o=new zr(r.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!r.isPrefixOf(t.path))break;t.path.length>r.length+1||Hr(qr(o),n)<=0||(i.has(o.key)||Aa(e,o))&&(s=s.insert(o.key,o.mutableCopy()))}return Qr.resolve(s)}getAllFromCollectionGroup(t,e,n,i){yr()}Fr(t,e){return Qr.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Pl(this)}getSize(t){return Qr.resolve(this.size)}}class Pl extends Cl{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.ar.addEntry(t,i)):this.ar.removeEntry(n)})),Qr.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class Ml{constructor(t){this.persistence=t,this.Mr=new Da((t=>ma(t)),va),this.lastRemoteSnapshotVersion=Fr.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Dl,this.targetCount=0,this.Br=Sl.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),Qr.resolve()}getLastRemoteSnapshotVersion(t){return Qr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Qr.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),Qr.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),Qr.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Br=new Sl(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,Qr.resolve()}updateTargetData(t,e){return this.qn(e),Qr.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,Qr.resolve()}removeTargets(t,e,n){let i=0;const s=[];return this.Mr.forEach(((r,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(r),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Qr.waitFor(s).next((()=>i))}getTargetCount(t){return Qr.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return Qr.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),Qr.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((e=>{s.push(i.markPotentiallyOrphaned(t,e))})),Qr.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),Qr.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return Qr.resolve(n)}containsKey(t,e){return Qr.resolve(this.Nr.containsKey(e))}}class Fl{constructor(t,e){this.Lr={},this.overlays={},this.kr=new ro(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Ml(this),this.indexManager=new El,this.remoteDocumentCache=function(t){return new Ol(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new wl(e),this.$r=new xl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Rl,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Lr[t.toKey()];return n||(n=new Ll(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){pr("MemoryPersistence","Starting transaction:",t);const i=new Ul(this.kr.next());return this.referenceDelegate.Ur(),n(i).next((t=>this.referenceDelegate.Wr(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Gr(t,e){return Qr.or(Object.values(this.Lr).map((n=>()=>n.containsKey(t,e))))}}class Ul extends Gr{constructor(t){super(),this.currentSequenceNumber=t}}class Vl{constructor(t){this.persistence=t,this.zr=new Dl,this.jr=null}static Hr(t){return new Vl(t)}get Jr(){if(this.jr)return this.jr;throw yr()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),Qr.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),Qr.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),Qr.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qr.forEach(this.Jr,(n=>{const i=zr.fromPath(n);return this.Yr(t,i).next((t=>{t||e.removeEntry(i,Fr.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return Qr.or([()=>Qr.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class jl{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=i}static Ki(t,e){let n=za(),i=za();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new jl(t,e.fromCache,n,i)}}class Bl{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class zl{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){var t;const e=null===(t=I())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()||!navigator.userAgent.includes("Safari")||navigator.userAgent.includes("Chrome")?Xr.v(x())>0?6:4:8}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,i){const s={result:null};return this.ji(t,e).next((t=>{s.result=t})).next((()=>{if(!s.result)return this.Hi(t,e,i,n).next((t=>{s.result=t}))})).next((()=>{if(s.result)return;const n=new Bl;return this.Ji(t,e,n).next((i=>{if(s.result=i,this.Ui)return this.Yi(t,e,n,i.size)}))})).next((()=>s.result))}Yi(t,e,n,i){return n.documentReadCount<this.Wi?(fr()<=G.DEBUG&&pr("QueryEngine","SDK will not create cache indexes for query:",ka(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Qr.resolve()):(fr()<=G.DEBUG&&pr("QueryEngine","Query:",ka(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(fr()<=G.DEBUG&&pr("QueryEngine","The SDK decides to create cache indexes for query:",ka(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ta(e))):Qr.resolve())}ji(t,e){if(_a(e))return Qr.resolve(null);let n=Ta(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=Ia(e,null,"F"),n=Ta(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const s=za(...i);return this.zi.getDocuments(t,s).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const r=this.Zi(e,i);return this.Xi(e,r,s,n.readTime)?this.ji(t,Ia(e,null,"F")):this.es(t,r,e,n)}))))})))))}Hi(t,e,n,i){return _a(e)||i.isEqual(Fr.min())?Qr.resolve(null):this.zi.getDocuments(t,n).next((s=>{const r=this.Zi(e,s);return this.Xi(e,r,n,i)?Qr.resolve(null):(fr()<=G.DEBUG&&pr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ka(e)),this.es(t,r,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,s=Fr.fromTimestamp(1e9===i?new Mr(n+1,0):new Mr(n,i));return new $r(s,zr.empty(),e)}(i,-1)).next((t=>t)))}))}Zi(t,e){let n=new go(xa(t));return e.forEach(((e,i)=>{Aa(t,i)&&(n=n.add(i))})),n}Xi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(t,e,n){return fr()<=G.DEBUG&&pr("QueryEngine","Using full collection scan to execute query:",ka(e)),this.zi.getDocumentsMatchingQuery(t,e,$r.min(),n)}es(t,e,n,i){return this.zi.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class ql{constructor(t,e,n,i){this.persistence=t,this.ts=e,this.serializer=i,this.ns=new uo(Or),this.rs=new Da((t=>ma(t)),va),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Al(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function $l(t,e){const n=br(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const s=[],r=[];let o=za();for(const t of i){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:s,addedBatchIds:r})))}))}))}function Hl(t){const e=br(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}function Kl(t,e){const n=br(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Gl(t,e,n){const i=br(t),s=i.ns.get(e),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,(t=>i.persistence.referenceDelegate.removeTarget(t,s)))}catch(t){if(!to(t))throw t;pr("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.ns=i.ns.remove(e),i.rs.delete(s.target)}function Wl(t,e,n){const i=br(t);let s=Fr.min(),r=za();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=br(t),s=i.rs.get(n);return void 0!==s?Qr.resolve(i.ns.get(s)):i.Qr.getTargetData(e,n)}(i,t,Ta(e)).next((e=>{if(e)return s=e.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(t,e.targetId).next((t=>{r=t}))})).next((()=>i.ts.getDocumentsMatchingQuery(t,e,n?s:Fr.min(),n?r:za()))).next((t=>(function(t,e,n){let i=t.ss.get(e)||Fr.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.ss.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,hs:r})))))}class Ql{constructor(){this.activeTargetIds=qa}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Jl{constructor(){this.no=new Ql,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new Ql,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Xl{io(t){}shutdown(){}}class Yl{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){pr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){pr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Zl=null;function th(){return null===Zl?Zl=268435456+Math.round(2147483648*Math.random()):Zl++,"0x"+Zl.toString(16)}const eh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nh{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const ih="WebChannelConnection";class sh extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${i}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get wo(){return!1}So(t,e,n,i,s){const r=th(),o=this.bo(t,e.toUriEncodedString());pr("RestConnection",`Sending RPC '${t}' ${r}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,i,s),this.Co(t,o,a,n).then((e=>(pr("RestConnection",`Received RPC '${t}' ${r}: `,e),e)),(e=>{throw mr("RestConnection",`RPC '${t}' ${r} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,i,s,r){return this.So(t,e,n,i,s)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ur,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=eh[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,i){const s=th();return new Promise(((r,o)=>{const a=new or;a.setWithCredentials(!0),a.listenOnce(nr.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case er.NO_ERROR:const e=a.getResponseJson();pr(ih,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(e)),r(e);break;case er.TIMEOUT:pr(ih,`RPC '${t}' ${s} timed out`),o(new Er(_r.DEADLINE_EXCEEDED,"Request time out"));break;case er.HTTP_ERROR:const n=a.getStatus();if(pr(ih,`RPC '${t}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(_r).indexOf(e)>=0?e:_r.UNKNOWN}(e.status);o(new Er(t,e.message))}else o(new Er(_r.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Er(_r.UNAVAILABLE,"Connection failed."));break;default:yr()}}finally{pr(ih,`RPC '${t}' ${s} completed.`)}}));const c=JSON.stringify(i);pr(ih,`RPC '${t}' ${s} sending request:`,i),a.send(e,"POST",c,n,15)}))}Fo(t,e,n){const i=th(),s=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Zs(),o=tr(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const l=s.join("");pr(ih,`Creating RPC '${t}' stream ${i}: ${l}`,a);const h=r.createWebChannel(l,a);let u=!1,d=!1;const f=new nh({lo:e=>{d?pr(ih,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(u||(pr(ih,`Opening RPC '${t}' stream ${i} transport.`),h.open(),u=!0),pr(ih,`RPC '${t}' stream ${i} sending:`,e),h.send(e))},ho:()=>h.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(h,rr.EventType.OPEN,(()=>{d||pr(ih,`RPC '${t}' stream ${i} transport opened.`)})),p(h,rr.EventType.CLOSE,(()=>{d||(d=!0,pr(ih,`RPC '${t}' stream ${i} transport closed`),f.Vo())})),p(h,rr.EventType.ERROR,(e=>{d||(d=!0,mr(ih,`RPC '${t}' stream ${i} transport errored:`,e),f.Vo(new Er(_r.UNAVAILABLE,"The operation could not be completed")))})),p(h,rr.EventType.MESSAGE,(e=>{var n;if(!d){const s=e.data[0];wr(!!s);const r=s,o=r.error||(null===(n=r[0])||void 0===n?void 0:n.error);if(o){pr(ih,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=Sc[t];if(void 0!==e)return kc(e)}(e),s=o.message;void 0===n&&(n=_r.INTERNAL,s="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new Er(n,s)),h.close()}else pr(ih,`RPC '${t}' stream ${i} received:`,s),f.mo(s)}})),p(o,ir.STAT_EVENT,(e=>{e.stat===sr.PROXY?pr(ih,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===sr.NOPROXY&&pr(ih,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function rh(){return"undefined"!=typeof document?document:null}function oh(t){return new Hc(t,!0)}class ah{constructor(t,e,n=1e3,i=1.5,s=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),i=Math.max(0,e-n);i>0&&pr("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,(()=>(this.Lo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class ch{constructor(t,e,n,i,s,r,o,a){this.oi=t,this.$o=n,this.Uo=i,this.connection=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new ah(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===_r.RESOURCE_EXHAUSTED?(gr(e.toString()),gr("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===_r.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new Er(_r.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return pr("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(pr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lh extends ch{constructor(t,e,n,i,s,r){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,r),this.serializer=s}a_(t,e){return this.connection.Fo("Listen",t,e)}onMessage(t){this.jo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:yr()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=function(t,e){return t.useProto3Json?(wr(void 0===e||"string"==typeof e),wo.fromBase64String(e||"")):(wr(void 0===e||e instanceof Uint8Array),wo.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?_r.UNKNOWN:kc(t.code);return new Er(e,t.message||"")}(o);n=new Fc(i,s,r,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=el(t,i.document.name),r=Jc(i.document.updateTime),o=i.document.createTime?Jc(i.document.createTime):Fr.min(),a=new $o({mapValue:{fields:i.document.fields}}),c=Ko.newFoundDocument(s,r,o,a),l=i.targetIds||[],h=i.removedTargetIds||[];n=new Pc(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=el(t,i.document),r=i.readTime?Jc(i.readTime):Fr.min(),o=Ko.newNoDocument(s,r),a=i.removedTargetIds||[];n=new Pc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=el(t,i.document),r=i.removedTargetIds||[];n=new Pc([],r,s,null)}else{if(!("filter"in e))return yr();{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:s}=t,r=new Ic(i,s),o=t.targetId;n=new Mc(o,r)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Fr.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Fr.min():e.readTime?Jc(e.readTime):Fr.min()}(t);return this.listener.u_(e,n)}c_(t){const e={};e.database=il(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=ya(i)?{documents:ol(t,i)}:{query:al(t,i).ut},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=Wc(t,e.resumeToken);const i=Kc(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(Fr.min())>0){n.readTime=Gc(t,e.snapshotVersion.toTimestamp());const i=Kc(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return yr()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.t_(e)}l_(t){const e={};e.database=il(this.serializer),e.removeTarget=t,this.t_(e)}}class hh extends ch{constructor(t,e,n,i,s,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,r),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(wr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(wr(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Jc(t.updateTime):Jc(e);return n.isEqual(Fr.min())&&(n=Jc(e)),new rc(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Jc(t.commitTime);return this.listener.T_(n,e)}return wr(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=il(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof pc)n={update:rl(t,e.key,e.value)};else if(e instanceof wc)n={delete:tl(t,e.key)};else if(e instanceof gc)n={update:rl(t,e.key,e.data),updateMask:ml(e.fieldMask)};else{if(!(e instanceof bc))return yr();n={verify:tl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Xa)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ya)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof tc)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof nc)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw yr()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Qc(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:yr()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class uh extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new Er(_r.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,r])=>this.connection.So(t,Yc(e,n),i,s,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===_r.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Er(_r.UNKNOWN,t.toString())}))}vo(t,e,n,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.vo(t,Yc(e,n),i,r,o,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===_r.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Er(_r.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class dh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(gr(e),this.g_=!1):pr("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class fh{constructor(t,e,n,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io((t=>{n.enqueueAndForget((async()=>{Eh(this)&&(pr("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=br(t);e.v_.add(4),await gh(e),e.x_.set("Unknown"),e.v_.delete(4),await ph(e)}(this))}))})),this.x_=new dh(n,i)}}async function ph(t){if(Eh(t))for(const e of t.F_)await e(!0)}async function gh(t){for(const e of t.F_)await e(!1)}function mh(t,e){const n=br(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),_h(n)?bh(n):Vh(n).Jo()&&yh(n,e))}function vh(t,e){const n=br(t),i=Vh(n);n.C_.delete(e),i.Jo()&&wh(n,e),0===n.C_.size&&(i.Jo()?i.Xo():Eh(n)&&n.x_.set("Unknown"))}function yh(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fr.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Vh(t).c_(e)}function wh(t,e){t.O_.Oe(e),Vh(t).l_(e)}function bh(t){t.O_=new Vc({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Vh(t).start(),t.x_.p_()}function _h(t){return Eh(t)&&!Vh(t).Ho()&&t.C_.size>0}function Eh(t){return 0===br(t).v_.size}function Th(t){t.O_=void 0}async function Ih(t){t.C_.forEach(((e,n)=>{yh(t,e)}))}async function Sh(t,e){Th(t),_h(t)?(t.x_.S_(e),bh(t)):t.x_.set("Unknown")}async function Ch(t,e,n){if(t.x_.set("Online"),e instanceof Fc&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.C_.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.C_.delete(i),t.O_.removeTarget(i))}(t,e)}catch(n){pr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await kh(t,n)}else if(e instanceof Pc?t.O_.$e(e):e instanceof Mc?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(Fr.min()))try{const e=await Hl(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.O_.it(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const s=t.C_.get(i);s&&t.C_.set(i,s.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.C_.get(e);if(!i)return;t.C_.set(e,i.withResumeToken(wo.EMPTY_BYTE_STRING,i.snapshotVersion)),wh(t,e);const s=new yl(i.target,e,n,i.sequenceNumber);yh(t,s)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){pr("RemoteStore","Failed to raise snapshot:",e),await kh(t,e)}}async function kh(t,e,n){if(!to(e))throw e;t.v_.add(1),await gh(t),t.x_.set("Offline"),n||(n=()=>Hl(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{pr("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await ph(t)}))}function Ah(t,e){return e().catch((n=>kh(t,n,e)))}async function xh(t){const e=br(t),n=jh(e);let i=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;Rh(e);)try{const t=await Kl(e.localStore,i);if(null===t){0===e.D_.length&&n.Xo();break}i=t.batchId,Dh(e,t)}catch(t){await kh(e,t)}Nh(e)&&Lh(e)}function Rh(t){return Eh(t)&&t.D_.length<10}function Dh(t,e){t.D_.push(e);const n=jh(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function Nh(t){return Eh(t)&&!jh(t).Ho()&&t.D_.length>0}function Lh(t){jh(t).start()}async function Oh(t){jh(t).d_()}async function Ph(t){const e=jh(t);for(const n of t.D_)e.I_(n.mutations)}async function Mh(t,e,n){const i=t.D_.shift(),s=Ec.from(i,e,n);await Ah(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await xh(t)}async function Fh(t,e){e&&jh(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return yr();case _r.CANCELLED:case _r.UNKNOWN:case _r.DEADLINE_EXCEEDED:case _r.RESOURCE_EXHAUSTED:case _r.INTERNAL:case _r.UNAVAILABLE:case _r.UNAUTHENTICATED:return!1;case _r.INVALID_ARGUMENT:case _r.NOT_FOUND:case _r.ALREADY_EXISTS:case _r.PERMISSION_DENIED:case _r.FAILED_PRECONDITION:case _r.ABORTED:case _r.OUT_OF_RANGE:case _r.UNIMPLEMENTED:case _r.DATA_LOSS:return!0}}(t)&&t!==_r.ABORTED}(e.code)){const n=t.D_.shift();jh(t).Zo(),await Ah(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await xh(t)}}(t,e),Nh(t)&&Lh(t)}async function Uh(t,e){const n=br(t);n.asyncQueue.verifyOperationInProgress(),pr("RemoteStore","RemoteStore received new credentials");const i=Eh(n);n.v_.add(3),await gh(n),i&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await ph(n)}function Vh(t){return t.N_||(t.N_=function(t,e,n){const i=br(t);return i.R_(),new lh(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:Ih.bind(null,t),To:Sh.bind(null,t),u_:Ch.bind(null,t)}),t.F_.push((async e=>{e?(t.N_.Zo(),_h(t)?bh(t):t.x_.set("Unknown")):(await t.N_.stop(),Th(t))}))),t.N_}function jh(t){return t.B_||(t.B_=function(t,e,n){const i=br(t);return i.R_(),new hh(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:Oh.bind(null,t),To:Fh.bind(null,t),E_:Ph.bind(null,t),T_:Mh.bind(null,t)}),t.F_.push((async e=>{e?(t.B_.Zo(),await xh(t)):(await t.B_.stop(),t.D_.length>0&&(pr("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}class Bh{constructor(t,e,n,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Tr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,s){const r=Date.now()+n,o=new Bh(t,e,r,i,s);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Er(_r.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zh(t,e){if(gr("AsyncQueue",`${e}: ${t}`),to(t))return new Er(_r.UNAVAILABLE,`${e}: ${t}`);throw t}class qh{constructor(t){this.comparator=t?(e,n)=>t(e,n)||zr.comparator(e.key,n.key):(t,e)=>zr.comparator(t.key,e.key),this.keyedMap=Pa(),this.sortedSet=new uo(this.comparator)}static emptySet(t){return new qh(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof qh))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new qh;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class $h{constructor(){this.L_=new uo(zr.comparator)}track(t){const e=t.doc.key,n=this.L_.get(e);n?0!==t.type&&3===n.type?this.L_=this.L_.insert(e,t):3===t.type&&1!==n.type?this.L_=this.L_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.L_=this.L_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.L_=this.L_.remove(e):1===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):yr():this.L_=this.L_.insert(e,t)}k_(){const t=[];return this.L_.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Hh{constructor(t,e,n,i,s,r,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=r,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,i,s){const r=[];return e.forEach((t=>{r.push({type:0,doc:t})})),new Hh(t,e,qh.emptySet(e),r,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Sa(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Kh{constructor(){this.q_=void 0,this.Q_=[]}}class Gh{constructor(){this.queries=new Da((t=>Ca(t)),Sa),this.onlineState="Unknown",this.K_=new Set}}function Wh(t,e){const n=br(t);let i=!1;for(const t of e){const e=t.query,s=n.queries.get(e);if(s){for(const e of s.Q_)e.W_(t)&&(i=!0);s.q_=t}}i&&Jh(n)}function Qh(t,e,n){const i=br(t),s=i.queries.get(e);if(s)for(const t of s.Q_)t.onError(n);i.queries.delete(e)}function Jh(t){t.K_.forEach((t=>{t.next()}))}class Xh{constructor(t,e,n){this.query=t,this.G_=e,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}W_(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Hh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.z_?this.H_(t)&&(this.G_.next(t),e=!0):this.J_(t,this.onlineState)&&(this.Y_(t),e=!0),this.j_=t,e}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let e=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),e=!0),e}J_(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Z_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}H_(t){if(t.docChanges.length>0)return!0;const e=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}Y_(t){t=Hh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}class Yh{constructor(t){this.key=t}}class Zh{constructor(t){this.key=t}}class tu{constructor(t,e){this.query=t,this.oa=e,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=za(),this.mutatedKeys=za(),this.ua=xa(t),this.ca=new qh(this.ua)}get la(){return this.oa}ha(t,e){const n=e?e.Pa:new $h,i=e?e.ca:this.ca;let s=e?e.mutatedKeys:this.mutatedKeys,r=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const l=i.get(t),h=Aa(this.query,e)?e:null,u=!!l&&this.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;l&&h?l.data.isEqual(h.data)?u!==d&&(n.track({type:3,doc:h}),f=!0):this.Ia(l,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.ua(h,a)>0||c&&this.ua(h,c)<0)&&(o=!0)):!l&&h?(n.track({type:0,doc:h}),f=!0):l&&!h&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(o=!0)),f&&(h?(r=r.add(h),s=d?s.add(t):s.delete(t)):(r=r.delete(t),s=s.delete(t)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const t="F"===this.query.limitType?r.last():r.first();r=r.delete(t.key),s=s.delete(t.key),n.track({type:1,doc:t})}return{ca:r,Pa:n,Xi:o,mutatedKeys:s}}Ia(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const s=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;const r=t.Pa.k_();r.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return yr()}};return n(t)-n(e)}(t.type,e.type)||this.ua(t.doc,e.doc))),this.Ta(n),i=null!=i&&i;const o=e&&!i?this.Ea():[],a=0===this.aa.size&&this.current&&!i?1:0,c=a!==this._a;return this._a=a,0!==r.length||c?{snapshot:new Hh(this.query,t.ca,s,r,t.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),da:o}:{da:o}}U_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new $h,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach((t=>this.oa=this.oa.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.oa=this.oa.delete(t))),this.current=t.current)}Ea(){if(!this.current)return[];const t=this.aa;this.aa=za(),this.ca.forEach((t=>{this.Aa(t.key)&&(this.aa=this.aa.add(t.key))}));const e=[];return t.forEach((t=>{this.aa.has(t)||e.push(new Zh(t))})),this.aa.forEach((n=>{t.has(n)||e.push(new Yh(n))})),e}Ra(t){this.oa=t.hs,this.aa=za();const e=this.ha(t.documents);return this.applyChanges(e,!0)}Va(){return Hh.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class eu{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class nu{constructor(t){this.key=t,this.ma=!1}}class iu{constructor(t,e,n,i,s,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.fa={},this.ga=new Da((t=>Ca(t)),Sa),this.pa=new Map,this.ya=new Set,this.wa=new uo(zr.comparator),this.Sa=new Map,this.ba=new Dl,this.Da={},this.Ca=new Map,this.va=Sl.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}async function su(t,e){const n=function(t){const e=br(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ou.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bu.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cu.bind(null,e),e.fa.u_=Wh.bind(null,e.eventManager),e.fa.xa=Qh.bind(null,e.eventManager),e}(t);let i,s;const r=n.ga.get(e);if(r)i=r.targetId,n.sharedClientState.addLocalQueryTarget(i),s=r.view.Va();else{const t=await function(t,e){const n=br(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Qr.getTargetData(t,e).next((s=>s?(i=s,Qr.resolve(i)):n.Qr.allocateTargetId(t).next((s=>(i=new yl(e,s,"TargetPurposeListen",t.currentSequenceNumber),n.Qr.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.ns.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(t.targetId,t),n.rs.set(e,t.targetId)),t}))}(n.localStore,Ta(e)),r=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,s=await async function(t,e,n,i,s){t.Ma=(e,n,i)=>async function(t,e,n,i){let s=e.view.ha(n);s.Xi&&(s=await Wl(t.localStore,e.query,!1).then((({documents:t})=>e.view.ha(t,s))));const r=i&&i.targetChanges.get(e.targetId),o=i&&null!=i.targetMismatches.get(e.targetId),a=e.view.applyChanges(s,t.isPrimaryClient,r,o);return gu(t,e.targetId,a.da),a.snapshot}(t,e,n,i);const r=await Wl(t.localStore,e,!0),o=new tu(e,r.hs),a=o.ha(r.documents),c=Oc.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,s),l=o.applyChanges(a,t.isPrimaryClient,c);gu(t,n,l.da);const h=new eu(e,n,o);return t.ga.set(e,h),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),l.snapshot}(n,e,i,"current"===r,t.resumeToken),n.isPrimaryClient&&mh(n.remoteStore,t)}return s}async function ru(t,e){const n=br(t),i=n.ga.get(e),s=n.pa.get(i.targetId);if(s.length>1)return n.pa.set(i.targetId,s.filter((t=>!Sa(t,e)))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Gl(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),vh(n.remoteStore,i.targetId),fu(n,i.targetId)})).catch(Wr)):(fu(n,i.targetId),await Gl(n.localStore,i.targetId,!0))}async function ou(t,e){const n=br(t);try{const t=await function(t,e){const n=br(t),i=e.snapshotVersion;let s=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const r=n.os.newChangeBuffer({trackRemovals:!0});s=n.ns;const o=[];e.targetChanges.forEach(((r,a)=>{const c=s.get(a);if(!c)return;o.push(n.Qr.removeMatchingKeys(t,r.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(t,r.addedDocuments,a))));let l=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?l=l.withResumeToken(wo.EMPTY_BYTE_STRING,Fr.min()).withLastLimboFreeSnapshotVersion(Fr.min()):r.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(r.resumeToken,i)),s=s.insert(a,l),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,r)&&o.push(n.Qr.updateTargetData(t,l))}));let a=La(),c=za();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n){let i=za(),s=za();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=La();return n.forEach(((n,r)=>{const o=t.get(n);r.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(n)),r.isNoDocument()&&r.version.isEqual(Fr.min())?(e.removeEntry(n,r.readTime),i=i.insert(n,r)):!o.isValidDocument()||r.version.compareTo(o.version)>0||0===r.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(r),i=i.insert(n,r)):pr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",r.version)})),{cs:i,ls:s}}))}(t,r,e.documentUpdates).next((t=>{a=t.cs,c=t.ls}))),!i.isEqual(Fr.min())){const e=n.Qr.getLastRemoteSnapshotVersion(t).next((e=>n.Qr.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return Qr.waitFor(o).next((()=>r.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.ns=s,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Sa.get(e);i&&(wr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.ma=!0:t.modifiedDocuments.size>0?wr(i.ma):t.removedDocuments.size>0&&(wr(i.ma),i.ma=!1))})),await yu(n,t,e)}catch(t){await Wr(t)}}function au(t,e,n){const i=br(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ga.forEach(((n,i)=>{const s=i.view.U_(e);s.snapshot&&t.push(s.snapshot)})),function(t,e){const n=br(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.U_(e)&&(i=!0)})),i&&Jh(n)}(i.eventManager,e),t.length&&i.fa.u_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function cu(t,e,n){const i=br(t);i.sharedClientState.updateQueryState(e,"rejected",n);const s=i.Sa.get(e),r=s&&s.key;if(r){let t=new uo(zr.comparator);t=t.insert(r,Ko.newNoDocument(r,Fr.min()));const n=za().add(r),s=new Lc(Fr.min(),new Map,new uo(Or),t,n);await ou(i,s),i.wa=i.wa.remove(r),i.Sa.delete(e),vu(i)}else await Gl(i.localStore,e,!1).then((()=>fu(i,e,n))).catch(Wr)}async function lu(t,e){const n=br(t),i=e.batch.batchId;try{const t=await function(t,e){const n=br(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const s=n.batch,r=s.keys();let o=Qr.resolve();return r.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);wr(null!==r),e.version.compareTo(r)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,s)))}(n,t,e,s).next((()=>s.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=za();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);du(n,i,null),uu(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await yu(n,t)}catch(t){await Wr(t)}}async function hu(t,e,n){const i=br(t);try{const t=await function(t,e){const n=br(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(wr(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);du(i,e,n),uu(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await yu(i,t)}catch(n){await Wr(n)}}function uu(t,e){(t.Ca.get(e)||[]).forEach((t=>{t.resolve()})),t.Ca.delete(e)}function du(t,e,n){const i=br(t);let s=i.Da[i.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),i.Da[i.currentUser.toKey()]=s}}function fu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.pa.get(e))t.ga.delete(i),n&&t.fa.xa(i,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach((e=>{t.ba.containsKey(e)||pu(t,e)}))}function pu(t,e){t.ya.delete(e.path.canonicalString());const n=t.wa.get(e);null!==n&&(vh(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),vu(t))}function gu(t,e,n){for(const i of n)i instanceof Yh?(t.ba.addReference(i.key,e),mu(t,i)):i instanceof Zh?(pr("SyncEngine","Document no longer in limbo: "+i.key),t.ba.removeReference(i.key,e),t.ba.containsKey(i.key)||pu(t,i.key)):yr()}function mu(t,e){const n=e.key,i=n.path.canonicalString();t.wa.get(n)||t.ya.has(i)||(pr("SyncEngine","New document in limbo: "+n),t.ya.add(i),vu(t))}function vu(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){const e=t.ya.values().next().value;t.ya.delete(e);const n=new zr(Vr.fromString(e)),i=t.va.next();t.Sa.set(i,new nu(n)),t.wa=t.wa.insert(n,i),mh(t.remoteStore,new yl(Ta(ba(n.path)),i,"TargetPurposeLimboResolution",ro._e))}}async function yu(t,e,n){const i=br(t),s=[],r=[],o=[];i.ga.isEmpty()||(i.ga.forEach(((t,a)=>{o.push(i.Ma(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){s.push(t);const e=jl.Ki(a.targetId,t);r.push(e)}})))})),await Promise.all(o),i.fa.u_(s),await async function(t,e){const n=br(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Qr.forEach(e,(e=>Qr.forEach(e.qi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Qr.forEach(e.Qi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!to(t))throw t;pr("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),i=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(i);n.ns=n.ns.insert(e,s)}}}(i.localStore,r))}async function wu(t,e){const n=br(t);if(!n.currentUser.isEqual(e)){pr("SyncEngine","User change. New user:",e.toKey());const t=await $l(n.localStore,e);n.currentUser=e,function(t,e){t.Ca.forEach((t=>{t.forEach((t=>{t.reject(new Er(_r.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ca.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await yu(n,t.us)}}function bu(t,e){const n=br(t),i=n.Sa.get(e);if(i&&i.ma)return za().add(i.key);{let t=za();const i=n.pa.get(e);if(!i)return t;for(const e of i){const i=n.ga.get(e);t=t.unionWith(i.view.la)}return t}}function _u(t){const e=br(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lu.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hu.bind(null,e),e}class Eu{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=oh(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,i){return new ql(t,e,n,i)}(this.persistence,new zl,t.initialUser,this.serializer)}createPersistence(t){return new Fl(Vl.Hr,this.serializer)}createSharedClientState(t){return new Jl}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Tu{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>au(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=wu.bind(null,this.syncEngine),await async function(t,e){const n=br(t);e?(n.v_.delete(2),await ph(n)):e||(n.v_.add(2),await gh(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Gh}createDatastore(t){const e=oh(t.databaseInfo.databaseId),n=function(t){return new sh(t)}(t.databaseInfo);return function(t,e,n,i){return new uh(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,s){return new fh(t,e,n,i,s)}(this.localStore,this.datastore,t.asyncQueue,(t=>au(this.syncEngine,t,0)),Yl.D()?new Yl:new Xl)}createSyncEngine(t,e){return function(t,e,n,i,s,r,o){const a=new iu(t,e,n,i,s,r);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=br(t);pr("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await gh(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class Iu{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):gr("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class Su{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=hr.UNAUTHENTICATED,this.clientId=Lr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{pr("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(pr("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Er(_r.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Tr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=zh(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Cu(t,e){t.asyncQueue.verifyOperationInProgress(),pr("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await $l(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function ku(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){pr("FirestoreClient","Using user provided OfflineComponentProvider");try{await Cu(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===_r.FAILED_PRECONDITION||t.code===_r.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;mr("Error using user provided cache. Falling back to memory cache: "+n),await Cu(t,new Eu)}}else pr("FirestoreClient","Using default OfflineComponentProvider"),await Cu(t,new Eu);return t._offlineComponents}(t);pr("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>Uh(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Uh(e.remoteStore,n))),t._onlineComponents=e}async function Au(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(pr("FirestoreClient","Using user provided OnlineComponentProvider"),await ku(t,t._uninitializedComponentsProvider._online)):(pr("FirestoreClient","Using default OnlineComponentProvider"),await ku(t,new Tu))),t._onlineComponents}async function xu(t){const e=await Au(t),n=e.eventManager;return n.onListen=su.bind(null,e.syncEngine),n.onUnlisten=ru.bind(null,e.syncEngine),n}function Ru(t,e,n={}){const i=new Tr;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,s){const r=new Iu({next:n=>{e.enqueueAndForget((()=>async function(t,e){const n=br(t),i=e.query;let s=!1;const r=n.queries.get(i);if(r){const t=r.Q_.indexOf(e);t>=0&&(r.Q_.splice(t,1),s=0===r.Q_.length)}if(s)return n.queries.delete(i),n.onUnlisten(i)}(t,o))),n.fromCache&&"server"===i.source?s.reject(new Er(_r.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:t=>s.reject(t)}),o=new Xh(n,r,{includeMetadataChanges:!0,Z_:!0});return async function(t,e){const n=br(t),i=e.query;let s=!1,r=n.queries.get(i);if(r||(s=!0,r=new Kh),s)try{r.q_=await n.onListen(i)}catch(t){const n=zh(t,`Initialization of query '${ka(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,r),r.Q_.push(e),e.U_(n.onlineState),r.q_&&e.W_(r.q_)&&Jh(n)}(t,o)}(await xu(t),t.asyncQueue,e,n,i))),i.promise}function Du(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Nu=new Map;function Lu(t,e,n){if(!n)throw new Er(_r.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ou(t){if(!zr.isDocumentKey(t))throw new Er(_r.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Pu(t){if(zr.isDocumentKey(t))throw new Er(_r.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Mu(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":yr()}function Fu(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Er(_r.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Mu(t);throw new Er(_r.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Uu{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Er(_r.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Er(_r.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new Er(_r.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Du(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new Er(_r.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new Er(_r.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new Er(_r.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Vu{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Er(_r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Er(_r.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uu(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Sr;switch(t.type){case"firstParty":return new xr(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Er(_r.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Nu.get(t);e&&(pr("ComponentProvider","Removing Datastore"),Nu.delete(t),e.terminate())}(this),Promise.resolve()}}class ju{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ju(this.firestore,t,this._query)}}class Bu{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zu(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Bu(this.firestore,t,this._key)}}class zu extends ju{constructor(t,e,n){super(t,e,ba(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Bu(this.firestore,null,new zr(t))}withConverter(t){return new zu(this.firestore,t,this._path)}}function qu(t,e,...n){if(t=B(t),Lu("collection","path",e),t instanceof Vu){const i=Vr.fromString(e,...n);return Pu(i),new zu(t,null,i)}{if(!(t instanceof Bu||t instanceof zu))throw new Er(_r.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Vr.fromString(e,...n));return Pu(i),new zu(t.firestore,null,i)}}function $u(t,e,...n){if(t=B(t),1===arguments.length&&(e=Lr.newId()),Lu("doc","path",e),t instanceof Vu){const i=Vr.fromString(e,...n);return Ou(i),new Bu(t,null,new zr(i))}{if(!(t instanceof Bu||t instanceof zu))throw new Er(_r.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Vr.fromString(e,...n));return Ou(i),new Bu(t.firestore,t instanceof zu?t.converter:null,new zr(i))}}class Hu{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new ah(this,"async_queue_retry"),this._u=()=>{const t=rh();t&&pr("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=rh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const e=rh();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise((()=>{}));const e=new Tr;return this.uu((()=>this.tu&&this.su?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.eu.push(t),this.cu())))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!to(t))throw t;pr("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo((()=>this.cu()))}}uu(t){const e=this.Xa.then((()=>(this.iu=!0,t().catch((t=>{this.ru=t,this.iu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw gr("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.iu=!1,t))))));return this.Xa=e,e}enqueueAfterDelay(t,e,n){this.au(),this.ou.indexOf(t)>-1&&(e=0);const i=Bh.createAndSchedule(this,t,e,n,(t=>this.lu(t)));return this.nu.push(i),i}au(){this.ru&&yr()}verifyOperationInProgress(){}async hu(){let t;do{t=this.Xa,await t}while(t!==this.Xa)}Pu(t){for(const e of this.nu)if(e.timerId===t)return!0;return!1}Iu(t){return this.hu().then((()=>{this.nu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.hu()}))}Tu(t){this.ou.push(t)}lu(t){const e=this.nu.indexOf(t);this.nu.splice(e,1)}}class Ku extends Vu{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Hu,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Wu(this),this._firestoreClient.terminate()}}function Gu(t){return t._firestoreClient||Wu(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Wu(t){var e,n,i;const s=t._freezeSettings(),r=function(t,e,n,i){return new ko(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Du(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new Su(t._authCredentials,t._appCheckCredentials,t._queue,r),(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=s.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}class Qu{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Qu(wo.fromBase64String(t))}catch(t){throw new Er(_r.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Qu(wo.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Ju{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Er(_r.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Br(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Xu{constructor(t){this._methodName=t}}class Yu{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Er(_r.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Er(_r.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Or(this._lat,t._lat)||Or(this._long,t._long)}}const Zu=/^__.*__$/;class td{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new gc(t,this.data,this.fieldMask,e,this.fieldTransforms):new pc(t,this.data,e,this.fieldTransforms)}}class ed{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new gc(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function nd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw yr()}}class id{constructor(t,e,n,i,s,r){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=r||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new id(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.mu(t),i}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.Eu(),i}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return gd(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(nd(this.du)&&Zu.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class sd{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||oh(t)}Su(t,e,n,i=!1){return new id({du:t,methodName:e,wu:n,path:Br.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rd(t){const e=t._freezeSettings(),n=oh(t._databaseId);return new sd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function od(t,e,n,i,s,r={}){const o=t.Su(r.merge||r.mergeFields?2:0,e,n,s);ud("Data must be an object, but it was:",o,i);const a=ld(i,o);let c,l;if(r.merge)c=new vo(o.fieldMask),l=o.fieldTransforms;else if(r.mergeFields){const t=[];for(const i of r.mergeFields){const s=dd(e,i,n);if(!o.contains(s))throw new Er(_r.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);md(t,s)||t.push(s)}c=new vo(t),l=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=o.fieldTransforms;return new td(new $o(a),c,l)}class ad extends Xu{_toFieldTransform(t){if(2!==t.du)throw 1===t.du?t.pu(`${this._methodName}() can only appear at the top level of your update data`):t.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ad}}function cd(t,e){if(hd(t=B(t)))return ud("Unsupported field value:",e,t),ld(t,e);if(t instanceof Xu)return function(t,e){if(!nd(e.du))throw e.pu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.pu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&4!==e.du)throw e.pu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const s of t){let t=cd(s,e.gu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=B(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ka(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Mr.fromDate(t);return{timestampValue:Gc(e.serializer,n)}}if(t instanceof Mr){const n=new Mr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Gc(e.serializer,n)}}if(t instanceof Yu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Qu)return{bytesValue:Wc(e.serializer,t._byteString)};if(t instanceof Bu){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.pu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Xc(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.pu(`Unsupported field value: ${Mu(t)}`)}(t,e)}function ld(t,e){const n={};return ho(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(t,((t,i)=>{const s=cd(i,e.Ru(t));null!=s&&(n[t]=s)})),{mapValue:{fields:n}}}function hd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Mr||t instanceof Yu||t instanceof Qu||t instanceof Bu||t instanceof Xu)}function ud(t,e,n){if(!hd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Mu(n);throw"an object"===i?e.pu(t+" a custom object"):e.pu(t+" "+i)}}function dd(t,e,n){if((e=B(e))instanceof Ju)return e._internalPath;if("string"==typeof e)return pd(t,e);throw gd("Field path arguments must be of type string or ",t,!1,void 0,n)}const fd=new RegExp("[~\\*/\\[\\]]");function pd(t,e,n){if(e.search(fd)>=0)throw gd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ju(...e.split("."))._internalPath}catch(i){throw gd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function gd(t,e,n,i,s){const r=i&&!i.isEmpty(),o=void 0!==s;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new Er(_r.INVALID_ARGUMENT,a+t+c)}function md(t,e){return t.some((t=>t.isEqual(e)))}class vd{constructor(t,e,n,i,s){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Bu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new yd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(wd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class yd extends vd{data(){return super.data()}}function wd(t,e){return"string"==typeof e?pd(t,e):e instanceof Ju?e._internalPath:e._delegate._internalPath}class bd{convertValue(t,e="none"){switch(Ro(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Eo(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(To(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw yr()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return lo(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Yu(Eo(t.latitude),Eo(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=So(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Co(t));default:return null}}convertTimestamp(t){const e=_o(t);return new Mr(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Vr.fromString(t);wr(vl(n));const i=new Ao(n.get(1),n.get(3)),s=new zr(n.popFirst(5));return i.isEqual(e)||gr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}function _d(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Ed{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Td extends vd{constructor(t,e,n,i,s,r){super(t,e,n,i,r),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Id(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(wd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class Id extends Td{data(t={}){return super.data(t)}}class Sd{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Ed(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Id(this._firestore,this._userDataWriter,n.key,n,new Ed(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Er(_r.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new Id(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Ed(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new Id(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Ed(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let s=-1,r=-1;return 0!==e.type&&(s=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),r=n.indexOf(e.doc.key)),{type:Cd(e.type),doc:i,oldIndex:s,newIndex:r}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Cd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return yr()}}class kd extends bd{constructor(t){super(),this.firestore=t}convertBytes(t){return new Qu(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Bu(this.firestore,null,e)}}function Ad(t){t=Fu(t,ju);const e=Fu(t.firestore,Ku),n=Gu(e),i=new kd(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Er(_r.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),Ru(n,t._query).then((n=>new Sd(e,i,t,n)))}function xd(t,e){const n=Fu(t.firestore,Ku),i=$u(t),s=_d(t.converter,e);return Rd(n,[od(rd(t.firestore),"addDoc",i._key,s,null!==t.converter,{}).toMutation(i._key,oc.exists(!1))]).then((()=>i))}function Rd(t,e){return function(t,e){const n=new Tr;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=_u(t);try{const t=await function(t,e){const n=br(t),i=Mr.now(),s=e.reduce(((t,e)=>t.add(e.key)),za());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=La(),c=za();return n.os.getEntries(t,s).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((s=>{r=s;const o=[];for(const t of e){const e=dc(t,r.get(t.key).overlayedDocument);null!=e&&o.push(new gc(t.key,e,Ho(e.value.mapValue),oc.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:Ma(r)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Da[t.currentUser.toKey()];i||(i=new uo(Or)),i=i.insert(e,n),t.Da[t.currentUser.toKey()]=i}(i,t.batchId,n),await yu(i,t.changes),await xh(i.remoteStore)}catch(t){const e=zh(t,"Failed to persist write");n.reject(e)}}(await function(t){return Au(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Gu(t),e)}function Dd(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}new WeakMap,function(t,e=!0){!function(t){ur=t}(xt),St(new z("firestore",((t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),r=new Ku(new kr(t.getProvider("auth-internal")),new Dr(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Er(_r.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ao(t.options.projectId,e)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),r._setSettings(i),r}),"PUBLIC").setMultipleInstances(!0)),Nt(lr,"4.4.1",t),Nt(lr,"4.4.1","esm2017")}(),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Nd=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ld=new N("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Od=new Y("@firebase/auth");function Pd(t,...e){Od.logLevel<=G.ERROR&&Od.error(`Auth (${xt}): ${t}`,...e)}function Md(t,...e){throw Ud(t,...e)}function Fd(t,...e){return Ud(t,...e)}function Ud(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return Ld.create(t,...e)}function Vd(t,e,...n){if(!t)throw Ud(e,...n)}function jd(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Pd(e),new Error(e)}function Bd(t,e){t||jd(e)}function zd(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function qd(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function $d(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===qd()||"https:"===qd()||function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class Hd{constructor(t,e){this.shortDelay=t,this.longDelay=e,Bd(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(x())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return $d()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Kd(t,e){Bd(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Gd{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void jd("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void jd("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void jd("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Wd={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Qd=new Hd(3e4,6e4);function Jd(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Xd(t,e,n,i,s={}){return Yd(t,s,(async()=>{let s={},r={};i&&("GET"===e?r=i:s={body:JSON.stringify(i)});const o=M(Object.assign({key:t.config.apiKey},r)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Gd.fetch()(tf(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},s))}))}async function Yd(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Wd),e);try{const e=new nf(t),s=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const r=await s.json();if("needConfirmation"in r)throw sf(t,"account-exists-with-different-credential",r);if(s.ok&&!("errorMessage"in r))return r;{const e=s.ok?r.errorMessage:r.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw sf(t,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw sf(t,"email-already-in-use",r);if("USER_DISABLED"===n)throw sf(t,"user-disabled",r);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const i=Object.assign(Object.assign({},Nd()),{[e]:n});return new N("auth","Firebase",i).create(e,{appName:t.name})}(t,a,o);Md(t,a)}}catch(e){if(e instanceof D)throw e;Md(t,"network-request-failed",{message:String(e)})}}async function Zd(t,e,n,i,s={}){const r=await Xd(t,e,n,i,s);return"mfaPendingCredential"in r&&Md(t,"multi-factor-auth-required",{_serverResponse:r}),r}function tf(t,e,n,i){const s=`${e}${n}?${i}`;return t.config.emulator?Kd(t.config,s):`${t.config.apiScheme}://${s}`}function ef(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class nf{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Fd(this.auth,"network-request-failed"))),Qd.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function sf(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=Fd(t,e,i);return s.customData._tokenResponse=n,s}function rf(t){return void 0!==t&&void 0!==t.enterprise}class of{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return ef(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}function af(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function cf(t){return 1e3*Number(t)}function lf(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return Pd("JWT malformed, contained fewer than 3 sections"),null;try{const t=T(n);return t?JSON.parse(t):(Pd("Failed to decode base64 JWT payload"),null)}catch(t){return Pd("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function hf(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof D&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class uf{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class df{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=af(this.lastLoginAt),this.creationTime=af(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ff(t){var e;const n=t.auth,i=await t.getIdToken(),s=await hf(t,async function(t,e){return Xd(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));Vd(null==s?void 0:s.users.length,n,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const o=(null===(e=r.providerUserInfo)||void 0===e?void 0:e.length)?r.providerUserInfo.map((t=>{var{providerId:e}=t,n=Dd(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,l=o,[...c.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var c,l;const h=t.isAnonymous,u=!(t.email&&r.passwordHash||(null==a?void 0:a.length)),d=!!h&&u,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new df(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class pf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Vd(t.idToken,"internal-error"),Vd(void 0!==t.idToken,"internal-error"),Vd(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=lf(t);return Vd(e,"internal-error"),Vd(void 0!==e.exp,"internal-error"),Vd(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return Vd(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(t,e){const n=await Yd(t,{},(async()=>{const n=M({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,r=tf(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Gd.fetch()(r,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:s}=e,r=new pf;return n&&(Vd("string"==typeof n,"internal-error",{appName:t}),r.refreshToken=n),i&&(Vd("string"==typeof i,"internal-error",{appName:t}),r.accessToken=i),s&&(Vd("number"==typeof s,"internal-error",{appName:t}),r.expirationTime=s),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new pf,this.toJSON())}_performRefresh(){return jd("not implemented")}}function gf(t,e){Vd("string"==typeof t||void 0===t,"internal-error",{appName:e})}class mf{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,s=Dd(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new uf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new df(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await hf(this,this.stsTokenManager.getToken(this.auth,t));return Vd(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=B(t),i=await n.getIdToken(e),s=lf(i);Vd(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const r="object"==typeof s.firebase?s.firebase:void 0,o=null==r?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:af(cf(s.auth_time)),issuedAtTime:af(cf(s.iat)),expirationTime:af(cf(s.exp)),signInProvider:o||null,signInSecondFactor:(null==r?void 0:r.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=B(t);await ff(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Vd(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new mf(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Vd(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await ff(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await hf(this,async function(t,e){return Xd(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,s,r,o,a,c,l;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,u=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(s=e.phoneNumber)&&void 0!==s?s:void 0,f=null!==(r=e.photoURL)&&void 0!==r?r:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,v=null!==(l=e.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:w,isAnonymous:b,providerData:_,stsTokenManager:E}=e;Vd(y&&E,t,"internal-error");const T=pf.fromJSON(this.name,E);Vd("string"==typeof y,t,"internal-error"),gf(h,t.name),gf(u,t.name),Vd("boolean"==typeof w,t,"internal-error"),Vd("boolean"==typeof b,t,"internal-error"),gf(d,t.name),gf(f,t.name),gf(p,t.name),gf(g,t.name),gf(m,t.name),gf(v,t.name);const I=new mf({uid:y,auth:t,email:u,emailVerified:w,displayName:h,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:v});return _&&Array.isArray(_)&&(I.providerData=_.map((t=>Object.assign({},t)))),g&&(I._redirectEventId=g),I}static async _fromIdTokenResponse(t,e,n=!1){const i=new pf;i.updateFromServerResponse(e);const s=new mf({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await ff(s),s}}const vf=new Map;function yf(t){Bd(t instanceof Function,"Expected a class definition");let e=vf.get(t);return e?(Bd(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,vf.set(t,e),e)}class wf{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}wf.type="NONE";const bf=wf;function _f(t,e,n){return`firebase:${t}:${e}:${n}`}class Ef{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=_f(this.userKey,i.apiKey,s),this.fullPersistenceKey=_f("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?mf._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Ef(yf(bf),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let s=i[0]||yf(bf);const r=_f(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(r);if(e){const i=mf._fromJSON(t,e);n!==s&&(o=i),s=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(r,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==s)try{await t._remove(r)}catch(t){}}))),new Ef(s,t,n)):new Ef(s,t,n)}}function Tf(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kf(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(If(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xf(e))return"Blackberry";if(Rf(e))return"Webos";if(Sf(e))return"Safari";if((e.includes("chrome/")||Cf(e))&&!e.includes("edge/"))return"Chrome";if(Af(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function If(t=x()){return/firefox\//i.test(t)}function Sf(t=x()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Cf(t=x()){return/crios\//i.test(t)}function kf(t=x()){return/iemobile/i.test(t)}function Af(t=x()){return/android/i.test(t)}function xf(t=x()){return/blackberry/i.test(t)}function Rf(t=x()){return/webos/i.test(t)}function Df(t=x()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Nf(t=x()){return Df(t)||Af(t)||Rf(t)||xf(t)||/windows phone/i.test(t)||kf(t)}function Lf(t,e=[]){let n;switch(t){case"Browser":n=Tf(x());break;case"Worker":n=`${Tf(x())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${xt}/${i}`}class Of{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class Pf{constructor(t){var e,n,i,s;const r=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=r.minPasswordLength)&&void 0!==e?e:6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),void 0!==r.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),void 0!==r.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),void 0!==r.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),void 0!==r.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(s=t.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,s,r,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsUppercaseLetter)||void 0===s||s),a.isValid&&(a.isValid=null===(r=a.containsNumericCharacter)||void 0===r||r),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}class Mf{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Uf(this),this.idTokenSubscription=new Uf(this),this.beforeStateQueue=new Of(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ld,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=yf(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Ef.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==r||!(null==o?void 0:o.user)||(i=o.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Vd(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await ff(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?B(t):null;return e&&Vd(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Vd(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(yf(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return Xd(t,"GET","/v2/passwordPolicy",Jd(t,e))}(this),e=new Pf(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new N("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return Xd(t,"POST","/v2/accounts:revokeToken",Jd(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&yf(t)||this._popupRedirectResolver;Vd(e,this,"argument-error"),this.redirectPersistenceManager=await Ef.create(this,[yf(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const s="function"==typeof e?e:e.next.bind(e);let r=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Vd(o,this,"internal-error"),o.then((()=>{r||s(this.currentUser)})),"function"==typeof e){const s=t.addObserver(e,n,i);return()=>{r=!0,s()}}{const n=t.addObserver(e);return()=>{r=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Vd(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Lf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){Od.logLevel<=G.WARN&&Od.warn(`Auth (${xt}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function Ff(t){return B(t)}class Uf{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new V(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return Vd(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Vf(t){return new Promise(((e,n)=>{const i=document.createElement("script");var s,r;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=Fd("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(r=null===(s=document.getElementsByTagName("head"))||void 0===s?void 0:s[0])&&void 0!==r?r:document).appendChild(i)}))}function jf(t){return`__${t}${Math.floor(1e6*Math.random())}`}class Bf{constructor(t){this.type="recaptcha-enterprise",this.auth=Ff(t)}async verify(t="verify",e=!1){function n(e,n,i){const s=window.grecaptcha;rf(s)?s.enterprise.ready((()=>{s.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{(async function(t,e){return Xd(t,"GET","/v2/recaptchaConfig",Jd(t,e))})(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new of(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((s=>{if(!e&&rf(window.grecaptcha))n(s,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));Vf("https://www.google.com/recaptcha/enterprise.js?render="+s).then((()=>{n(s,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function zf(t,e,n,i=!1){const s=new Bf(t);let r;try{r=await s.verify(n)}catch(t){r=await s.verify(n,!0)}const o=Object.assign({},e);return i?Object.assign(o,{captchaResp:r}):Object.assign(o,{captchaResponse:r}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function qf(t,e,n,i){var s;if(null===(s=t._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await zf(t,e,n,"getOobCode"===n);return i(t,s)}return i(t,e).catch((async s=>{if("auth/missing-recaptcha-token"===s.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await zf(t,e,n,"getOobCode"===n);return i(t,s)}return Promise.reject(s)}))}function $f(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Hf(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Kf{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return jd("not implemented")}_getIdTokenResponse(t){return jd("not implemented")}_linkToIdToken(t,e){return jd("not implemented")}_getReauthenticationResolver(t){return jd("not implemented")}}async function Gf(t,e){return Xd(t,"POST","/v1/accounts:signUp",e)}async function Wf(t,e){return Zd(t,"POST","/v1/accounts:signInWithPassword",Jd(t,e))}class Qf extends Kf{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Qf(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Qf(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return qf(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Wf);case"emailLink":return async function(t,e){return Zd(t,"POST","/v1/accounts:signInWithEmailLink",Jd(t,e))}(t,{email:this._email,oobCode:this._password});default:Md(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return qf(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Gf);case"emailLink":return async function(t,e){return Zd(t,"POST","/v1/accounts:signInWithEmailLink",Jd(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Md(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Jf(t,e){return Zd(t,"POST","/v1/accounts:signInWithIdp",Jd(t,e))}class Xf extends Kf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Xf(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Md("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,s=Dd(e,["providerId","signInMethod"]);if(!n||!i)return null;const r=new Xf(n,i);return r.idToken=s.idToken||void 0,r.accessToken=s.accessToken||void 0,r.secret=s.secret,r.nonce=s.nonce,r.pendingToken=s.pendingToken||null,r}_getIdTokenResponse(t){return Jf(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Jf(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Jf(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=M(e)}return t}}const Yf={USER_NOT_FOUND:"user-not-found"};class Zf extends Kf{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Zf({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Zf({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Zd(t,"POST","/v1/accounts:signInWithPhoneNumber",Jd(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Zd(t,"POST","/v1/accounts:signInWithPhoneNumber",Jd(t,e));if(n.temporaryProof)throw sf(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Zd(t,"POST","/v1/accounts:signInWithPhoneNumber",Jd(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Yf)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}=t;return n||e||i||s?new Zf({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}):null}}class tp{constructor(t){var e,n,i,s,r,o;const a=F(U(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Vd(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(s=a.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(r=a.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=F(U(t)).link,n=e?F(U(e)).deep_link_id:null,i=F(U(t)).deep_link_id;return(i?F(U(i)).link:null)||i||n||e||t}(t);try{return new tp(e)}catch(t){return null}}}class ep{constructor(){this.providerId=ep.PROVIDER_ID}static credential(t,e){return Qf._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=tp.parseLink(e);return Vd(n,"argument-error"),Qf._fromEmailAndCode(t,n.code,n.tenantId)}}ep.PROVIDER_ID="password",ep.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ep.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class np{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class ip extends np{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class sp extends ip{constructor(){super("facebook.com")}static credential(t){return Xf._fromParams({providerId:sp.PROVIDER_ID,signInMethod:sp.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return sp.credentialFromTaggedObject(t)}static credentialFromError(t){return sp.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return sp.credential(t.oauthAccessToken)}catch(t){return null}}}sp.FACEBOOK_SIGN_IN_METHOD="facebook.com",sp.PROVIDER_ID="facebook.com";class rp extends ip{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Xf._fromParams({providerId:rp.PROVIDER_ID,signInMethod:rp.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return rp.credentialFromTaggedObject(t)}static credentialFromError(t){return rp.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return rp.credential(e,n)}catch(t){return null}}}rp.GOOGLE_SIGN_IN_METHOD="google.com",rp.PROVIDER_ID="google.com";class op extends ip{constructor(){super("github.com")}static credential(t){return Xf._fromParams({providerId:op.PROVIDER_ID,signInMethod:op.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return op.credentialFromTaggedObject(t)}static credentialFromError(t){return op.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return op.credential(t.oauthAccessToken)}catch(t){return null}}}op.GITHUB_SIGN_IN_METHOD="github.com",op.PROVIDER_ID="github.com";class ap extends ip{constructor(){super("twitter.com")}static credential(t,e){return Xf._fromParams({providerId:ap.PROVIDER_ID,signInMethod:ap.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return ap.credentialFromTaggedObject(t)}static credentialFromError(t){return ap.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return ap.credential(e,n)}catch(t){return null}}}async function cp(t,e){return Zd(t,"POST","/v1/accounts:signUp",Jd(t,e))}ap.TWITTER_SIGN_IN_METHOD="twitter.com",ap.PROVIDER_ID="twitter.com";class lp{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const s=await mf._fromIdTokenResponse(t,n,i),r=hp(n);return new lp({user:s,providerId:r,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=hp(n);return new lp({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function hp(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class up extends D{constructor(t,e,n,i){var s;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,up.prototype),this.customData={appName:t.name,tenantId:null!==(s=t.tenantId)&&void 0!==s?s:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new up(t,e,n,i)}}function dp(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw up._fromErrorAndOperation(t,n,e,i);throw n}))}new WeakMap;const fp="__sak";class pp{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(fp,"1"),this.storage.removeItem(fp),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class gp extends pp{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=x();return Sf(t)||Df(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Nf(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},s=this.storage.getItem(n);!function(){const t=x();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||s===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}gp.type="LOCAL";const mp=gp;class vp extends pp{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}vp.type="SESSION";const yp=vp;class wp{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new wp(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:s}=e.data,r=this.handlersMap[i];if(!(null==r?void 0:r.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(r).map((async t=>t(e.origin,s))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function bp(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}wp.receivers=[];class _p{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,r;return new Promise(((o,a)=>{const c=bp("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(e.data.response);break;default:clearTimeout(l),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function Ep(){return window}function Tp(){return void 0!==Ep().WorkerGlobalScope&&"function"==typeof Ep().importScripts}const Ip="firebaseLocalStorageDb",Sp="firebaseLocalStorage",Cp="fbase_key";class kp{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function Ap(t,e){return t.transaction([Sp],e?"readwrite":"readonly").objectStore(Sp)}function xp(){const t=indexedDB.open(Ip,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Sp,{keyPath:Cp})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Sp)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Ip);return new kp(t).toPromise()}(),e(await xp()))}))}))}async function Rp(t,e,n){const i=Ap(t,!0).put({[Cp]:e,value:n});return new kp(i).toPromise()}function Dp(t,e){const n=Ap(t,!0).delete(e);return new kp(n).toPromise()}class Np{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await xp()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Tp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wp._getInstance(Tp()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new _p(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await xp();return await Rp(t,fp,"1"),await Dp(t,fp),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Rp(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=Ap(t,!1).get(e),i=await new kp(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Dp(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=Ap(t,!1).getAll();return new kp(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Np.type="LOCAL";const Lp=Np;jf("rcb"),new Hd(3e4,6e4);class Op{constructor(t){this.providerId=Op.PROVIDER_ID,this.auth=Ff(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const s=await n.verify();try{let r;if(Vd("string"==typeof s,t,"argument-error"),Vd("recaptcha"===n.type,t,"argument-error"),r="string"==typeof e?{phoneNumber:e}:e,"session"in r){const e=r.session;if("phoneNumber"in r){Vd("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Xd(t,"POST","/v2/accounts/mfaEnrollment:start",Jd(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,recaptchaToken:s}});return n.phoneSessionInfo.sessionInfo}{Vd("signin"===e.type,t,"internal-error");const n=(null===(i=r.multiFactorHint)||void 0===i?void 0:i.uid)||r.multiFactorUid;Vd(n,t,"missing-multi-factor-info");const o=await function(t,e){return Xd(t,"POST","/v2/accounts/mfaSignIn:start",Jd(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:s}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Xd(t,"POST","/v1/accounts:sendVerificationCode",Jd(t,e))}(t,{phoneNumber:r.phoneNumber,recaptchaToken:s});return e}}finally{n._reset()}}(this.auth,t,B(e))}static credential(t,e){return Zf._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Op.credentialFromTaggedObject(e)}static credentialFromError(t){return Op.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Zf._fromTokenResponse(e,n):null}}Op.PROVIDER_ID="phone",Op.PHONE_SIGN_IN_METHOD="phone";class Pp extends Kf{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Jf(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Jf(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Jf(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Mp(t){return async function(t,e,n=!1){const i="signIn",s=await dp(t,i,e),r=await lp._fromIdTokenResponse(t,i,s);return n||await t._updateCurrentUser(r.user),r}(t.auth,new Pp(t),t.bypassAuthState)}function Fp(t){const{auth:e,user:n}=t;return Vd(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,s="reauthenticate";try{const r=await hf(t,dp(i,s,e,t),n);Vd(r.idToken,i,"internal-error");const o=lf(r.idToken);Vd(o,i,"internal-error");const{sub:a}=o;return Vd(t.uid===a,i,"user-mismatch"),lp._forOperation(t,s,r)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Md(i,"user-mismatch"),t}}(n,new Pp(t),t.bypassAuthState)}async function Up(t){const{auth:e,user:n}=t;return Vd(n,e,"internal-error"),async function(t,e,n=!1){const i=await hf(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return lp._forOperation(t,"link",i)}(n,new Pp(t),t.bypassAuthState)}class Vp{constructor(t,e,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:s,error:r,type:o}=t;if(r)return void this.reject(r);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Mp;case"linkViaPopup":case"linkViaRedirect":return Up;case"reauthViaPopup":case"reauthViaRedirect":return Fp;default:Md(this.auth,"internal-error")}}resolve(t){Bd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Bd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jp=new Hd(2e3,1e4);class Bp extends Vp{constructor(t,e,n,i,s){super(t,e,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Bp.currentPopupAction&&Bp.currentPopupAction.cancel(),Bp.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Vd(t,this.auth,"internal-error"),t}async onExecution(){Bd(1===this.filter.length,"Popup operations only handle one event");const t=bp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Fd(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Fd(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bp.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Fd(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,jp.get())};t()}}Bp.currentPopupAction=null;const zp="pendingRedirect",qp=new Map;class $p extends Vp{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=qp.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return _f(zp,t.config.apiKey,t.name)}(e),i=function(t){return yf(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const s="true"===await i._get(n);return await i._remove(n),s}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}qp.set(this.auth._key(),t)}return this.bypassAuthState||qp.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Hp(t,e){qp.set(t._key(),e)}async function Kp(t,e,n=!1){const i=Ff(t),s=function(t,e){return e?yf(e):(Vd(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),r=new $p(i,s,n),o=await r.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class Gp{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qp(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Qp(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Fd(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Wp(t))}saveEventToCache(t){this.cachedEventUids.add(Wp(t)),this.lastProcessedEventTime=Date.now()}}function Wp(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Qp({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const Jp=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xp=/^https?/;function Yp(t){const e=zd(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return""===s.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===i}if(!Xp.test(n))return!1;if(Jp.test(t))return i===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const Zp=new Hd(3e4,6e4);function tg(){const t=Ep().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let eg=null;function ng(t){return eg=eg||function(t){return new Promise(((e,n)=>{var i,s,r;function o(){tg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tg(),n(Fd(t,"network-request-failed"))},timeout:Zp.get()})}if(null===(s=null===(i=Ep().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)e(gapi.iframes.getContext());else{if(!(null===(r=Ep().gapi)||void 0===r?void 0:r.load)){const e=jf("iframefcb");return Ep()[e]=()=>{gapi.load?o():n(Fd(t,"network-request-failed"))},Vf(`https://apis.google.com/js/api.js?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw eg=null,t}))}(t),eg}const ig=new Hd(5e3,15e3),sg={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rg=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function og(t){const e=t.config;Vd(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Kd(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:xt},s=rg.get(t.config.apiHost);s&&(i.eid=s);const r=t._getFrameworks();return r.length&&(i.fw=r.join(",")),`${n}?${M(i).slice(1)}`}const ag={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class cg{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const lg=encodeURIComponent("fac");async function hg(t,e,n,i,s,r){Vd(t.config.authDomain,t,"auth-domain-config-required"),Vd(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:xt,eventId:s};if(e instanceof np){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(r||{}))o[t]=e}if(e instanceof ip){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const c=await t._getAppCheckToken(),l=c?`#${lg}=${encodeURIComponent(c)}`:"";return`${function({config:t}){return t.emulator?Kd(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${M(a).slice(1)}${l}`}const ug="webStorageSupport",dg=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yp,this._completeRedirectFn=Kp,this._overrideRedirectResult=Hp}async _openPopup(t,e,n,i){var s;return Bd(null===(s=this.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,s=600){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},ag),{width:i.toString(),height:s.toString(),top:r,left:o}),l=x().toLowerCase();n&&(a=Cf(l)?"_blank":n),If(l)&&(e=e||"http://localhost",c.scrollbars="yes");const h=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=x()){var e;return Df(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",a),new cg(null);const u=window.open(e||"",a,h);Vd(u,t,"popup-blocked");try{u.focus()}catch(t){}return new cg(u)}(t,await hg(t,e,n,zd(),i),bp())}async _openRedirect(t,e,n,i){return await this._originValidation(t),s=await hg(t,e,n,zd(),i),Ep().location.href=s,new Promise((()=>{}));var s}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(Bd(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await ng(t),n=Ep().gapi;return Vd(n,t,"internal-error"),e.open({where:document.body,url:og(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sg,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const s=Fd(t,"network-request-failed"),r=Ep().setTimeout((()=>{i(s)}),ig.get());function o(){Ep().clearTimeout(r),n(e)}e.ping(o).then(o,(()=>{i(s)}))}))))}(t),n=new Gp(t);return e.register("authEvent",(e=>(Vd(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(ug,{type:ug},(n=>{var i;const s=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[ug];void 0!==s&&e(!!s),Md(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Xd(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Yp(t))return}catch(t){}Md(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Nf()||Sf()||Df()}};var fg="@firebase/auth",pg="1.5.1";class gg{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Vd(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const mg=k("authIdTokenMaxAge")||300;let vg=null;var yg;yg="Browser",St(new z("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:r,authDomain:o}=n.options;Vd(r&&!r.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:r,authDomain:o,clientPlatform:yg,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Lf(yg)},c=new Mf(n,i,s,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(yf);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(c,e),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),St(new z("auth-internal",(t=>(t=>new gg(t))(Ff(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Nt(fg,pg,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(yg)),Nt(fg,pg,"esm2017");var wg=function(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const bg=Rt({apiKey:"AIzaSyAS_sGDbQYUNZAoF-ZqZcpjWtLQtBmDvsw",authDomain:"proyecto-dca-1b72d.firebaseapp.com",projectId:"proyecto-dca-1b72d",storageBucket:"proyecto-dca-1b72d.appspot.com",messagingSenderId:"272880735350",appId:"1:272880735350:web:f0dbcec16d1c028a4afb57",measurementId:"G-L13XCXHTB8"}),_g=function(t,e){const n="string"==typeof t?t:"(default)",i=Ct("object"==typeof t?t:Dt(),"firestore").getImmediate({identifier:n});if(!i._initialized){const t=(t=>{const e=S("firestore");if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]})();t&&function(t,e,n,i={}){var s;const r=(t=Fu(t,Vu))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==r.host&&r.host!==o&&mr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=hr.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[E(JSON.stringify({alg:"none",type:"JWT"})),E(JSON.stringify(r)),""].join(".")}(i.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const r=i.mockUserToken.sub||i.mockUserToken.user_id;if(!r)throw new Er(_r.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new hr(r)}t._authCredentials=new Cr(new Ir(e,n))}}(i,...t)}return i}(bg),Eg=function(t=Dt()){const e=Ct(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=Ct(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(O(n.getOptions(),null!=e?e:{}))return t;Md(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:dg,persistence:[Lp,mp,yp]}),i=k("authTokenSyncURL");if(i){const t=(s=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>mg)return;const i=null==e?void 0:e.token;vg!==i&&(vg=i,await fetch(s,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){B(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,s){B(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var s;const r=S("auth");return r&&function(t,e,n){const i=Ff(t);Vd(i._canInitEmulator,i,"emulator-config-failed"),Vd(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(null==n?void 0:n.disableWarnings),r=$f(e),{host:o,port:a}=function(t){const e=$f(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const t=s[1];return{host:t,port:Hf(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:Hf(e)}}}(e),c=null===a?"":`:${a}`;i.config.emulator={url:`${r}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${r}`),n}(bg),Tg=t=>{(async function(t,e,n){const i=Ff(t),s=qf(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cp),r=await s.catch((e=>{throw"auth/password-does-not-meet-requirements"===e.code&&async function(t){const e=Ff(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}(t),e})),o=await lp._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(o.user),o})(Eg,t.email,t.password).then((e=>wg(void 0,void 0,void 0,(function*(){const n=e.user;console.log(n.uid);try{const e=$u(_g,"users",n.uid),i={id:n.uid,username:t.username};console.log(i),yield function(t,e,n){t=Fu(t,Bu);const i=Fu(t.firestore,Ku),s=_d(t.converter,e,n);return Rd(i,[od(rd(i),"setDoc",t._key,s,null!==t.converter,n).toMutation(t._key,oc.none())])}(e,i),alert("Se creó el usuario")}catch(t){console.error(t)}})))).catch((t=>{const e=t.code,n=t.message;console.error(e,n)}))},Ig=t=>wg(void 0,void 0,void 0,(function*(){const e=$u(_g,"users","e14Adty5xAvKNl0ceGnc");yield function(t,e,n,...i){t=Fu(t,Bu);const s=Fu(t.firestore,Ku),r=rd(s);let o;return o="string"==typeof(e=B(e))||e instanceof Ju?function(t,e,n,i,s,r){const o=t.Su(1,e,n),a=[dd(e,i,n)],c=[s];if(r.length%2!=0)throw new Er(_r.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<r.length;t+=2)a.push(dd(e,r[t])),c.push(r[t+1]);const l=[],h=$o.empty();for(let t=a.length-1;t>=0;--t)if(!md(l,a[t])){const e=a[t];let n=c[t];n=B(n);const i=o.fu(e);if(n instanceof ad)l.push(e);else{const t=cd(n,i);null!=t&&(l.push(e),h.set(e,t))}}const u=new vo(l);return new ed(h,u,o.fieldTransforms)}(r,"updateDoc",t._key,e,n,i):function(t,e,n,i){const s=t.Su(1,e,n);ud("Data must be an object, but it was:",s,i);const r=[],o=$o.empty();lo(i,((t,i)=>{const a=pd(e,t,n);i=B(i);const c=s.fu(a);if(i instanceof ad)r.push(a);else{const t=cd(i,c);null!=t&&(r.push(a),o.set(a,t))}}));const a=new vo(r);return new ed(o,a,s.fieldTransforms)}(r,"updateDoc",t._key,e),Rd(s,[o.toMutation(t._key,oc.exists(!0))])}(e,{fav_song:t})}));var Sg=n(9);const Cg={wave:""};class kg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){this.render()}render(){var e,n,i,s;if(this.shadowRoot){u.forEach((t=>{var e;const n=document.createElement("my-header");n.setAttribute(d.logo,t.logo),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const r=this.ownerDocument.createElement("h1");r.textContent="Share your wave!",null===(e=this.shadowRoot)||void 0===e||e.appendChild(r);const o=this.ownerDocument.createElement("input");o.placeholder="Enter your Wave",o.classList.add("image"),o.addEventListener("change",this.changeWave),this.shadowRoot.appendChild(o);const a=this.ownerDocument.createElement("button");a.innerText="Share",a.classList.add("save"),a.addEventListener("click",this.submitForm.bind(this)),null===(n=this.shadowRoot)||void 0===n||n.appendChild(a);const c=this.ownerDocument.createElement("h2");c.textContent="For You",null===(i=this.shadowRoot)||void 0===i||i.appendChild(c),JSON.parse(localStorage.getItem("savedWaves")||"[]").forEach((t=>{g.forEach((e=>{var n;const i=document.createElement("my-card");i.setAttribute(m.name,e.name),i.setAttribute(m.image,e.image),i.setAttribute(m.unlike,e.unlike),i.setAttribute(m.like,e.like),i.setAttribute(m.cantidadlike,e.cantidadlike),i.setAttribute(m.share,e.share),i.setAttribute(m.cantidadshare,e.cantidadshare),i.setAttribute(m.comentar,e.comentar),i.setAttribute(m.cantidadcomentar,e.cantidadcomentar),i.setAttribute(m.wave,t),null===(n=this.shadowRoot)||void 0===n||n.appendChild(i)}))})),t.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(l.iconohome,t.iconohome),n.setAttribute(l.iconoexplore,t.iconoexplore),n.setAttribute(l.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const h=this.ownerDocument.createElement("style");h.innerHTML=Sg.A,null===(s=this.shadowRoot)||void 0===s||s.appendChild(h)}}restoreSavedWaves(){var t;const e=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".wave");JSON.parse(localStorage.getItem("savedWaves")||"[]").forEach((t=>{const n=document.createElement("p");n.textContent=t,null==e||e.appendChild(n)}))}submitForm(){var t,e,n;const i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".image"),s=i.value;var r;Cg.wave=s,console.log(Cg),r=Cg,wg(void 0,void 0,void 0,(function*(){try{const t=qu(_g,"waves");yield xd(t,r),console.log("se añadió con éxito")}catch(t){console.error(t)}})),i.value="";const o=document.createElement("p");o.textContent=s,i.nextSibling?null===(e=this.shadowRoot)||void 0===e||e.insertBefore(o,i.nextSibling):null===(n=this.shadowRoot)||void 0===n||n.appendChild(o),this.saveWaveToLocalStorage(s)}saveWaveToLocalStorage(t){const e=JSON.parse(localStorage.getItem("savedWaves")||"[]");e.push(t),localStorage.setItem("savedWaves",JSON.stringify(e))}changeWave(t){Cg.wave=t.target.value}}customElements.define("app-dashboard",kg);const Ag=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg",log_out:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1e1e1e" d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/></svg>'}];var xg;!function(t){t.uid="uid",t.logo="logo",t.log_out="log_out"}(xg||(xg={}));class Rg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,logo:null,log_out:null})}attributeChangedCallback(t,e,n){t===xg.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t,e,n;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n    <section class="header">\n\t\t<section class="logo">\n    <img src='${this.logo}'></img>\n\t\t</section>\n\n\t\t<svg class="log_out" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1e1e1e" d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/></svg>\n    </section>`);const i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".logo");null==i||i.addEventListener("click",(()=>{o(c("HOME"))}));const s=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".log_out");null==s||s.addEventListener("click",(()=>{o(c("REGISTER"))}));const r=this.ownerDocument.createElement("style");r.innerHTML=f.A,null===(n=this.shadowRoot)||void 0===n||n.appendChild(r)}}customElements.define("my-headerprofile",Rg);const Dg=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1E1E1E" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'"https://i.pinimg.com/originals/94/67/f5/9467f504e83345d60816f9b87ac84588.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#ff9f1c" d="M399 384.2C376.9 345.8 335.4 320 288 320H224c-47.4 0-88.9 25.8-111 64.2c35.2 39.2 86.2 63.8 143 63.8s107.8-24.7 143-63.8zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 16a72 72 0 1 0 0-144 72 72 0 1 0 0 144z"/></svg>'}];var Ng,Lg=n(831);!function(t){t.profile_image="profile_image",t.username="username",t.fav_song="fav_song",t.name="name",t.followers="followers",t.following="following"}(Ng||(Ng={}));class Og extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({profile_image:null,username:null,fav_song:null,name:null,followers:null,following:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}render(){var t,e,n,i,s;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t<section class="todo">\n\t\t<section class="profile">\n    <img class="image" src="${this.profile_image}"></img>\n    <h1>${this.username}</h1>\n\t\t<Button class="edit">Edit picture</Button>\n\n    <button id="ButtonSong">\n\t\t<p class="fav_song"><svg class="pin"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgb(46, 196, 182);transform: ;msFilter:;"><path d="M15 11.586V6h2V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2h2v5.586l-2.707 1.707A.996.996 0 0 0 6 14v2a1 1 0 0 0 1 1h4v3l1 2 1-2v-3h4a1 1 0 0 0 1-1v-2a.996.996 0 0 0-.293-.707L15 11.586z"></path></svg></svg>\n\t\t${this.fav_song}</p>\n    </section>\n\n\t\t<section class="name-following">\n    <p class="name">${this.name}</p>\n\t\t<p class="following">${this.following}</p>\n\t\t</section>\n\n    <p class="followers">${this.followers}</p>\n    <Button class="playlist">Playlists</Button>\n\t\t</section>\n\t\t</section>\n\n\n\t\t<section class="modalContainer" style="display:none;">\n    <form class="waveSong">\n        <span class="close">X</span>\n        <h2>What's your wave song at the moment?</h2>\n        <textarea id="writtenSong" name="wave"></textarea>\n        <span role="button" class="post">Post</span>\n    </form>\n    `);const r=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".modalContainer"),o=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#ButtonSong"),a=null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector(".close");(null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector(".post")).addEventListener("click",(()=>function(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){var t;const e=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#writtenSong"),n=e.value;Ig(n),e.value="",r.style.display="none",document.body.style.overflow="auto"}))));const c=document.body;c&&(o.addEventListener("click",(()=>{r.style.display="block",c.style.overflow="hidden"})),a.addEventListener("click",(()=>{var t;r.style.display="none",c.style.overflow="auto",window.addEventListener("click",(t=>{t.target==r&&(r.style.display="none",c.style.overflow="auto")})),(null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".post")).addEventListener("click",(t=>{var e;t.preventDefault();const n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#writtenSong"),i=n.value;console.log("Entered wave:",i),n.value="",r.style.display="none",c.style.overflow="auto"}))})));const l=this.ownerDocument.createElement("style");l.innerHTML=Lg.A,null===(s=this.shadowRoot)||void 0===s||s.appendChild(l)}}customElements.define("my-perfil",Og);var Pg,Mg=n(471);!function(t){t.artist="artist",t.song_title="song_title",t.image="image",t.top="top"}(Pg||(Pg={}));class Fg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({artist:null,song_title:null,image:null,top:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}render(){var t;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t<section class = "card">\n\n\n\t\t\t<p class="top">${this.top}</p>\n\n\t\t\t<section class= "imagen">\n\t\t\t<img src="${this.image}" alt= "cover album"></img>\n\t\t\t</section>\n\n\t\t\t<section class = "letters">\n\n\t\t\t<section class = "title">\n\t\t\t<p>${this.song_title}</p>\n\t\t\t</section>\n\n\t\t<section class = "artist">\n\t\t<p>${this.artist}</p>\n\t\t</section>\n\n\n\t\t</section>\n\n\t\t</section>\n    `);const e=this.ownerDocument.createElement("style");e.innerHTML=Mg.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}}customElements.define("my-songs",Fg);var Ug=n(11),Vg=function(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const jg={top:"",artist:"",song_title:"",image:"",duration:""};class Bg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){return Vg(this,void 0,void 0,(function*(){const t=yield wg(void 0,void 0,void 0,(function*(){const t=[];return(yield Ad(qu(_g,"users"))).forEach((e=>{t.push(e.data())})),t}));this.render(t)}))}submitForm(){var t;console.log(jg),t=jg,wg(void 0,void 0,void 0,(function*(){try{const e=qu(_g,"playlist");yield xd(e,t),console.log("se añadió con éxito")}catch(t){console.error(t)}}))}changeArtist(t){jg.artist=t.target.value}changeTitle(t){jg.song_title=t.target.value}changeImage(t){jg.image=t.target.value}render(t){return Vg(this,void 0,void 0,(function*(){var e,n,i,s;this.shadowRoot&&Ag.forEach((t=>{var e;const n=document.createElement("my-headerprofile");n.setAttribute(xg.logo,t.logo),n.setAttribute(xg.log_out,t.log_out),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)})),t.forEach((t=>{var e;const n=document.createElement("my-perfil");n.setAttribute(Ng.profile_image,t.profile_image),n.setAttribute(Ng.username,t.username),n.setAttribute(Ng.name,t.name),n.setAttribute(Ng.fav_song,t.fav_song),n.setAttribute(Ng.followers,t.followers),n.setAttribute(Ng.following,t.following),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const r=this.ownerDocument.createElement("h1");r.textContent="Add your own song",r.classList.add("h1Add"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(r);const o=this.ownerDocument.createElement("section");o.classList.add("create-song");const a=this.ownerDocument.createElement("input");a.placeholder="Add an artist",a.classList.add("artist"),a.addEventListener("change",this.changeArtist),o.appendChild(a);const c=this.ownerDocument.createElement("input");c.placeholder="Add the song title",c.classList.add("title"),c.addEventListener("change",this.changeTitle),o.appendChild(c);const h=this.ownerDocument.createElement("input");h.placeholder="Add the album cover",h.classList.add("image"),h.addEventListener("change",this.changeImage),o.appendChild(h),null===(n=this.shadowRoot)||void 0===n||n.appendChild(o);const u=this.ownerDocument.createElement("button");u.innerText="Save",u.classList.add("save"),u.addEventListener("click",this.submitForm),null===(i=this.shadowRoot)||void 0===i||i.appendChild(u),(yield wg(void 0,void 0,void 0,(function*(){const t=yield Ad(qu(_g,"playlist")),e=[];return t.forEach((t=>{const n=t.data();e.push(Object.assign({id:t.id},n))})),e}))).forEach((t=>{var e;const n=this.ownerDocument.createElement("my-songs");n.setAttribute(Pg.top,"●"),n.setAttribute(Pg.image,t.image),n.setAttribute(Pg.artist,t.artist),n.setAttribute(Pg.song_title,t.song_title),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)})),Dg.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(l.iconohome,t.iconohome),n.setAttribute(l.iconoexplore,t.iconoexplore),n.setAttribute(l.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const d=this.ownerDocument.createElement("style");d.innerHTML=Ug.A,null===(s=this.shadowRoot)||void 0===s||s.appendChild(d)}))}}customElements.define("app-perfil",Bg);var zg,qg=n(499);!function(t){t.uid="uid",t.name="name",t.photo="photo",t.profile="profile",t.song="song"}(zg||(zg={}));class $g extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,photo:null,name:null,profile:null,song:null})}attributeChangedCallback(t,e,n){t===zg.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\n\t\t<section class="card" style="background-image: url('${this.photo}');background-position-x: center;background-size: cover;">\n\t\t<section class="todo">\n\t\t<section class= "image">\n\t\t<img src='${this.profile}'></img>\n    <p>${this.name}</p>\n\t\t</section>\n\t\t<section class="song">\n    <h3>${this.song}</h3>\n\t\t</section>\n\t\t</section>\n\t\t</section>\n\t\t`);const e=this.ownerDocument.createElement("style");e.innerHTML=qg.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}}customElements.define("my-friend",$g);const Hg=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1E1E1E" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'\t"https://i.pinimg.com/originals/33/ff/00/33ff00839226a94f68b571016bc6d99c.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgb(32, 32, 32);transform: ;msFilter:;"><path d="M12 2C6.579 2 2 6.579 2 12s4.579 10 10 10 10-4.579 10-10S17.421 2 12 2zm0 5c1.727 0 3 1.272 3 3s-1.273 3-3 3c-1.726 0-3-1.272-3-3s1.274-3 3-3zm-5.106 9.772c.897-1.32 2.393-2.2 4.106-2.2h2c1.714 0 3.209.88 4.106 2.2C15.828 18.14 14.015 19 12 19s-3.828-.86-5.106-2.228z"></path></svg>'}];var Kg=n(628);class Gg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){return function(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){const t=yield wg(void 0,void 0,void 0,(function*(){const t=[];return(yield Ad(qu(_g,"Friends-playlist"))).forEach((e=>{t.push(e.data())})),t})),e=yield wg(void 0,void 0,void 0,(function*(){const t=[];return(yield Ad(qu(_g,"Songs"))).forEach((e=>{t.push(e.data())})),t}));console.log(t,e),this.render(t,e)}))}render(t,e){var n,i,s,r;this.shadowRoot&&u.forEach((t=>{var e;const n=document.createElement("my-header");n.setAttribute(d.logo,t.logo),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)})),Hg.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(l.iconohome,t.iconohome),n.setAttribute(l.iconoexplore,t.iconoexplore),n.setAttribute(l.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const o=this.ownerDocument.createElement("h1");o.textContent="On trending",null===(n=this.shadowRoot)||void 0===n||n.appendChild(o),e.forEach(((t,e)=>{var n;const i=document.createElement("my-songs");i.setAttribute(Pg.top,t.top),i.setAttribute(Pg.song_title,t.song_title),i.setAttribute(Pg.artist,t.artist),i.setAttribute(Pg.image,t.image),i.setAttribute("data-index",(e+1).toString()),null===(n=this.shadowRoot)||void 0===n||n.appendChild(i)}));const a=this.ownerDocument.createElement("h1");a.textContent="My friends playlist",null===(i=this.shadowRoot)||void 0===i||i.appendChild(a);const c=this.ownerDocument.createElement("section");c.classList.add("playlists"),t.forEach((t=>{const e=document.createElement("my-friend");console.log(t),e.setAttribute(zg.name,t.name),e.setAttribute(zg.profile,t.profile),e.setAttribute(zg.photo,t.photo),e.setAttribute(zg.song,t.song),c.appendChild(e)})),null===(s=this.shadowRoot)||void 0===s||s.appendChild(c);const h=this.ownerDocument.createElement("style");h.innerHTML=Kg.A,null===(r=this.shadowRoot)||void 0===r||r.appendChild(h)}}customElements.define("app-explore",Gg);var Wg=n(835);const Qg={email:"",username:"",password:""};var Jg;!function(t){t.logo="logo",t.google="google",t.facebook="facebook",t.outlook="outlook"}(Jg||(Jg={}));class Xg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({logo:null,google:null,facebook:null,outlook:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render(),console.log(Qg)}changeEmail(t){var e;Qg.email=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value,console.log(Qg.email)}changePassword(t){var e;Qg.password=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value,console.log(Qg.password)}changeUsername(t){var e;Qg.username=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value,console.log(Qg.username)}submitForm(){Tg(Qg)}render(){if(this.shadowRoot){const t=this.ownerDocument.createElement("section");t.classList.add("todo");const e=this.ownerDocument.createElementNS("http://www.w3.org/2000/svg","svg");e.classList.add("svg"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("height","35"),e.setAttribute("width","35"),e.setAttribute("viewBox","0 0 320 512"),e.innerHTML='\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec4b6" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/>',t.appendChild(e);const n=this.ownerDocument.createElement("img");n.classList.add("logo"),n.src=this.logo||"undefined",t.appendChild(n);const i=this.ownerDocument.createElement("section");i.classList.add("info");const s=this.ownerDocument.createElement("h1");s.classList.add("text_create"),s.textContent="Create your account",i.appendChild(s),t.appendChild(i),this.shadowRoot.appendChild(t);const r=this.ownerDocument.createElement("section");r.classList.add("inputs");const a=this.ownerDocument.createElement("input");a.placeholder="Correo electronico",a.addEventListener("change",this.changeEmail),r.appendChild(a);const l=this.ownerDocument.createElement("input");l.placeholder="Edad",l.addEventListener("change",this.changeUsername),r.appendChild(l);const h=this.ownerDocument.createElement("input");h.placeholder="Contraseña",h.addEventListener("change",this.changePassword),r.appendChild(h);const u=this.ownerDocument.createElement("button");u.innerText="Registrarme",u.addEventListener("click",this.submitForm),r.appendChild(u),this.shadowRoot.appendChild(r);const d=this.ownerDocument.createElement("section");d.classList.add("todo");const f=this.ownerDocument.createElement("p");f.classList.add("text"),f.textContent="Or sign up with",d.appendChild(f);const p=this.ownerDocument.createElement("section");p.id="apps";const g=this.ownerDocument.createElement("img");g.classList.add("google"),g.src=this.google||"undefined",p.appendChild(g);const m=this.ownerDocument.createElement("img");m.classList.add("facebook"),m.src=this.facebook||"undefined",p.appendChild(m);const v=this.ownerDocument.createElement("img");v.classList.add("outlook"),v.src=this.outlook||"undefined",p.appendChild(v),d.appendChild(p);const y=this.ownerDocument.createElement("section");y.classList.add("already_have");const w=this.ownerDocument.createElement("p");w.classList.add("text"),w.textContent="Already have an account?",y.appendChild(w);const b=this.ownerDocument.createElement("p");b.classList.add("signup_btn"),b.textContent="Log In",y.appendChild(b),d.appendChild(y),this.shadowRoot.appendChild(d),e.addEventListener("click",(()=>{o(c("PROFILE"))})),b.addEventListener("click",(()=>{o(c("LOGIN"))}));const _=this.ownerDocument.createElement("style");_.innerHTML=Wg.A,this.shadowRoot.appendChild(_)}}}customElements.define("my-register",Xg);const Yg=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg",google:"https://cdn1.iconfinder.com/data/icons/google-s-logo/150/Google_Icons-09-512.png",facebook:"https://upload.wikimedia.org/wikipedia/commons/6/6c/Facebook_Logo_2023.png",outlook:"https://seeklogo.com/images/M/microsoft-outlook-logo-188AB32C94-seeklogo.com.png"}];class Zg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){this.render()}render(){this.shadowRoot&&Yg.forEach((t=>{var e;const n=document.createElement("my-register");n.setAttribute(Jg.logo,t.logo),n.setAttribute(Jg.google,t.google),n.setAttribute(Jg.facebook,t.facebook),n.setAttribute(Jg.outlook,t.outlook),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}))}}var tm;customElements.define("app-register",Zg),function(t){t.logo="logo",t.google="google",t.facebook="facebook",t.outlook="outlook"}(tm||(tm={}));class em extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({logo:null,google:null,facebook:null,outlook:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}render(){var t,e,n;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n      <section class="todo">\n\n      <svg class="svg" xmlns="http://www.w3.org/2000/svg" height="35" width="35" viewBox="0 0 320 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec4b6" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>\n\n      <img class="logo" src="${this.logo}"></img>\n\n      <section class="info">\n\t\t\t<h1 class="text_create">Log in to your account</h1>\n\n      <section class="inputs">\n\t\t\t<form>\n\t\t\t<input type="Email" placeholder="Email or Username"></input>\n\t\t\t<input type="Password" placeholder="Password"></input>\n      </section>\n\t\t\t<button type="submit">Sign In</button>\n\t\t\t</form>\n      </section>\n\t\t\t<p class="text">Or sign in with</p>\n\n      <section id="apps">\n      <img class="google" src="${this.google}"></img>\n      <img class="facebook" src="${this.facebook}"></img>\n      <img class="outlook" src="${this.outlook}"></img>\n      </section>\n      <section class="already_have">\n      <p class="text">Don't have an account?</p>\n      <p class="signup_btn" >Sign Up</p>\n      </section>\n      </section>\n    `);const i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".svg");null==i||i.addEventListener("click",(()=>{o(c("PROFILE"))}));const s=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".signup_btn");null==s||s.addEventListener("click",(()=>{o(c("REGISTER"))}));const r=this.ownerDocument.createElement("style");r.innerHTML=Wg.A,null===(n=this.shadowRoot)||void 0===n||n.appendChild(r)}}customElements.define("my-login",em);class nm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){this.render()}render(){this.shadowRoot&&Yg.forEach((t=>{var e;const n=document.createElement("my-login");n.setAttribute(tm.logo,t.logo),n.setAttribute(tm.google,t.google),n.setAttribute(tm.facebook,t.facebook),n.setAttribute(tm.outlook,t.outlook),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}))}}customElements.define("app-login",nm);class im extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){this.render()}render(){var t,e,n,i,r;switch(this.shadowRoot&&(this.shadowRoot.innerHTML=""),s.screen){case"HOME":const s=this.ownerDocument.createElement("app-dashboard");null===(t=this.shadowRoot)||void 0===t||t.appendChild(s);break;case"EXPLORE":const o=this.ownerDocument.createElement("app-explore");null===(e=this.shadowRoot)||void 0===e||e.appendChild(o);break;case"PROFILE":const a=this.ownerDocument.createElement("app-perfil");null===(n=this.shadowRoot)||void 0===n||n.appendChild(a);break;case"REGISTER":const c=this.ownerDocument.createElement("app-register");null===(i=this.shadowRoot)||void 0===i||i.appendChild(c);break;case"LOGIN":const l=this.ownerDocument.createElement("app-login");null===(r=this.shadowRoot)||void 0===r||r.appendChild(l)}}}customElements.define("app-container",im)})()})();