/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={471:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".card {\n\tfont-family: 'inter';\n\tbackground-color: rgb(237, 237, 237);\n\twidth: 90%;\n\tpadding: 10px;\n\tborder-radius: 10px;\n\tmargin-left: 5%;\n\tmargin-top: 10px;\n\tmargin-bottom: 10px;\n\tdisplay: flex;\n\talign-items: center;\n\tcolor: rgb(30, 30, 30);\n}\n\n.top {\n\tmargin: 10px;\n\tmargin-right: 20px;\n\tfont-family: 'inter';\n\tfont-weight: 600;\n\tcolor: rgba(30, 30, 30, 0.7);\n}\n\n.artist {\n\tfont-size: 12px;\n\tmargin-top: 2px;\n}\n\n.title {\n\tfont-size: 15px;\n\tfont-weight: 600;\n\tmargin: 0;\n}\n\n.letters {\n\tmargin-left: 10px;\n}\n\nimg {\n\theight: 50px;\n\twidth: 50px;\n\tborder-radius: 5px;\n}\n\n.imagen {\n\tjustify-content: center;\n}\n\np {\n\tmargin-top: 0%;\n\tmargin-bottom: 0%;\n}\n",""]);const a=o},357:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".image img {\n\twidth: 100%;\n\theight: 100%;\n\tobject-fit: cover;\n}\n\n#wave {\n\tmargin-left: 10px;\n\tmargin-top: 10px;\n}\n\n.image {\n\twidth: 30px;\n\theight: 30px;\n\tborder-radius: 50%;\n\toverflow: hidden;\n\tmargin: 10px;\n}\n\n.comment,\n.like_group,\n.share {\n\tmargin-left: 15px;\n\tmargin-right: 15px;\n}\n\n.cardEntera {\n\tbackground-color: rgb(255, 255, 255);\n\twidth: 70%;\n\theight: 15%;\n\tpadding: 10px;\n\tmargin-bottom: 10px;\n\tborder-radius: 10px;\n\tbox-shadow: 0 4px 8px rgba(0, 0, 0.3, 0.3);\n\tmargin-left: 15%;\n\tmargin-top: 2%;\n\tfont-family: 'inter';\n\tcolor: #1e1e1e;\n}\n\n.profile {\n\tdisplay: flex;\n\talign-items: center;\n}\n.interacciones {\n\tdisplay: flex;\n\tcolor: #2ec4b6;\n\talign-items: center;\n\tjustify-content: end;\n}\n.like_group,\n.share,\n.comment {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n#svg {\n\twidth: 26px;\n\theight: 26px;\n\tmargin: 3px;\n}\n\n#svg_like {\n\twidth: 26px;\n\theight: 26px;\n\tmargin: 3px;\n}\n\n.username {\n\tfont-weight: 700;\n}\n\np {\n\tmargin: 0;\n}\n",""]);const a=o},499:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"p {\n\tfont-family: 'inter';\n\tfont-size: 14px;\n\tcolor: white;\n}\n.image img {\n\twidth: 30px;\n\theight: 30px; /* Ancho del contenedor */ /* Altura del contenedor */\n\toverflow: hidden; /* Oculta cualquier contenido que exceda los límites del contenedor */\n\tdisplay: block; /* Asegura que la imagen se comporte como un bloque */\n\tborder-radius: 50%; /* Hace que la imagen sea circular */\n\tmargin: 10px;\n}\n\n.image {\n\tdisplay: flex;\n}\n\n.song {\n\tfont-family: 'inter';\n\tfont-weight: 400;\n\tfont-size: 20px;\n\twidth: 280px;\n\talign-items: flex-start;\n\tcolor: white;\n\tmargin-left: 65px;\n\tmargin-top: 0;\n}\n\nh3 {\n\tmargin-top: 0;\n}\n.card {\n\twidth: 400px;\n\theight: 180px;\n\tborder-radius: 20px;\n\tmargin: 20px;\n}\n\n.todo {\n\tposition: relative;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.7);\n\tz-index: 1;\n\tborder-radius: 20px;\n}\n",""]);const a=o},507:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".header {\n\tbackground-color: rgb(255, 255, 255);\n\theight: 10vh;\n\tbox-shadow: 0 4px 4px rgba(0, 0, 0, 0.1);\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n\n#perfil {\n\theight: 50px;\n\twidth: 50px;\n\tmargin-right: 2%;\n}\n\n.header img {\n\tmargin-left: 5%;\n}\n\n.logo img {\n\theight: 10vh;\n\tmargin-left: 20px;\n\tcursor: pointer;\n}\n\nsvg {\n\tmargin-right: 20px;\n\tcursor: pointer;\n}\n",""]);const a=o},67:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".menubar {\n\tdisplay: flex;\n\tjustify-content: space-evenly;\n\tposition: fixed;\n\tbottom: 0;\n\talign-items: center;\n\twidth: 100%;\n\theight: 10vh;\n\tbackground-color: white;\n\tz-index: 2;\n\tbox-shadow: 0 -4px 4px rgba(0, 0, 0, 0.1);\n}\n\n#home,\n#chats,\n#profile {\n\theight: 30px;\n\twidth: 30px;\n\tcursor: pointer;\n}\n\n#explore {\n\theight: 24px;\n\twidth: 34px;\n\tcursor: pointer;\n}\n\n@media screen and (max-width: 768px) {\n\t.menubar {\n\t\tdisplay: flex;\n\t\tjustify-content: space-evenly;\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\talign-items: center;\n\t\twidth: 100%;\n\t\theight: 8vh;\n\t\tbackground-color: white;\n\t\tbox-shadow: 0 -4px 4px rgba(0, 0, 0, 0.1);\n\t}\n}\n",""]);const a=o},831:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".profile {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tflex-direction: column;\n\tfont-family: 'inter';\n\tmargin-top: 30px;\n}\n\n#ButtonSong {\n\tbackground-color: transparent;\n\tborder: none;\n\tcursor: pointer;\n}\n\n#writtenSong {\n\tpadding: 4%;\n\tmargin-top: 2%;\n\tmargin-bottom: 6%;\n\twidth: 40%;\n\tborder-radius: 30px;\n}\n\n.waveSong {\n\tbackground-color: white;\n\tpadding: 20px;\n\tborder-radius: 40px;\n\tbox-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\twidth: 60%;\n\theight: 40%;\n\toverflow-y: auto;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tposition: relative;\n\tmargin: auto;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n}\n\n.modalContainer {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.5);\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-family: Arial;\n}\n\n.post {\n\tbackground-color: #2ec4b6;\n\tborder: none;\n\tborder-radius: 50px;\n\tcursor: pointer;\n\theight: 40px;\n\twidth: 120px;\n\ttransition: background-color 0.2s ease;\n\tcolor: white;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\nh2 {\n\tcolor: #ff9f1c;\n\tfont-size: 25px;\n}\n\n.close {\n\tmargin-left: 90%;\n\tmargin-top: 2%;\n\tright: 50px;\n\tcursor: pointer;\n\tfont-family: Arial;\n\tcolor: #2ec4b6;\n}\n\n.image {\n\theight: 200px;\n\tborder-radius: 100px;\n}\n\n.pin {\n\theight: 24px;\n\twidth: 24px;\n}\n\nh1 {\n\tfont-size: 24px;\n\tmargin-bottom: 0;\n\tfont-weight: 700;\n\tcolor: #1e1e1e;\n}\n\n.edit {\n\tbackground-color: transparent;\n\tborder-width: 0;\n\tcolor: #ff9f1c;\n\tcursor: pointer;\n\tfont-family: 'inter';\n\tfont-size: 16px;\n\tmargin-top: 0;\n\tfont-weight: 500;\n}\n\n.fav_song {\n\tdisplay: flex;\n\talign-items: center;\n\tfont-weight: 500;\n\tfont-size: 25px;\n\tcolor: rgb(46, 196, 182);\n\tcursor: pointer;\n}\n\n.name-following {\n\tdisplay: flex;\n\talign-items: center;\n\tflex-direction: row;\n\tjustify-content: center;\n\tfont-family: 'Inter';\n}\n\n.name {\n\tmargin: 5px;\n\tborder: 2px solid rgba(30, 30, 30, 0.2);\n\tborder-radius: 10px;\n\theight: 30px;\n\twidth: 193px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 16px;\n\tcolor: #1e1e1e;\n}\n\n.following {\n\tmargin: 5px;\n\tborder: 2px solid rgba(30, 30, 30, 0.2);\n\tborder-radius: 10px;\n\theight: 30px;\n\twidth: 193px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 16px;\n\tcolor: #1e1e1e;\n\tcursor: pointer;\n}\n\n.followers {\n\theight: 55px;\n\twidth: 400px;\n\tbackground-color: #2ec4b6;\n\tfont-weight: 500;\n\tcolor: white;\n\tborder-radius: 12px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 18px;\n\tmargin: 4px;\n\tbox-shadow: 2px 2px 7px rgba(0, 0, 0, 0.4);\n\tcursor: pointer;\n}\n\n.playlist {\n\theight: 35px;\n\twidth: 400px;\n\tbackground-color: #ff9f1c;\n\tfont-weight: 500;\n\tcolor: white;\n\tborder-radius: 10px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tfont-size: 15px;\n\tmargin: 4px;\n\tborder: none;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\tmargin-top: 8px;\n\tcursor: pointer;\n}\n\n.todo {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tfont-family: 'inter';\n}\n\n.playlist:hover {\n\tbackground-color: #ffbf69;\n}\n",""]);const a=o},835:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"input {\n\twidth: 70vh;\n\tpadding: 10px;\n\tmargin: 2vh;\n\tborder: none;\n\tborder-radius: 12px;\n\tfont-size: 15px;\n\tcolor: rgba(30, 30, 30, 0.8);\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\theight: 4vh;\n}\n\n.info {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n}\n\nsvg {\n\tmargin-top: 40px;\n\theight: 35px;\n\twidth: 35px;\n\tcursor: pointer;\n\tposition: absolute;\n\tmargin-right: 90%;\n}\n\ninput:focus {\n\tborder-color: #2ec4b6;\n\toutline: none;\n}\n\n.logo {\n\twidth: 40vh;\n}\n\n.todo {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\talign-content: center;\n\tfont-family: 'inter';\n}\n\n.google {\n\twidth: 9vh;\n\tmargin-right: 100px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tcursor: pointer;\n}\n\n.facebook {\n\twidth: 6vh;\n\tmargin-right: 100px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tpadding: 8px;\n\tbackground-color: #fdfdfd;\n\tcursor: pointer;\n}\n\n.outlook {\n\twidth: 6vh;\n\tmargin: 10px;\n\tbox-shadow: 2px 2px 9px rgba(0, 0, 0, 0.2);\n\tborder-radius: 2vh;\n\tpadding: 8px;\n\tbackground-color: #fdfdfd;\n\tcursor: pointer;\n}\n\n#apps {\n\tdisplay: flex;\n\talign-items: center;\n}\n\nbutton {\n\twidth: 73vh;\n\tpadding: 10px;\n\tmargin: 2vh;\n\tborder: none;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n\tcolor: white;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\theight: 6vh;\n\tbackground-color: #2ec4b6;\n\tcursor: pointer;\n\ttransition: 0.3s;\n}\n\nbutton:hover {\n\tbackground-color: #ffbf69;\n}\n\nform {\n\tdisplay: flex;\n\tjustify-content: center;\n\tflex-direction: column;\n}\n\n.text_create {\n\tcolor: rgba(30, 30, 30, 0.6);\n\tmargin-bottom: 25px;\n\tmargin-left: 12px;\n\tmargin-top: 0;\n\tfont-weight: 600;\n}\n\n.text {\n\tcolor: rgba(30, 30, 30, 0.6);\n\tmargin-top: 45px;\n\tmargin-bottom: 45px;\n\tmargin-right: 10px;\n\tfont-weight: 500;\n}\n\n.already_have {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.signup_btn {\n\tcursor: pointer;\n\tcolor: #ff9f1c;\n}\n\n@media screen and (max-width: 768px) {\n\tinput {\n\t\twidth: 50vh;\n\t\tpadding: 10px;\n\t\tmargin: 2vh;\n\t\tborder: none;\n\t\tborder-radius: 12px;\n\t\tfont-size: 15px;\n\t\tcolor: rgba(30, 30, 30, 0.8);\n\t\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n\t\theight: 4vh;\n\t}\n}\n",""]);const a=o},9:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"input {\n\twidth: 30%;\n\theight: 15%;\n\tpadding: 10px;\n\tmargin: 10px;\n\tborder: 2px solid #ccc;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n\tmargin-left: 15%;\n\tmargin-bottom: 30px;\n}\n\nbody {\n\tcolor: #ccc;\n}\n\nh1 {\n\tfont-family: 'inter';\n\tmargin-left: 15%;\n\tfont-size: 30px;\n\tpadding-top: 50px;\n\tcolor: #1e1e1e;\n\tmargin-top: 0;\n}\n\nh2 {\n\tfont-family: 'inter';\n\tmargin-left: 15%;\n\tfont-size: 30px;\n\tmargin-top: 10px;\n\tcolor: #969696;\n\tmargin-bottom: 20px;\n}\n\ninput:focus {\n\tborder-color: #ff9f1c;\n\toutline: none;\n}\n\nbutton {\n\tpadding: 10px 40px;\n\tfont-size: 16px;\n\tborder: none;\n\tborder-radius: 5px;\n\tbackground-color: #ff9f1c;\n\tcolor: white;\n\tcursor: pointer;\n\ttransition: 0.3s;\n\tmargin-top: 20px;\n\tmargin-bottom: 20px;\n\tbox-shadow: 2px 2px 5px rgba(0, 0, 0, 0.4);\n}\n\nbutton:hover {\n\tbackground-color: #ffbf69;\n}\n\n.input-btn {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n",""]);const a=o},628:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,"h1 {\n\tfont-family: 'inter';\n\tmargin-left: 20px;\n\tfont-size: 30px;\n\tmargin-top: 60px;\n\tcolor: #1e1e1e;\n}\n\n.playlists {\n\tdisplay: flex;\n\toverflow-x: auto;\n\tmax-width: 100%;\n\tpadding-bottom: 20px;\n}\n\n.my-friend {\n\tflex: 0 0 auto;\n\tmargin-right: 20px;\n}\n",""]);const a=o},11:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),s=n(314),o=n.n(s)()(r());o.push([t.id,".h1Add {\n\tfont-size: 24px;\n\tmargin-bottom: 15px;\n\tcolor: #1e1e1e;\n\tfont-weight: 700;\n\tfont-family: 'Inter';\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tposition: relative;\n\tz-index: 2;\n\tmargin-top: 30px;\n}\n\n.artist,\n.title,\n.image {\n\twidth: 20%;\n\tpadding: 10px;\n\tmargin: 4px;\n\tborder: 2px solid #ccc;\n\tborder-radius: 10px;\n\tfont-size: 15px;\n\tposition: relative;\n\tz-index: 2;\n}\n\n.create-song {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.artist:focus,\n.title:focus,\n.image:focus {\n\tborder-color: #ff9f1c;\n\toutline: none;\n}\n\n.save {\n\tpadding: 10px 65px;\n\tfont-size: 16px;\n\tborder: none;\n\tborder-radius: 5px;\n\tbackground-color: #ff9f1c;\n\tcolor: white;\n\tcursor: pointer;\n\ttransition: 0.3s;\n\tmargin-left: 45%;\n\tmargin-top: 20px;\n\tmargin-bottom: 20px;\n}\n.save:hover {\n\tbackground-color: #ffbf69;\n}\n",""]);const a=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);i&&o[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),e.push(h))}},e}},601:t=>{t.exports=function(t){return t[1]}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{const t=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#ff9f1c" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'"https://i.pinimg.com/originals/94/67/f5/9467f504e83345d60816f9b87ac84588.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="27" height="27" viewBox="0 0 24 24" style="fill: rgb(32, 32, 32);transform: ;msFilter:;"><path d="M12 2C6.579 2 2 6.579 2 12s4.579 10 10 10 10-4.579 10-10S17.421 2 12 2zm0 5c1.727 0 3 1.272 3 3s-1.273 3-3 3c-1.726 0-3-1.272-3-3s1.274-3 3-3zm-5.106 9.772c.897-1.32 2.393-2.2 4.106-2.2h2c1.714 0 3.209.88 4.106 2.2C15.828 18.14 14.015 19 12 19s-3.828-.86-5.106-2.228z"></path></svg>'}];var e,i=n(67);!function(t){t.STORE="STORE"}(e||(e={}));let r=(({key:t,defaultValue:e})=>{const n=localStorage.getItem(t)||sessionStorage.getItem(t);return n?JSON.parse(n):e})({key:e.STORE,defaultValue:{screen:"REGISTER"}}),s=[];const o=t=>{const n=((t,e)=>{const{action:n,payload:i}=t;return"navigate"===n&&(e.screen=i),e})(t,JSON.parse(JSON.stringify(r)));var i;r=n,i=n,(({key:t,value:e,session:n=!1})=>{const i=n?sessionStorage:localStorage,r=JSON.stringify(e);i.setItem(t,r)})({key:e.STORE,value:i,session:!1}),s.forEach((t=>t.render()))},a=t=>{s=[...s,t]},c=t=>({action:"navigate",payload:t});var l;!function(t){t.uid="uid",t.iconohome="iconohome",t.iconoexplore="iconoexplore",t.iconoprofile="iconoprofile"}(l||(l={}));class h extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,iconohome:null,iconoexplore:null,iconoprofile:null})}attributeChangedCallback(t,e,n){t===l.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t,e,n,r;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t<section class="menubar">\n\t\t<svg id="home">${this.iconohome}</svg>\n\t\t<img id="explore" src=${this.iconoexplore}></svg>\n\t\t<svg id="profile">${this.iconoprofile}</svg>\n\t\t\t</section>`);const s=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#home");null==s||s.addEventListener("click",(()=>{o(c("HOME"))}));const a=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#explore");null==a||a.addEventListener("click",(()=>{o(c("EXPLORE"))}));const l=null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector("#profile");null==l||l.addEventListener("click",(()=>{o(c("PROFILE"))}));const h=this.ownerDocument.createElement("style");h.innerHTML=i.A,null===(r=this.shadowRoot)||void 0===r||r.appendChild(h)}}customElements.define("my-iconos",h);const u=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg"}];var d,f=n(507);!function(t){t.uid="uid",t.logo="logo"}(d||(d={}));class p extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,logo:null})}attributeChangedCallback(t,e,n){t===d.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t,e;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n    <section class="header">\n\t\t<section class="logo">\n    <img src='${this.logo}'></img>\n\t\t</section>\n    </section>`);const n=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".logo");null==n||n.addEventListener("click",(()=>{o(c("HOME"))}));const i=this.ownerDocument.createElement("style");i.innerHTML=f.A,null===(e=this.shadowRoot)||void 0===e||e.appendChild(i)}}customElements.define("my-header",p);const g=[{id:1,name:"Susana García",wave:"",image:"https://images.pexels.com/photos/3646160/pexels-photo-3646160.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",unlike:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"/></svg>',like:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6bc" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>',cantidadlike:"6,4k",share:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>',cantidadshare:"49k",comentar:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec6b6" d="M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4l0 0 0 0 0 0 0 0 .3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z"/></svg>',cantidadcomentar:"6,9k"}];var m=n(357);const v=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},y={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=r>>2,h=(3&r)<<4|o>>4;let u=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(u=64)),i.push(n[l],n[h],n[u],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(v(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==s||null==o||null==a)throw new w;const c=r<<2|s>>4;if(i.push(c),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class w extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const b=function(t){return function(t){const e=v(t);return y.encodeByteArray(e,!0)}(t).replace(/\./g,"")},_=function(t){try{return y.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},E=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&_(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},T=t=>{var e,n;return null===(n=null===(e=E())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},I=()=>{var t;return null===(t=E())||void 0===t?void 0:t.config},S=t=>{var e;return null===(e=E())||void 0===e?void 0:e[`_${t}`]};class C{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function k(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function A(){try{return"object"==typeof indexedDB}catch(t){return!1}}class x extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,x.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,R.prototype.create)}}class R{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(N,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new x(i,o,n)}}const N=/\{\$([^}]+)}/g;function D(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(L(n)&&L(s)){if(!D(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function L(t){return null!==t&&"object"==typeof t}function O(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function P(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function M(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class F{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=U),void 0===i.error&&(i.error=U),void 0===i.complete&&(i.complete=U);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),r}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function U(){}function V(t){return t&&t._delegate?t._delegate:t}class j{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const B="[DEFAULT]";class z{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new C;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:B})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=B){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=B){return this.instances.has(t)}getOptions(t=B){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===B?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=B){return this.component?this.component.multipleInstances?t:B:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class q{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new z(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const $=[];var H;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(H||(H={}));const K={debug:H.DEBUG,verbose:H.VERBOSE,info:H.INFO,warn:H.WARN,error:H.ERROR,silent:H.SILENT},G=H.INFO,W={[H.DEBUG]:"log",[H.VERBOSE]:"log",[H.INFO]:"info",[H.WARN]:"warn",[H.ERROR]:"error"},Q=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=W[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class J{constructor(t){this.name=t,this._logLevel=G,this._logHandler=Q,this._userLogHandler=null,$.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in H))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?K[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,H.DEBUG,...t),this._logHandler(this,H.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,H.VERBOSE,...t),this._logHandler(this,H.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,H.INFO,...t),this._logHandler(this,H.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,H.WARN,...t),this._logHandler(this,H.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,H.ERROR,...t),this._logHandler(this,H.ERROR,...t)}}const X=(t,e)=>e.some((e=>t instanceof e));let Y,Z;const tt=new WeakMap,et=new WeakMap,nt=new WeakMap,it=new WeakMap,rt=new WeakMap;let st={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return et.get(t);if("objectStoreNames"===e)return t.objectStoreNames||nt.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return at(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function ot(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Z||(Z=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ct(this),t),at(tt.get(this))}:function(...t){return at(e.apply(ct(this),t))}:function(t,...n){const i=e.call(ct(this),t,...n);return nt.set(i,t.sort?t.sort():[t]),at(i)}:(t instanceof IDBTransaction&&function(t){if(et.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));et.set(t,e)}(t),X(t,Y||(Y=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,st):t);var e}function at(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(at(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&tt.set(e,t)})).catch((()=>{})),rt.set(e,t),e}(t);if(it.has(t))return it.get(t);const e=ot(t);return e!==t&&(it.set(t,e),rt.set(e,t)),e}const ct=t=>rt.get(t),lt=["get","getKey","getAll","getAllKeys","count"],ht=["put","add","delete","clear"],ut=new Map;function dt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(ut.get(e))return ut.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=ht.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!lt.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return ut.set(e,s),s}var ft;ft=st,st={...ft,get:(t,e,n)=>dt(t,e)||ft.get(t,e,n),has:(t,e)=>!!dt(t,e)||ft.has(t,e)};class pt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const gt="@firebase/app",mt="0.9.26",vt=new J("@firebase/app"),yt="[DEFAULT]",wt={[gt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},bt=new Map,_t=new Map;function Et(t,e){try{t.container.addComponent(e)}catch(n){vt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Tt(t){const e=t.name;if(_t.has(e))return vt.debug(`There were multiple attempts to register component ${e}.`),!1;_t.set(e,t);for(const e of bt.values())Et(e,t);return!0}function It(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const St=new R("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Ct{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new j("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw St.create("app-deleted",{appName:this._name})}}const kt="10.7.2";function At(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:yt,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw St.create("bad-app-name",{appName:String(r)});if(n||(n=I()),!n)throw St.create("no-options");const s=bt.get(r);if(s){if(D(n,s.options)&&D(i,s.config))return s;throw St.create("duplicate-app",{appName:r})}const o=new q(r);for(const t of _t.values())o.addComponent(t);const a=new Ct(n,i,o);return bt.set(r,a),a}function xt(t=yt){const e=bt.get(t);if(!e&&t===yt&&I())return At();if(!e)throw St.create("no-app",{appName:t});return e}function Rt(t,e,n){var i;let r=null!==(i=wt[t])&&void 0!==i?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${r}" with version "${e}":`];return s&&t.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void vt.warn(t.join(" "))}Tt(new j(`${r}-version`,(()=>({library:r,version:e})),"VERSION"))}const Nt="firebase-heartbeat-database",Dt=1,Lt="firebase-heartbeat-store";let Ot=null;function Pt(){return Ot||(Ot=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=at(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(at(o.result),t.oldVersion,t.newVersion,at(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(t=>r(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(Nt,Dt,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Lt)}catch(t){console.warn(t)}}}).catch((t=>{throw St.create("idb-open",{originalErrorMessage:t.message})}))),Ot}async function Mt(t,e){try{const n=(await Pt()).transaction(Lt,"readwrite"),i=n.objectStore(Lt);await i.put(e,Ft(t)),await n.done}catch(t){if(t instanceof x)vt.warn(t.message);else{const e=St.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});vt.warn(e.message)}}}function Ft(t){return`${t.name}!${t.options.appId}`}class Ut{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new jt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Vt();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Vt(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),Bt(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Bt(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=b(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Vt(){return(new Date).toISOString().substring(0,10)}class jt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!A()&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=await Pt();return await e.transaction(Lt).objectStore(Lt).get(Ft(t))}catch(t){if(t instanceof x)vt.warn(t.message);else{const e=St.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});vt.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Mt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Mt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Bt(t){return b(JSON.stringify({version:2,heartbeats:t})).length}Tt(new j("platform-logger",(t=>new pt(t)),"PRIVATE")),Tt(new j("heartbeat",(t=>new Ut(t)),"PRIVATE")),Rt(gt,mt,""),Rt(gt,mt,"esm2017"),Rt("fire-js",""),Rt("firebase","10.7.2","app");var zt,qt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},$t={},Ht=Ht||{},Kt=qt||self;function Gt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Wt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Qt="closure_uid_"+(1e9*Math.random()>>>0),Jt=0;function Xt(t,e,n){return t.call.apply(t.bind,arguments)}function Yt(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Zt(t,e,n){return(Zt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Xt:Yt).apply(null,arguments)}function te(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ee(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function ne(){this.s=this.s,this.o=this.o}ne.prototype.s=!1,ne.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Qt)&&t[Qt]||(t[Qt]=++Jt))},ne.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ie=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function re(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function se(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Gt(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function oe(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}oe.prototype.h=function(){this.defaultPrevented=!0};var ae=function(){if(!Kt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};Kt.addEventListener("test",t,e),Kt.removeEventListener("test",t,e)}catch(t){}return t}();function ce(t){return/^[\s\xa0]*$/.test(t)}function le(){var t=Kt.navigator;return t&&(t=t.userAgent)?t:""}function he(t){return-1!=le().indexOf(t)}function ue(t){return ue[" "](t),t}ue[" "]=function(){};var de,fe,pe,ge=he("Opera"),me=he("Trident")||he("MSIE"),ve=he("Edge"),ye=ve||me,we=he("Gecko")&&!(-1!=le().toLowerCase().indexOf("webkit")&&!he("Edge"))&&!(he("Trident")||he("MSIE"))&&!he("Edge"),be=-1!=le().toLowerCase().indexOf("webkit")&&!he("Edge");function _e(){var t=Kt.document;return t?t.documentMode:void 0}t:{var Ee="",Te=(fe=le(),we?/rv:([^\);]+)(\)|;)/.exec(fe):ve?/Edge\/([\d\.]+)/.exec(fe):me?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(fe):be?/WebKit\/(\S+)/.exec(fe):ge?/(?:Version)[ \/]?(\S+)/.exec(fe):void 0);if(Te&&(Ee=Te?Te[1]:""),me){var Ie=_e();if(null!=Ie&&Ie>parseFloat(Ee)){de=String(Ie);break t}}de=Ee}Kt.document&&me?pe=_e()||parseInt(de,10)||void 0:pe=void 0;var Se=pe;function Ce(t,e){if(oe.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(we){t:{try{ue(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ke[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ce.$.h.call(this)}}ee(Ce,oe);var ke={2:"touch",3:"pen",4:"mouse"};Ce.prototype.h=function(){Ce.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Ae="closure_listenable_"+(1e6*Math.random()|0),xe=0;function Re(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++xe,this.fa=this.ia=!1}function Ne(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function De(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function Le(t){const e={};for(const n in t)e[n]=t[n];return e}const Oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pe(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<Oe.length;e++)n=Oe[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Me(t){this.src=t,this.g={},this.h=0}function Fe(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=ie(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Ne(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Ue(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==i)return r}return-1}Me.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Ue(t,e,i,r);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Re(e,this.src,s,!!i,r)).ia=n,t.push(e)),e};var Ve="closure_lm_"+(1e6*Math.random()|0),je={};function Be(t,e,n,i,r){if(i&&i.once)return qe(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Be(t,e[s],n,i,r);return null}return n=Je(n),t&&t[Ae]?t.O(e,n,Wt(i)?!!i.capture:!!i,r):ze(t,e,n,!1,i,r)}function ze(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=Wt(r)?!!r.capture:!!r,a=We(t);if(a||(t[Ve]=a=new Me(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){const t=Ge;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)ae||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ke(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function qe(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)qe(t,e[s],n,i,r);return null}return n=Je(n),t&&t[Ae]?t.P(e,n,Wt(i)?!!i.capture:!!i,r):ze(t,e,n,!0,i,r)}function $e(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)$e(t,e[s],n,i,r);else i=Wt(i)?!!i.capture:!!i,n=Je(n),t&&t[Ae]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Ue(s=t.g[e],n,i,r))&&(Ne(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=We(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ue(e,n,i,r)),(n=-1<t?e[t]:null)&&He(n))}function He(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[Ae])Fe(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ke(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=We(e))?(Fe(n,t),0==n.h&&(n.src=null,e[Ve]=null)):Ne(t)}}}function Ke(t){return t in je?je[t]:je[t]="on"+t}function Ge(t,e){if(t.fa)t=!0;else{e=new Ce(e,this);var n=t.listener,i=t.la||t.src;t.ia&&He(t),t=n.call(i,e)}return t}function We(t){return(t=t[Ve])instanceof Me?t:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Je(t){return"function"==typeof t?t:(t[Qe]||(t[Qe]=function(e){return t.handleEvent(e)}),t[Qe])}function Xe(){ne.call(this),this.i=new Me(this),this.S=this,this.J=null}function Ye(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new oe(e,t);else if(e instanceof oe)e.target=e.target||t;else{var r=e;Pe(e=new oe(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Ze(o,i,!0,e)&&r}if(r=Ze(o=e.g=t,i,!0,e)&&r,r=Ze(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Ze(o=e.g=n[s],i,!1,e)&&r}function Ze(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Fe(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}ee(Xe,ne),Xe.prototype[Ae]=!0,Xe.prototype.removeEventListener=function(t,e,n,i){$e(this,t,e,n,i)},Xe.prototype.N=function(){if(Xe.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)Ne(n[i]);delete e.g[t],e.h--}}this.J=null},Xe.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Xe.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var tn=Kt.JSON.stringify;function en(){var t=ln;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var nn=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new rn),(t=>t.reset()));class rn{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function sn(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function on(t){Kt.setTimeout((()=>{throw t}),0)}let an,cn=!1,ln=new class{constructor(){this.h=this.g=null}add(t,e){const n=nn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},hn=()=>{const t=Kt.Promise.resolve(void 0);an=()=>{t.then(un)}};var un=()=>{for(var t;t=en();){try{t.h.call(t.g)}catch(t){on(t)}var e=nn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}cn=!1};function dn(t,e){Xe.call(this),this.h=t||1,this.g=e||Kt,this.j=Zt(this.qb,this),this.l=Date.now()}function fn(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function pn(t,e,n){if("function"==typeof t)n&&(t=Zt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Zt(t.handleEvent,t)}return 2147483647<Number(e)?-1:Kt.setTimeout(t,e||0)}function gn(t){t.g=pn((()=>{t.g=null,t.i&&(t.i=!1,gn(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}ee(dn,Xe),(zt=dn.prototype).ga=!1,zt.T=null,zt.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ye(this,"tick"),this.ga&&(fn(this),this.start()))}},zt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},zt.N=function(){dn.$.N.call(this),fn(this),delete this.g};class mn extends ne{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:gn(this)}N(){super.N(),this.g&&(Kt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vn(t){ne.call(this),this.h=t,this.g={}}ee(vn,ne);var yn=[];function wn(t,e,n,i){Array.isArray(n)||(n&&(yn[0]=n.toString()),n=yn);for(var r=0;r<n.length;r++){var s=Be(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function bn(t){De(t.g,(function(t,e){this.g.hasOwnProperty(e)&&He(t)}),t),t.g={}}function _n(){this.g=!0}function En(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return tn(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}vn.prototype.N=function(){vn.$.N.call(this),bn(this)},vn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},_n.prototype.Ea=function(){this.g=!1},_n.prototype.info=function(){};var Tn={},In=null;function Sn(){return In=In||new Xe}function Cn(t){oe.call(this,Tn.Ta,t)}function kn(t){const e=Sn();Ye(e,new Cn(e))}function An(t,e){oe.call(this,Tn.STAT_EVENT,t),this.stat=e}function xn(t){const e=Sn();Ye(e,new An(e,t))}function Rn(t,e){oe.call(this,Tn.Ua,t),this.size=e}function Nn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Kt.setTimeout((function(){t()}),e)}Tn.Ta="serverreachability",ee(Cn,oe),Tn.STAT_EVENT="statevent",ee(An,oe),Tn.Ua="timingevent",ee(Rn,oe);var Dn={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ln={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function On(){}function Pn(t){return t.h||(t.h=t.i())}function Mn(){}On.prototype.h=null;var Fn,Un={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Vn(){oe.call(this,"d")}function jn(){oe.call(this,"c")}function Bn(){}function zn(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new vn(this),this.P=$n,t=ye?125:void 0,this.V=new dn(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new qn}function qn(){this.i=null,this.g="",this.h=!1}ee(Vn,oe),ee(jn,oe),ee(Bn,On),Bn.prototype.g=function(){return new XMLHttpRequest},Bn.prototype.i=function(){return{}},Fn=new Bn;var $n=45e3,Hn={},Kn={};function Gn(t,e,n){t.L=1,t.A=di(ai(e)),t.u=n,t.S=!0,Wn(t,null)}function Wn(t,e){t.G=Date.now(),Yn(t),t.B=ai(t.A);var n=t.B,i=t.W;Array.isArray(i)||(i=[String(i)]),Si(n.i,"t",i),t.o=0,n=t.l.J,t.h=new qn,t.g=Sr(t.l,n?e:null,!t.u),0<t.O&&(t.M=new mn(Zt(t.Pa,t,t.g),t.O)),wn(t.U,t.g,"readystatechange",t.nb),e=t.I?Le(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),kn(),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var h=l[0];l=l[1];var u=h.split("_");o=2<=u.length&&"type"==u[1]?o+(h+"=")+l+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function Qn(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Jn(t,e,n){let i,r=!0;for(;!t.J&&t.o<n.length;){if(i=Xn(t,n),i==Kn){4==e&&(t.s=4,xn(14),r=!1),En(t.j,t.m,null,"[Incomplete Response]");break}if(i==Hn){t.s=4,xn(15),En(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}En(t.j,t.m,i,null),ii(t,i)}Qn(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,xn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),vr(e),e.M=!0,xn(11))):(En(t.j,t.m,n,"[Invalid Chunked Response]"),ni(t),ei(t))}function Xn(t,e){var n=t.o,i=e.indexOf("\n",n);return-1==i?Kn:(n=Number(e.substring(n,i)),isNaN(n)?Hn:(i+=1)+n>e.length?Kn:(e=e.slice(i,i+n),t.o=i+n,e))}function Yn(t){t.Y=Date.now()+t.P,Zn(t,t.P)}function Zn(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=Nn(Zt(t.lb,t),e)}function ti(t){t.C&&(Kt.clearTimeout(t.C),t.C=null)}function ei(t){0==t.l.H||t.J||br(t.l,t)}function ni(t){ti(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,fn(t.V),bn(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function ii(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Di(n.i,t)))if(!t.K&&Di(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;wr(n),lr(n)}mr(n),xn(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=Nn(Zt(n.ib,n),6e3));if(1>=Ni(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else Er(n,11)}else if((t.K||n.g==t)&&wr(n),!ce(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const e=l[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const r=l[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const h=l[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Li(s,s.h),s.h=null))}if(i.F){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,ui(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((i=n).wa=Ir(i,i.J?i.pa:null,i.Y),o.K){Oi(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.C&&(ti(a),Yn(a)),i.g=o}else gr(i);0<n.j.length&&ur(n)}else"stop"!=l[0]&&"close"!=l[0]||Er(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Er(n,7):cr(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}kn()}catch(t){}}function ri(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Gt(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Gt(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Gt(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(zt=zn.prototype).setTimeout=function(t){this.P=t},zt.nb=function(t){t=t.target;const e=this.M;e&&3==nr(t)?e.l():this.Pa(t)},zt.Pa=function(t){try{if(t==this.g)t:{const h=nr(this.g);var e=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||ye||this.g&&(this.h.h||this.g.ja()||ir(this.g)))){this.J||4!=h||7==e||kn(),ti(this);var n=this.g.da();this.ca=n;e:if(Qn(this)){var i=ir(this.g);t="";var r=i.length,s=4==nr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ni(this),ei(this);var o="";break e}this.h.i=new Kt.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ce(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.s=3,xn(12),ni(this),ei(this);break t}En(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ii(this,n)}this.S?(Jn(this,h,o),ye&&this.i&&3==h&&(wn(this.U,this.V,"tick",this.mb),this.V.start())):(En(this.j,this.m,o,null),ii(this,o)),4==h&&ni(this),this.i&&!this.J&&(4==h?br(this.l,this):(this.i=!1,Yn(this)))}else(function(t){const e={};t=(t.g&&2<=nr(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(ce(t[i]))continue;var n=sn(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[r]||[];e[r]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,xn(12)):(this.s=0,xn(13)),ni(this),ei(this)}}}catch(t){}},zt.mb=function(){if(this.g){var t=nr(this.g),e=this.g.ja();this.o<e.length&&(ti(this),Jn(this,t,e),this.i&&4!=t&&Yn(this))}},zt.cancel=function(){this.J=!0,ni(this)},zt.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(kn(),xn(17)),ni(this),this.s=2,ei(this)):Zn(this,this.Y-t)};var si=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function oi(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof oi){this.h=t.h,ci(this,t.j),this.s=t.s,this.g=t.g,li(this,t.m),this.l=t.l;var e=t.i,n=new _i;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),hi(this,n),this.o=t.o}else t&&(e=String(t).match(si))?(this.h=!1,ci(this,e[1]||"",!0),this.s=fi(e[2]||""),this.g=fi(e[3]||"",!0),li(this,e[4]),this.l=fi(e[5]||"",!0),hi(this,e[6]||"",!0),this.o=fi(e[7]||"")):(this.h=!1,this.i=new _i(null,this.h))}function ai(t){return new oi(t)}function ci(t,e,n){t.j=n?fi(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function li(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function hi(t,e,n){e instanceof _i?(t.i=e,function(t,e){e&&!t.j&&(Ei(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ti(this,e),Si(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=pi(e,wi)),t.i=new _i(e,t.h))}function ui(t,e,n){t.i.set(e,n)}function di(t){return ui(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function fi(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function pi(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,gi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function gi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}oi.prototype.toString=function(){var t=[],e=this.j;e&&t.push(pi(e,mi,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(pi(e,mi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(pi(n,"/"==n.charAt(0)?yi:vi,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",pi(n,bi)),t.join("")};var mi=/[#\/\?@]/g,vi=/[#\?:]/g,yi=/[#\?]/g,wi=/[#\?@]/g,bi=/#/g;function _i(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ei(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ti(t,e){Ei(t),e=Ci(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ii(t,e){return Ei(t),e=Ci(t,e),t.g.has(e)}function Si(t,e,n){Ti(t,e),0<n.length&&(t.i=null,t.g.set(Ci(t,e),re(n)),t.h+=n.length)}function Ci(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(zt=_i.prototype).add=function(t,e){Ei(this),this.i=null,t=Ci(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},zt.forEach=function(t,e){Ei(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},zt.ta=function(){Ei(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},zt.Z=function(t){Ei(this);let e=[];if("string"==typeof t)Ii(this,t)&&(e=e.concat(this.g.get(Ci(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},zt.set=function(t,e){return Ei(this),this.i=null,Ii(this,t=Ci(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},zt.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},zt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var ki=class{constructor(t,e){this.g=t,this.map=e}};function Ai(t){this.l=t||xi,t=Kt.PerformanceNavigationTiming?0<(t=Kt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Kt.g&&Kt.g.Ka&&Kt.g.Ka()&&Kt.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var xi=10;function Ri(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ni(t){return t.h?1:t.g?t.g.size:0}function Di(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Li(t,e){t.g?t.g.add(e):t.h=e}function Oi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Pi(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return re(t.i)}Ai.prototype.cancel=function(){if(this.i=Pi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Mi=class{stringify(t){return Kt.JSON.stringify(t,void 0)}parse(t){return Kt.JSON.parse(t,void 0)}};function Fi(){this.g=new Mi}function Ui(t,e,n){const i=n||"";try{ri(t,(function(t,n){let r=t;Wt(t)&&(r=tn(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Vi(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function ji(t){this.l=t.ec||null,this.j=t.ob||!1}function Bi(t,e){Xe.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=zi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ee(ji,On),ji.prototype.g=function(){return new Bi(this.l,this.j)},ji.prototype.i=function(t){return function(){return t}}({}),ee(Bi,Xe);var zi=0;function qi(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function $i(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Hi(t)}function Hi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(zt=Bi.prototype).open=function(t,e){if(this.readyState!=zi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Hi(this)},zt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Kt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},zt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,$i(this)),this.readyState=zi},zt.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Hi(this)),this.g&&(this.readyState=3,Hi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Kt.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qi(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},zt.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?$i(this):Hi(this),3==this.readyState&&qi(this)}},zt.Za=function(t){this.g&&(this.response=this.responseText=t,$i(this))},zt.Ya=function(t){this.g&&(this.response=t,$i(this))},zt.ka=function(){this.g&&$i(this)},zt.setRequestHeader=function(t,e){this.v.append(t,e)},zt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},zt.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Bi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Ki=Kt.JSON.parse;function Gi(t){Xe.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Wi,this.L=this.M=!1}ee(Gi,Xe);var Wi="",Qi=/^https?$/i,Ji=["POST","PUT"];function Xi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Yi(t),tr(t)}function Yi(t){t.F||(t.F=!0,Ye(t,"complete"),Ye(t,"error"))}function Zi(t){if(t.h&&void 0!==Ht&&(!t.C[1]||4!=nr(t)||2!=t.da()))if(t.v&&4==nr(t))pn(t.La,0,t);else if(Ye(t,"readystatechange"),4==nr(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var r=String(t.I).match(si)[1]||null;!r&&Kt.self&&Kt.self.location&&(r=Kt.self.location.protocol.slice(0,-1)),i=!Qi.test(r?r.toLowerCase():"")}n=i}if(n)Ye(t,"complete"),Ye(t,"success");else{t.m=6;try{var s=2<nr(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",Yi(t)}}finally{tr(t)}}}function tr(t,e){if(t.g){er(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Ye(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function er(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Kt.clearTimeout(t.A),t.A=null)}function nr(t){return t.g?t.g.readyState:0}function ir(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Wi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function rr(t){let e="";return De(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function sr(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=rr(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ui(t,e,n))}function or(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ar(t){this.Ga=0,this.j=[],this.l=new _n,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=or("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=or("baseRetryDelayMs",5e3,t),this.hb=or("retryDelaySeedMs",1e4,t),this.eb=or("forwardChannelMaxRetries",2,t),this.xa=or("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Ai(t&&t.concurrentRequestLimit),this.Ja=new Fi,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function cr(t){if(hr(t),3==t.H){var e=t.W++,n=ai(t.I);if(ui(n,"SID",t.K),ui(n,"RID",e),ui(n,"TYPE","terminate"),fr(t,n),(e=new zn(t,t.l,e)).L=2,e.A=di(ai(n)),n=!1,Kt.navigator&&Kt.navigator.sendBeacon)try{n=Kt.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&Kt.Image&&((new Image).src=e.A,n=!0),n||(e.g=Sr(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Yn(e)}Tr(t)}function lr(t){t.g&&(vr(t),t.g.cancel(),t.g=null)}function hr(t){lr(t),t.u&&(Kt.clearTimeout(t.u),t.u=null),wr(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Kt.clearTimeout(t.m),t.m=null)}function ur(t){if(!Ri(t.i)&&!t.m){t.m=!0;var e=t.Na;an||hn(),cn||(an(),cn=!0),ln.add(e,t),t.C=0}}function dr(t,e){var n;n=e?e.m:t.W++;const i=ai(t.I);ui(i,"SID",t.K),ui(i,"RID",n),ui(i,"AID",t.V),fr(t,i),t.o&&t.s&&sr(i,t.o,t.s),n=new zn(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=pr(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Li(t.i,n),Gn(n,i,e)}function fr(t,e){t.na&&De(t.na,(function(t,n){ui(e,n,t)})),t.h&&ri({},(function(t,n){ui(e,n,t)}))}function pr(t,e,n){n=Math.min(t.j.length,n);var i=t.h?Zt(t.h.Va,t.h,t):null;t:{var r=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=e,0>n)e=Math.max(0,r[o].g-100),s=!1;else try{Ui(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function gr(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;an||hn(),cn||(an(),cn=!0),ln.add(e,t),t.A=0}}function mr(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Nn(Zt(t.Ma,t),_r(t,t.A)),t.A++,0))}function vr(t){null!=t.B&&(Kt.clearTimeout(t.B),t.B=null)}function yr(t){t.g=new zn(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=ai(t.wa);ui(e,"RID","rpc"),ui(e,"SID",t.K),ui(e,"AID",t.V),ui(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&ui(e,"TO",t.qa),ui(e,"TYPE","xmlhttp"),fr(t,e),t.o&&t.s&&sr(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=di(ai(e)),n.u=null,n.S=!0,Wn(n,t)}function wr(t){null!=t.v&&(Kt.clearTimeout(t.v),t.v=null)}function br(t,e){var n=null;if(t.g==e){wr(t),vr(t),t.g=null;var i=2}else{if(!Di(t.i,e))return;n=e.F,Oi(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.u?e.u.length:0,e=Date.now()-e.G;var r=t.C;Ye(i=Sn(),new Rn(i,n)),ur(t)}else gr(t);else if(3==(r=e.s)||0==r&&0<e.ca||!(1==i&&function(t,e){return!(Ni(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Nn(Zt(t.Na,t,e),_r(t,t.C)),t.C++,0)))}(t,e)||2==i&&mr(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:Er(t,5);break;case 4:Er(t,10);break;case 3:Er(t,6);break;default:Er(t,2)}}function _r(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Er(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=Zt(t.pb,t);n||(n=new oi("//www.google.com/images/cleardot.gif"),Kt.location&&"http"==Kt.location.protocol||ci(n,"https"),di(n)),function(t,e){const n=new _n;if(Kt.Image){const i=new Image;i.onload=te(Vi,n,i,"TestLoadImage: loaded",!0,e),i.onerror=te(Vi,n,i,"TestLoadImage: error",!1,e),i.onabort=te(Vi,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=te(Vi,n,i,"TestLoadImage: timeout",!1,e),Kt.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else xn(2);t.H=0,t.h&&t.h.za(e),Tr(t),hr(t)}function Tr(t){if(t.H=0,t.ma=[],t.h){const e=Pi(t.i);0==e.length&&0==t.j.length||(se(t.ma,e),se(t.ma,t.j),t.i.i.length=0,re(t.j),t.j.length=0),t.h.ya()}}function Ir(t,e,n){var i=n instanceof oi?ai(n):new oi(n);if(""!=i.g)e&&(i.g=e+"."+i.g),li(i,i.m);else{var r=Kt.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new oi(null);i&&ci(s,i),e&&(s.g=e),r&&li(s,r),n&&(s.l=n),i=s}return n=t.F,e=t.Da,n&&e&&ui(i,n,e),ui(i,"VER",t.ra),fr(t,i),i}function Sr(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Gi(new ji({ob:n})):new Gi(t.va)).Oa(t.J),e}function Cr(){}function kr(){if(me&&!(10<=Number(Se)))throw Error("Environmental error: no available transport.")}function Ar(t,e){Xe.call(this),this.g=new ar(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ce(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ce(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Nr(this)}function xr(t){Vn.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Rr(){jn.call(this),this.status=1}function Nr(t){this.g=t}function Dr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Lr(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}function Or(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=0|t[r];i&&s==e||(n[r]=s,i=!1)}this.g=n}(zt=Gi.prototype).Oa=function(t){this.M=t},zt.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Fn.g(),this.C=this.u?Pn(this.u):Pn(Fn),this.g.onreadystatechange=Zt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Xi(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=Kt.FormData&&t instanceof Kt.FormData,!(0<=ie(Ji,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{er(this),0<this.B&&((this.L=function(t){return me&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Zt(this.ua,this)):this.A=pn(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Xi(this,t)}},zt.ua=function(){void 0!==Ht&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ye(this,"timeout"),this.abort(8))},zt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ye(this,"complete"),Ye(this,"abort"),tr(this))},zt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),tr(this,!0)),Gi.$.N.call(this)},zt.La=function(){this.s||(this.G||this.v||this.l?Zi(this):this.kb())},zt.kb=function(){Zi(this)},zt.isActive=function(){return!!this.g},zt.da=function(){try{return 2<nr(this)?this.g.status:-1}catch(t){return-1}},zt.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},zt.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ki(e)}},zt.Ia=function(){return this.m},zt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(zt=ar.prototype).ra=8,zt.H=1,zt.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new zn(this,this.l,t);let s=this.s;if(this.U&&(s?(s=Le(s),Pe(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=pr(this,r,e),ui(n=ai(this.I),"RID",t),ui(n,"CVER",22),this.F&&ui(n,"X-HTTP-Session-Id",this.F),fr(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(rr(s)))+"&"+e:this.o&&sr(n,this.o,s)),Li(this.i,r),this.bb&&ui(n,"TYPE","init"),this.P?(ui(n,"$req",e),ui(n,"SID","null"),r.aa=!0,Gn(r,n,null)):Gn(r,n,e),this.H=2}}else 3==this.H&&(t?dr(this,t):0==this.j.length||Ri(this.i)||dr(this))},zt.Ma=function(){if(this.u=null,yr(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Nn(Zt(this.jb,this),t)}},zt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,xn(10),lr(this),yr(this))},zt.ib=function(){null!=this.v&&(this.v=null,lr(this),mr(this),xn(19))},zt.pb=function(t){t?(this.l.info("Successfully pinged google.com"),xn(2)):(this.l.info("Failed to ping google.com"),xn(1))},zt.isActive=function(){return!!this.h&&this.h.isActive(this)},(zt=Cr.prototype).Ba=function(){},zt.Aa=function(){},zt.za=function(){},zt.ya=function(){},zt.isActive=function(){return!0},zt.Va=function(){},kr.prototype.g=function(t,e){return new Ar(t,e)},ee(Ar,Xe),Ar.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;xn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Ir(t,null,t.Y),ur(t)},Ar.prototype.close=function(){cr(this.g)},Ar.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=tn(t),t=n);e.j.push(new ki(e.fb++,t)),3==e.H&&ur(e)},Ar.prototype.N=function(){this.g.h=null,delete this.j,cr(this.g),delete this.g,Ar.$.N.call(this)},ee(xr,Vn),ee(Rr,jn),ee(Nr,Cr),Nr.prototype.Ba=function(){Ye(this.g,"a")},Nr.prototype.Aa=function(t){Ye(this.g,new xr(t))},Nr.prototype.za=function(t){Ye(this.g,new Rr)},Nr.prototype.ya=function(){Ye(this.g,"b")},ee(Dr,(function(){this.blockSize=-1})),Dr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Dr.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=n;)Lr(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(i[r++]=t.charCodeAt(s++),r==this.blockSize){Lr(this,i),r=0;break}}else for(;s<e;)if(i[r++]=t[s++],r==this.blockSize){Lr(this,i),r=0;break}}this.h=r,this.i+=e},Dr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var Pr={};function Mr(t){return-128<=t&&128>t?function(t,e){var n=Pr;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new Or([0|t],0>t?-1:0)}(t)}(t):new Or([0|t],0>t?-1:0)}function Fr(t){if(isNaN(t)||!isFinite(t))return Vr;if(0>t)return $r(Fr(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=Ur;return new Or(e,0)}var Ur=4294967296,Vr=Mr(0),jr=Mr(1),Br=Mr(16777216);function zr(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function qr(t){return-1==t.h}function $r(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new Or(n,~t.h).add(jr)}function Hr(t,e){return t.add($r(e))}function Kr(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Gr(t,e){this.g=t,this.h=e}function Wr(t,e){if(zr(e))throw Error("division by zero");if(zr(t))return new Gr(Vr,Vr);if(qr(t))return e=Wr($r(t),e),new Gr($r(e.g),$r(e.h));if(qr(e))return e=Wr(t,$r(e)),new Gr($r(e.g),e.h);if(30<t.g.length){if(qr(t)||qr(e))throw Error("slowDivide_ only works with positive integers.");for(var n=jr,i=e;0>=i.X(t);)n=Qr(n),i=Qr(i);var r=Jr(n,1),s=Jr(i,1);for(i=Jr(i,2),n=Jr(n,2);!zr(i);){var o=s.add(i);0>=o.X(t)&&(r=r.add(n),s=o),i=Jr(i,1),n=Jr(n,1)}return e=Hr(t,r.R(e)),new Gr(r,e)}for(r=Vr;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=Fr(n)).R(e);qr(o)||0<o.X(t);)o=(s=Fr(n-=i)).R(e);zr(s)&&(s=jr),r=r.add(s),t=Hr(t,o)}return new Gr(r,t)}function Qr(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new Or(n,t.h)}function Jr(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Or(r,t.h)}(zt=Or.prototype).ea=function(){if(qr(this))return-$r(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:Ur+i)*e,e*=Ur}return t},zt.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(zr(this))return"0";if(qr(this))return"-"+$r(this).toString(t);for(var e=Fr(Math.pow(t,6)),n=this,i="";;){var r=Wr(n,e).g,s=((0<(n=Hr(n,r.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(zr(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},zt.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},zt.X=function(t){return qr(t=Hr(this,t))?-1:zr(t)?0:1},zt.abs=function(){return qr(this)?$r(this):this},zt.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&t.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new Or(n,-2147483648&n[n.length-1]?-1:0)},zt.R=function(t){if(zr(this)||zr(t))return Vr;if(qr(this))return qr(t)?$r(this).R($r(t)):$r($r(this).R(t));if(qr(t))return $r(this.R($r(t)));if(0>this.X(Br)&&0>t.X(Br))return Fr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=t.D(r)>>>16,c=65535&t.D(r);n[2*i+2*r]+=o*c,Kr(n,2*i+2*r),n[2*i+2*r+1]+=s*c,Kr(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,Kr(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,Kr(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new Or(n,0)},zt.gb=function(t){return Wr(this,t).h},zt.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new Or(n,this.h&t.h)},zt.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new Or(n,this.h|t.h)},zt.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new Or(n,this.h^t.h)},kr.prototype.createWebChannel=kr.prototype.g,Ar.prototype.send=Ar.prototype.u,Ar.prototype.open=Ar.prototype.m,Ar.prototype.close=Ar.prototype.close,Dn.NO_ERROR=0,Dn.TIMEOUT=8,Dn.HTTP_ERROR=6,Ln.COMPLETE="complete",Mn.EventType=Un,Un.OPEN="a",Un.CLOSE="b",Un.ERROR="c",Un.MESSAGE="d",Xe.prototype.listen=Xe.prototype.O,Gi.prototype.listenOnce=Gi.prototype.P,Gi.prototype.getLastError=Gi.prototype.Sa,Gi.prototype.getLastErrorCode=Gi.prototype.Ia,Gi.prototype.getStatus=Gi.prototype.da,Gi.prototype.getResponseJson=Gi.prototype.Wa,Gi.prototype.getResponseText=Gi.prototype.ja,Gi.prototype.send=Gi.prototype.ha,Gi.prototype.setWithCredentials=Gi.prototype.Oa,Dr.prototype.digest=Dr.prototype.l,Dr.prototype.reset=Dr.prototype.reset,Dr.prototype.update=Dr.prototype.j,Or.prototype.add=Or.prototype.add,Or.prototype.multiply=Or.prototype.R,Or.prototype.modulo=Or.prototype.gb,Or.prototype.compare=Or.prototype.X,Or.prototype.toNumber=Or.prototype.ea,Or.prototype.toString=Or.prototype.toString,Or.prototype.getBits=Or.prototype.D,Or.fromNumber=Fr,Or.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return $r(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Fr(Math.pow(n,8)),r=Vr,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=Fr(Math.pow(n,o)),r=r.R(o).add(Fr(a))):r=(r=r.R(i)).add(Fr(a))}return r};var Xr=$t.createWebChannelTransport=function(){return new kr},Yr=$t.getStatEventTarget=function(){return Sn()},Zr=$t.ErrorCode=Dn,ts=$t.EventType=Ln,es=$t.Event=Tn,ns=$t.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},is=($t.FetchXmlHttpFactory=ji,$t.WebChannel=Mn),rs=$t.XhrIo=Gi,ss=$t.Md5=Dr,os=$t.Integer=Or;const as="@firebase/firestore";class cs{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}cs.UNAUTHENTICATED=new cs(null),cs.GOOGLE_CREDENTIALS=new cs("google-credentials-uid"),cs.FIRST_PARTY=new cs("first-party-uid"),cs.MOCK_USER=new cs("mock-user");let ls="10.7.2";const hs=new J("@firebase/firestore");function us(){return hs.logLevel}function ds(t,...e){if(hs.logLevel<=H.DEBUG){const n=e.map(gs);hs.debug(`Firestore (${ls}): ${t}`,...n)}}function fs(t,...e){if(hs.logLevel<=H.ERROR){const n=e.map(gs);hs.error(`Firestore (${ls}): ${t}`,...n)}}function ps(t,...e){if(hs.logLevel<=H.WARN){const n=e.map(gs);hs.warn(`Firestore (${ls}): ${t}`,...n)}}function gs(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function ms(t="Unexpected state"){const e=`FIRESTORE (${ls}) INTERNAL ASSERTION FAILED: `+t;throw fs(e),new Error(e)}function vs(t,e){t||ms()}function ys(t,e){return t}const ws={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class bs extends x{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _s{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Es{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Ts{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(cs.UNAUTHENTICATED)))}shutdown(){}}class Is{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Ss{constructor(t){this.t=t,this.currentUser=cs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new _s;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new _s,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{ds("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(ds("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new _s)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(ds("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(vs("string"==typeof e.accessToken),new Es(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return vs(null===t||"string"==typeof t),new cs(t)}}class Cs{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=cs.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ks{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new Cs(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(cs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class As{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xs{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&ds("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,ds("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{ds("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):ds("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(vs("string"==typeof t.token),this.R=t.token,new As(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Rs(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Ns{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=Rs(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function Ds(t,e){return t<e?-1:t>e?1:0}function Ls(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class Os{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new bs(ws.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new bs(ws.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new bs(ws.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new bs(ws.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Os.fromMillis(Date.now())}static fromDate(t){return Os.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Os(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Ds(this.nanoseconds,t.nanoseconds):Ds(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ps{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ps(t)}static min(){return new Ps(new Os(0,0))}static max(){return new Ps(new Os(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ms{constructor(t,e,n){void 0===e?e=0:e>t.length&&ms(),void 0===n?n=t.length-e:n>t.length-e&&ms(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Ms.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Ms?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Fs extends Ms{construct(t,e,n){return new Fs(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new bs(ws.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Fs(e)}static emptyPath(){return new Fs([])}}const Us=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vs extends Ms{construct(t,e,n){return new Vs(t,e,n)}static isValidIdentifier(t){return Us.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vs.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Vs(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new bs(ws.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new bs(ws.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new bs(ws.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new bs(ws.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Vs(e)}static emptyPath(){return new Vs([])}}class js{constructor(t){this.path=t}static fromPath(t){return new js(Fs.fromString(t))}static fromName(t){return new js(Fs.fromString(t).popFirst(5))}static empty(){return new js(Fs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Fs.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Fs.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new js(new Fs(t.slice()))}}function Bs(t){return new zs(t.readTime,t.key,-1)}class zs{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new zs(Ps.min(),js.empty(),-1)}static max(){return new zs(Ps.max(),js.empty(),-1)}}function qs(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=js.comparator(t.documentKey,e.documentKey),0!==n?n:Ds(t.largestBatchId,e.largestBatchId))}const $s="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Hs{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Ks(t){if(t.code!==ws.FAILED_PRECONDITION||t.message!==$s)throw t;ds("LocalStore","Unexpectedly lost primary lease")}class Gs{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&ms(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Gs(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Gs?e:Gs.resolve(e)}catch(t){return Gs.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Gs.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Gs.reject(e)}static resolve(t){return new Gs(((e,n)=>{e(t)}))}static reject(t){return new Gs(((e,n)=>{n(t)}))}static waitFor(t){return new Gs(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=Gs.resolve(!1);for(const n of t)e=e.next((t=>t?Gs.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Gs(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;e(t[c]).next((t=>{s[c]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new Gs(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}class Ws{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new _s,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Xs(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=no(e.target.error);this.V.reject(new Xs(t,n))}}static open(t,e,n,i){try{return new Ws(e,t.transaction(i,n))}catch(t){throw new Xs(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(ds("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new Zs(e)}}class Qs{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===Qs.S(k())&&fs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return ds("SimpleDb","Removing database:",t),to(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!A())return!1;if(Qs.C())return!0;const t=k(),e=Qs.S(t),n=0<e&&e<10,i=Qs.v(t),r=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||r)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(ds("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=t=>{const n=t.target.result;e(n)},i.onblocked=()=>{n(new Xs(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=e=>{const i=e.target.error;"VersionError"===i.name?n(new bs(ws.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new bs(ws.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new Xs(t,i))},i.onupgradeneeded=t=>{ds("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,i.transaction,t.oldVersion,this.version).next((()=>{ds("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,i){const r="readonly"===e;let s=0;for(;;){++s;try{this.db=await this.O(t);const e=Ws.open(this.db,t,r?"readonly":"readwrite",n),s=i(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),Gs.reject(t)))).toPromise();return s.catch((()=>{})),await e.m,s}catch(t){const e=t,n="FirebaseError"!==e.name&&s<3;if(ds("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Js{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return to(this.k.delete())}}class Xs extends bs{constructor(t,e){super(ws.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Ys(t){return"IndexedDbTransactionError"===t.name}class Zs{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(ds("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(ds("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),to(n)}add(t){return ds("SimpleDb","ADD",this.store.name,t,t),to(this.store.add(t))}get(t){return to(this.store.get(t)).next((e=>(void 0===e&&(e=null),ds("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return ds("SimpleDb","DELETE",this.store.name,t),to(this.store.delete(t))}count(){return ds("SimpleDb","COUNT",this.store.name),to(this.store.count())}W(t,e){const n=this.options(t,e),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const t=i.getAll(n.range);return new Gs(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new Gs(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){ds("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const i=this.cursor(n);return this.G(i,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const i=this.cursor(n);return this.G(i,e)}Z(t){const e=this.cursor({});return new Gs(((n,i)=>{e.onerror=t=>{const e=no(t.target.error);i(e)},e.onsuccess=e=>{const i=e.target.result;i?t(i.primaryKey,i.value).next((t=>{t?i.continue():n()})):n()}}))}G(t,e){const n=[];return new Gs(((i,r)=>{t.onerror=t=>{r(t.target.error)},t.onsuccess=t=>{const r=t.target.result;if(!r)return void i();const s=new Js(r),o=e(r.primaryKey,r.value,s);if(o instanceof Gs){const t=o.catch((t=>(s.done(),Gs.reject(t))));n.push(t)}s.isDone?i():null===s.$?r.continue():r.continue(s.$)}})).next((()=>Gs.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function to(t){return new Gs(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=no(t.target.error);n(e)}}))}let eo=!1;function no(t){const e=Qs.S(k());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new bs("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return eo||(eo=!0,setTimeout((()=>{throw t}),0)),t}}return t}class io{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function ro(t){return null==t}function so(t){return 0===t&&1/t==-1/0}io._e=-1;function oo(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ao(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function co(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class lo{constructor(t,e){this.comparator=t,this.root=e||uo.EMPTY}insert(t,e){return new lo(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,uo.BLACK,null,null))}remove(t){return new lo(this.comparator,this.root.remove(t,this.comparator).copy(null,null,uo.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ho(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ho(this.root,t,this.comparator,!1)}getReverseIterator(){return new ho(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ho(this.root,t,this.comparator,!0)}}class ho{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class uo{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:uo.RED,this.left=null!=i?i:uo.EMPTY,this.right=null!=r?r:uo.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new uo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return uo.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return uo.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,uo.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,uo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ms();if(this.right.isRed())throw ms();const t=this.left.check();if(t!==this.right.check())throw ms();return t+(this.isRed()?0:1)}}uo.EMPTY=null,uo.RED=!0,uo.BLACK=!1,uo.EMPTY=new class{constructor(){this.size=0}get key(){throw ms()}get value(){throw ms()}get color(){throw ms()}get left(){throw ms()}get right(){throw ms()}copy(t,e,n,i,r){return this}insert(t,e,n){return new uo(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class fo{constructor(t){this.comparator=t,this.data=new lo(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new po(this.data.getIterator())}getIteratorFrom(t){return new po(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof fo))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new fo(this.comparator);return e.data=t,e}}class po{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class go{constructor(t){this.fields=t,t.sort(Vs.comparator)}static empty(){return new go([])}unionWith(t){let e=new fo(Vs.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new go(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Ls(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class mo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class vo{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new mo("Invalid base64 string: "+t):t}}(t);return new vo(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new vo(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Ds(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}vo.EMPTY_BYTE_STRING=new vo("");const yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wo(t){if(vs(!!t),"string"==typeof t){let e=0;const n=yo.exec(t);if(vs(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:bo(t.seconds),nanos:bo(t.nanos)}}function bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _o(t){return"string"==typeof t?vo.fromBase64String(t):vo.fromUint8Array(t)}function Eo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function To(t){const e=t.mapValue.fields.__previous_value__;return Eo(e)?To(e):e}function Io(t){const e=wo(t.mapValue.fields.__local_write_time__.timestampValue);return new Os(e.seconds,e.nanos)}class So{constructor(t,e,n,i,r,s,o,a,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class Co{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Co("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Co&&t.projectId===this.projectId&&t.database===this.database}}const ko={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Eo(t)?4:Bo(t)?9007199254740991:10:ms()}function xo(t,e){if(t===e)return!0;const n=Ao(t);if(n!==Ao(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Io(t).isEqual(Io(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=wo(t.timestampValue),i=wo(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return _o(t.bytesValue).isEqual(_o(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return bo(t.geoPointValue.latitude)===bo(e.geoPointValue.latitude)&&bo(t.geoPointValue.longitude)===bo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return bo(t.integerValue)===bo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=bo(t.doubleValue),i=bo(e.doubleValue);return n===i?so(n)===so(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Ls(t.arrayValue.values||[],e.arrayValue.values||[],xo);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(oo(n)!==oo(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!xo(n[t],i[t])))return!1;return!0}(t,e);default:return ms()}}function Ro(t,e){return void 0!==(t.values||[]).find((t=>xo(t,e)))}function No(t,e){if(t===e)return 0;const n=Ao(t),i=Ao(e);if(n!==i)return Ds(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ds(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=bo(t.integerValue||t.doubleValue),i=bo(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Do(t.timestampValue,e.timestampValue);case 4:return Do(Io(t),Io(e));case 5:return Ds(t.stringValue,e.stringValue);case 6:return function(t,e){const n=_o(t),i=_o(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=Ds(n[t],i[t]);if(0!==e)return e}return Ds(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Ds(bo(t.latitude),bo(e.latitude));return 0!==n?n:Ds(bo(t.longitude),bo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=No(n[t],i[t]);if(e)return e}return Ds(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===ko.mapValue&&e===ko.mapValue)return 0;if(t===ko.mapValue)return 1;if(e===ko.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=Ds(i[t],s[t]);if(0!==e)return e;const o=No(n[i[t]],r[s[t]]);if(0!==o)return o}return Ds(i.length,s.length)}(t.mapValue,e.mapValue);default:throw ms()}}function Do(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ds(t,e);const n=wo(t),i=wo(e),r=Ds(n.seconds,i.seconds);return 0!==r?r:Ds(n.nanos,i.nanos)}function Lo(t){return Oo(t)}function Oo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=wo(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return _o(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return js.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Oo(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${Oo(t.fields[r])}`;return n+"}"}(t.mapValue):ms()}function Po(t){return!!t&&"integerValue"in t}function Mo(t){return!!t&&"arrayValue"in t}function Fo(t){return!!t&&"nullValue"in t}function Uo(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vo(t){return!!t&&"mapValue"in t}function jo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ao(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=jo(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=jo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Bo(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class zo{constructor(t){this.value=t}static empty(){return new zo({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Vo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=jo(e)}setAll(t){let e=Vs.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=jo(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Vo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return xo(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Vo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){ao(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new zo(jo(this.value))}}function qo(t){const e=[];return ao(t.fields,((t,n)=>{const i=new Vs([t]);if(Vo(n)){const t=qo(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new go(e)}class $o{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new $o(t,0,Ps.min(),Ps.min(),Ps.min(),zo.empty(),0)}static newFoundDocument(t,e,n,i){return new $o(t,1,e,Ps.min(),n,i,0)}static newNoDocument(t,e){return new $o(t,2,e,Ps.min(),Ps.min(),zo.empty(),0)}static newUnknownDocument(t,e){return new $o(t,3,e,Ps.min(),Ps.min(),zo.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Ps.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=zo.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=zo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ps.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof $o&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new $o(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ho{constructor(t,e){this.position=t,this.inclusive=e}}function Ko(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?js.comparator(js.fromName(o.referenceValue),n.key):No(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Go(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xo(t.position[n],e.position[n]))return!1;return!0}class Wo{constructor(t,e="asc"){this.field=t,this.dir=e}}function Qo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Jo{}class Xo extends Jo{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new ra(t,e,n):"array-contains"===e?new ca(t,n):"in"===e?new la(t,n):"not-in"===e?new ha(t,n):"array-contains-any"===e?new ua(t,n):new Xo(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new sa(t,n):new oa(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(No(e,this.value)):null!==e&&Ao(this.value)===Ao(e)&&this.matchesComparison(No(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ms()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Yo extends Jo{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new Yo(t,e)}matches(t){return Zo(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Zo(t){return"and"===t.op}function ta(t){return function(t){for(const e of t.filters)if(e instanceof Yo)return!1;return!0}(t)&&Zo(t)}function ea(t){if(t instanceof Xo)return t.field.canonicalString()+t.op.toString()+Lo(t.value);if(ta(t))return t.filters.map((t=>ea(t))).join(",");{const e=t.filters.map((t=>ea(t))).join(",");return`${t.op}(${e})`}}function na(t,e){return t instanceof Xo?function(t,e){return e instanceof Xo&&t.op===e.op&&t.field.isEqual(e.field)&&xo(t.value,e.value)}(t,e):t instanceof Yo?function(t,e){return e instanceof Yo&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&na(n,e.filters[i])),!0)}(t,e):void ms()}function ia(t){return t instanceof Xo?function(t){return`${t.field.canonicalString()} ${t.op} ${Lo(t.value)}`}(t):t instanceof Yo?function(t){return t.op.toString()+" {"+t.getFilters().map(ia).join(" ,")+"}"}(t):"Filter"}class ra extends Xo{constructor(t,e,n){super(t,e,n),this.key=js.fromName(n.referenceValue)}matches(t){const e=js.comparator(t.key,this.key);return this.matchesComparison(e)}}class sa extends Xo{constructor(t,e){super(t,"in",e),this.keys=aa(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class oa extends Xo{constructor(t,e){super(t,"not-in",e),this.keys=aa(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function aa(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>js.fromName(t.referenceValue)))}class ca extends Xo{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Mo(e)&&Ro(e.arrayValue,this.value)}}class la extends Xo{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ro(this.value.arrayValue,e)}}class ha extends Xo{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ro(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Ro(this.value.arrayValue,e)}}class ua extends Xo{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Mo(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Ro(this.value.arrayValue,t)))}}class da{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ce=null}}function fa(t,e=null,n=[],i=[],r=null,s=null,o=null){return new da(t,e,n,i,r,s,o)}function pa(t){const e=ys(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>ea(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),ro(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Lo(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Lo(t))).join(",")),e.ce=t}return e.ce}function ga(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Qo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!na(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Go(t.startAt,e.startAt)&&Go(t.endAt,e.endAt)}function ma(t){return js.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class va{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function ya(t){return new va(t)}function wa(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function ba(t){const e=ys(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new fo(Vs.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new Wo(i,n))})),t.has(Vs.keyField().canonicalString())||e.le.push(new Wo(Vs.keyField(),n))}return e.le}function _a(t){const e=ys(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return fa(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new Wo(t.field,e)}));const n=t.endAt?new Ho(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Ho(t.startAt.position,t.startAt.inclusive):null;return fa(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}(e,ba(t))),e.he}function Ea(t,e,n){return new va(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ta(t,e){return ga(_a(t),_a(e))&&t.limitType===e.limitType}function Ia(t){return`${pa(_a(t))}|lt:${t.limitType}`}function Sa(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>ia(t))).join(", ")}]`),ro(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Lo(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Lo(t))).join(",")),`Target(${e})`}(_a(t))}; limitType=${t.limitType})`}function Ca(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):js.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of ba(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Ko(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,ba(t),e)||t.endAt&&!function(t,e,n){const i=Ko(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,ba(t),e))}(t,e)}function ka(t){return(e,n)=>{let i=!1;for(const r of ba(t)){const t=Aa(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function Aa(t,e,n){const i=t.field.isKeyField()?js.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?No(i,r):ms()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return ms()}}class xa{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){ao(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return co(this.inner)}size(){return this.innerSize}}const Ra=new lo(js.comparator);function Na(){return Ra}const Da=new lo(js.comparator);function La(...t){let e=Da;for(const n of t)e=e.insert(n.key,n);return e}function Oa(t){let e=Da;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Pa(){return Fa()}function Ma(){return Fa()}function Fa(){return new xa((t=>t.toString()),((t,e)=>t.isEqual(e)))}const Ua=new lo(js.comparator),Va=new fo(js.comparator);function ja(...t){let e=Va;for(const n of t)e=e.add(n);return e}const Ba=new fo(Ds);function za(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:so(e)?"-0":e}}function qa(t){return{integerValue:""+t}}function $a(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!so(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?qa(e):za(t,e)}class Ha{constructor(){this._=void 0}}function Ka(t,e,n){return t instanceof Qa?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Eo(e)&&(e=To(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ja?Xa(t,e):t instanceof Ya?Za(t,e):function(t,e){const n=Wa(t,e),i=ec(n)+ec(t.Ie);return Po(n)&&Po(t.Ie)?qa(i):za(t.serializer,i)}(t,e)}function Ga(t,e,n){return t instanceof Ja?Xa(t,e):t instanceof Ya?Za(t,e):n}function Wa(t,e){return t instanceof tc?function(t){return Po(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Qa extends Ha{}class Ja extends Ha{constructor(t){super(),this.elements=t}}function Xa(t,e){const n=nc(e);for(const e of t.elements)n.some((t=>xo(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Ya extends Ha{constructor(t){super(),this.elements=t}}function Za(t,e){let n=nc(e);for(const e of t.elements)n=n.filter((t=>!xo(t,e)));return{arrayValue:{values:n}}}class tc extends Ha{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function ec(t){return bo(t.integerValue||t.doubleValue)}function nc(t){return Mo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class ic{constructor(t,e){this.version=t,this.transformResults=e}}class rc{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new rc}static exists(t){return new rc(void 0,t)}static updateTime(t){return new rc(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function sc(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class oc{}function ac(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new vc(t.key,rc.none()):new dc(t.key,t.data,rc.none());{const n=t.data,i=zo.empty();let r=new fo(Vs.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new fc(t.key,i,new go(r.toArray()),rc.none())}}function cc(t,e,n){t instanceof dc?function(t,e,n){const i=t.value.clone(),r=gc(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof fc?function(t,e,n){if(!sc(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=gc(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(pc(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function lc(t,e,n,i){return t instanceof dc?function(t,e,n,i){if(!sc(t.precondition,e))return n;const r=t.value.clone(),s=mc(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof fc?function(t,e,n,i){if(!sc(t.precondition,e))return n;const r=mc(t.fieldTransforms,i,e),s=e.data;return s.setAll(pc(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return sc(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function hc(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=Wa(i.transform,t||null);null!=r&&(null===n&&(n=zo.empty()),n.set(i.field,r))}return n||null}function uc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Ls(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ja&&e instanceof Ja||t instanceof Ya&&e instanceof Ya?Ls(t.elements,e.elements,xo):t instanceof tc&&e instanceof tc?xo(t.Ie,e.Ie):t instanceof Qa&&e instanceof Qa}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class dc extends oc{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fc extends oc{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function pc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function gc(t,e,n){const i=new Map;vs(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Ga(o,a,n[r]))}return i}function mc(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Ka(t,s,e))}return i}class vc extends oc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yc extends oc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class wc{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&cc(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=lc(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=lc(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Ma();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=ac(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Ps.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),ja())}isEqual(t){return this.batchId===t.batchId&&Ls(this.mutations,t.mutations,((t,e)=>uc(t,e)))&&Ls(this.baseMutations,t.baseMutations,((t,e)=>uc(t,e)))}}class bc{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){vs(t.mutations.length===n.length);let i=Ua;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new bc(t,e,n,i)}}class _c{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Ec{constructor(t,e){this.count=t,this.unchangedNames=e}}var Tc,Ic;function Sc(t){if(void 0===t)return fs("GRPC error has no .code"),ws.UNKNOWN;switch(t){case Tc.OK:return ws.OK;case Tc.CANCELLED:return ws.CANCELLED;case Tc.UNKNOWN:return ws.UNKNOWN;case Tc.DEADLINE_EXCEEDED:return ws.DEADLINE_EXCEEDED;case Tc.RESOURCE_EXHAUSTED:return ws.RESOURCE_EXHAUSTED;case Tc.INTERNAL:return ws.INTERNAL;case Tc.UNAVAILABLE:return ws.UNAVAILABLE;case Tc.UNAUTHENTICATED:return ws.UNAUTHENTICATED;case Tc.INVALID_ARGUMENT:return ws.INVALID_ARGUMENT;case Tc.NOT_FOUND:return ws.NOT_FOUND;case Tc.ALREADY_EXISTS:return ws.ALREADY_EXISTS;case Tc.PERMISSION_DENIED:return ws.PERMISSION_DENIED;case Tc.FAILED_PRECONDITION:return ws.FAILED_PRECONDITION;case Tc.ABORTED:return ws.ABORTED;case Tc.OUT_OF_RANGE:return ws.OUT_OF_RANGE;case Tc.UNIMPLEMENTED:return ws.UNIMPLEMENTED;case Tc.DATA_LOSS:return ws.DATA_LOSS;default:return ms()}}(Ic=Tc||(Tc={}))[Ic.OK=0]="OK",Ic[Ic.CANCELLED=1]="CANCELLED",Ic[Ic.UNKNOWN=2]="UNKNOWN",Ic[Ic.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ic[Ic.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ic[Ic.NOT_FOUND=5]="NOT_FOUND",Ic[Ic.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ic[Ic.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ic[Ic.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ic[Ic.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ic[Ic.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ic[Ic.ABORTED=10]="ABORTED",Ic[Ic.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ic[Ic.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ic[Ic.INTERNAL=13]="INTERNAL",Ic[Ic.UNAVAILABLE=14]="UNAVAILABLE",Ic[Ic.DATA_LOSS=15]="DATA_LOSS";const Cc=new os([4294967295,4294967295],0);function kc(t){const e=(new TextEncoder).encode(t),n=new ss;return n.update(e),new Uint8Array(n.digest())}function Ac(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new os([n,i],0),new os([r,s],0)]}class xc{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new Rc(`Invalid padding: ${e}`);if(n<0)throw new Rc(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new Rc(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new Rc(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=os.fromNumber(this.Te)}de(t,e,n){let i=t.add(e.multiply(os.fromNumber(n)));return 1===i.compare(Cc)&&(i=new os([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=kc(t),[n,i]=Ac(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);if(!this.Ae(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),s=new xc(r,i,e);return n.forEach((t=>s.insert(t))),s}insert(t){if(0===this.Te)return;const e=kc(t),[n,i]=Ac(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);this.Re(e)}}Re(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class Rc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Nc{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,Dc.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Nc(Ps.min(),i,new lo(Ds),Na(),ja())}}class Dc{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Dc(n,e,ja(),ja(),ja())}}class Lc{constructor(t,e,n,i){this.Ve=t,this.removedTargetIds=e,this.key=n,this.me=i}}class Oc{constructor(t,e){this.targetId=t,this.fe=e}}class Pc{constructor(t,e,n=vo.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Mc{constructor(){this.ge=0,this.pe=Vc(),this.ye=vo.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=ja(),e=ja(),n=ja();return this.pe.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:ms()}})),new Dc(this.ye,this.we,t,e,n)}Fe(){this.Se=!1,this.pe=Vc()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,vs(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Fc{constructor(t){this.Le=t,this.ke=new Map,this.qe=Na(),this.Qe=Uc(),this.Ke=new lo(Ds)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,(e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(e);break;case 3:this.je(e)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.Ce(t.resumeToken));break;default:ms()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach(((t,n)=>{this.je(n)&&e(n)}))}Je(t){const e=t.targetId,n=t.fe.count,i=this.Ye(e);if(i){const r=i.target;if(ma(r))if(0===n){const t=new js(r.path);this.We(e,t,$o.newNoDocument(t,Ps.min()))}else vs(1===n);else{const i=this.Ze(e);if(i!==n){const n=this.Xe(t),r=n?this.et(n,t,i):1;if(0!==r){this.He(e);const t=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,t)}}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=e;let s,o;try{s=_o(n).toUint8Array()}catch(t){if(t instanceof mo)return ps("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new xc(s,i,r)}catch(t){return ps(t instanceof Rc?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.Te?null:o}et(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Le.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const r=this.Le.nt(),s=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.mightContain(s)||(this.We(e,n,null),i++)})),i}it(t){const e=new Map;this.ke.forEach(((n,i)=>{const r=this.Ye(i);if(r){if(n.current&&ma(r.target)){const e=new js(r.target.path);null!==this.qe.get(e)||this.st(i,e)||this.We(i,e,$o.newNoDocument(e,t))}n.De&&(e.set(i,n.ve()),n.Fe())}}));let n=ja();this.Qe.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ye(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.qe.forEach(((e,n)=>n.setReadTime(t)));const i=new Nc(t,e,this.Ke,this.qe,n);return this.qe=Na(),this.Qe=Uc(),this.Ke=new lo(Ds),i}Ue(t,e){if(!this.je(t))return;const n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,e)?i.Me(e,1):i.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new Mc,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new fo(Ds),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||ds("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new Mc),this.Le.getRemoteKeysForTarget(t).forEach((e=>{this.We(t,e,null)}))}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function Uc(){return new lo(js.comparator)}function Vc(){return new lo(js.comparator)}const jc={asc:"ASCENDING",desc:"DESCENDING"},Bc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zc={and:"AND",or:"OR"};class qc{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function $c(t,e){return t.useProto3Json||ro(e)?e:{value:e}}function Hc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kc(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Gc(t,e){return Hc(t,e.toTimestamp())}function Wc(t){return vs(!!t),Ps.fromTimestamp(function(t){const e=wo(t);return new Os(e.seconds,e.nanos)}(t))}function Qc(t,e){return Jc(t,e).canonicalString()}function Jc(t,e){const n=function(t){return new Fs(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Xc(t){const e=Fs.fromString(t);return vs(gl(e)),e}function Yc(t,e){return Qc(t.databaseId,e.path)}function Zc(t,e){const n=Xc(e);if(n.get(1)!==t.databaseId.projectId)throw new bs(ws.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new bs(ws.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new js(nl(n))}function tl(t,e){return Qc(t.databaseId,e)}function el(t){return new Fs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nl(t){return vs(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function il(t,e,n){return{name:Yc(t,e),fields:n.value.mapValue.fields}}function rl(t,e){return{documents:[tl(t,e.path)]}}function sl(t,e){const n={structuredQuery:{}},i=e.path;let r;null!==e.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=tl(t,r);const s=function(t){if(0!==t.length)return fl(Yo.create(t,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:ul(t.field),direction:cl(t.dir)}}(t)))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=$c(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ut:n,parent:r}}function ol(t){let e=function(t){const e=Xc(t);return 4===e.length?Fs.emptyPath():nl(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){vs(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=al(t);return e instanceof Yo&&ta(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new Wo(dl(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,ro(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Ho(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new Ho(n,e)}(n.endAt)),function(t,e,n,i,r,s,o,a){return new va(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,l)}function al(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=dl(t.unaryFilter.field);return Xo.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=dl(t.unaryFilter.field);return Xo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=dl(t.unaryFilter.field);return Xo.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=dl(t.unaryFilter.field);return Xo.create(r,"!=",{nullValue:"NULL_VALUE"});default:return ms()}}(t):void 0!==t.fieldFilter?function(t){return Xo.create(dl(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ms()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return Yo.create(t.compositeFilter.filters.map((t=>al(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return ms()}}(t.compositeFilter.op))}(t):ms()}function cl(t){return jc[t]}function ll(t){return Bc[t]}function hl(t){return zc[t]}function ul(t){return{fieldPath:t.canonicalString()}}function dl(t){return Vs.fromServerFormat(t.fieldPath)}function fl(t){return t instanceof Xo?function(t){if("=="===t.op){if(Uo(t.value))return{unaryFilter:{field:ul(t.field),op:"IS_NAN"}};if(Fo(t.value))return{unaryFilter:{field:ul(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Uo(t.value))return{unaryFilter:{field:ul(t.field),op:"IS_NOT_NAN"}};if(Fo(t.value))return{unaryFilter:{field:ul(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ul(t.field),op:ll(t.op),value:t.value}}}(t):t instanceof Yo?function(t){const e=t.getFilters().map((t=>fl(t)));return 1===e.length?e[0]:{compositeFilter:{op:hl(t.op),filters:e}}}(t):ms()}function pl(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function gl(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class ml{constructor(t,e,n,i,r=Ps.min(),s=Ps.min(),o=vo.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new ml(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ml(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ml(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ml(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class vl{constructor(t){this.ct=t}}function yl(t){const e=ol({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ea(e,e.limit,"L"):e}class wl{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(bo(t.integerValue));else if("doubleValue"in t){const n=bo(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),so(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(_o(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?Bo(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):ms()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),js.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}wl.bt=new wl;class bl{constructor(){this._n=new _l}addToCollectionParentIndex(t,e){return this._n.add(e),Gs.resolve()}getCollectionParents(t,e){return Gs.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return Gs.resolve()}deleteFieldIndex(t,e){return Gs.resolve()}deleteAllFieldIndexes(t){return Gs.resolve()}createTargetIndexes(t,e){return Gs.resolve()}getDocumentsMatchingTarget(t,e){return Gs.resolve(null)}getIndexType(t,e){return Gs.resolve(0)}getFieldIndexes(t,e){return Gs.resolve([])}getNextCollectionGroupToUpdate(t){return Gs.resolve(null)}getMinOffset(t,e){return Gs.resolve(zs.min())}getMinOffsetFromCollectionGroup(t,e){return Gs.resolve(zs.min())}updateCollectionGroup(t,e,n){return Gs.resolve()}updateIndexEntries(t,e){return Gs.resolve()}}class _l{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new fo(Fs.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new fo(Fs.comparator)).toArray()}}new Uint8Array(0);class El{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new El(t,El.DEFAULT_COLLECTION_PERCENTILE,El.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}El.DEFAULT_COLLECTION_PERCENTILE=10,El.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,El.DEFAULT=new El(41943040,El.DEFAULT_COLLECTION_PERCENTILE,El.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),El.DISABLED=new El(-1,0,0);class Tl{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new Tl(0)}static Bn(){return new Tl(-1)}}class Il{constructor(){this.changes=new xa((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,$o.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Gs.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Sl{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Cl{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&lc(n.mutation,t,go.empty(),Os.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,ja()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=ja()){const i=Pa();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=La();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Pa();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,ja())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=Na();const s=Fa(),o=Fa();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof fc)?r=r.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),lc(o.mutation,e,o.mutation.getFieldMask(),Os.now())):s.set(e.key,go.empty())})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new Sl(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=Fa();let i=new lo(((t,e)=>t-e)),r=ja();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||go.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||ja()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,l=Ma();c.forEach((t=>{if(!r.has(t)){const i=ac(e.get(t),n.get(t));null!==i&&l.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,l))}return Gs.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return js.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):Gs.resolve(Pa());let o=-1,a=r;return s.next((e=>Gs.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?Gs.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,ja()))).next((t=>({batchId:o,changes:Oa(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new js(e)).next((t=>{let e=La();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const r=e.collectionGroup;let s=La();return this.indexManager.getCollectionParents(t,r).next((o=>Gs.forEach(o,(o=>{const a=function(t,e){return new va(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(r));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,r,i)))).next((t=>{r.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,$o.newInvalidDocument(i)))}));let n=La();return t.forEach(((t,i)=>{const s=r.get(t);void 0!==s&&lc(s.mutation,i,go.empty(),Os.now()),Ca(e,i)&&(n=n.insert(t,i))})),n}))}}class kl{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return Gs.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Wc(t.createTime)}}(e)),Gs.resolve()}getNamedQuery(t,e){return Gs.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:yl(t.bundledQuery),readTime:Wc(t.readTime)}}(e)),Gs.resolve()}}class Al{constructor(){this.overlays=new lo(js.comparator),this.hr=new Map}getOverlay(t,e){return Gs.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Pa();return Gs.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ht(t,e,i)})),Gs.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),Gs.resolve()}getOverlaysForCollection(t,e,n){const i=Pa(),r=e.length+1,s=new js(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Gs.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new lo(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=Pa(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Pa(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return Gs.resolve(o)}ht(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new _c(e,n));let r=this.hr.get(e);void 0===r&&(r=ja(),this.hr.set(e,r)),this.hr.set(e,r.add(n.key))}}class xl{constructor(){this.Pr=new fo(Rl.Ir),this.Tr=new fo(Rl.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new Rl(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new Rl(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new js(new Fs([])),n=new Rl(e,t),i=new Rl(e,t+1),r=[];return this.Tr.forEachInRange([n,i],(t=>{this.Ar(t),r.push(t.key)})),r}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new js(new Fs([])),n=new Rl(e,t),i=new Rl(e,t+1);let r=ja();return this.Tr.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new Rl(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Rl{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return js.comparator(t.key,e.key)||Ds(t.pr,e.pr)}static Er(t,e){return Ds(t.pr,e.pr)||js.comparator(t.key,e.key)}}class Nl{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new fo(Rl.Ir)}checkEmpty(t){return Gs.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new wc(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.wr=this.wr.add(new Rl(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Gs.resolve(s)}lookupMutationBatch(t,e){return Gs.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.br(n),r=i<0?0:i;return Gs.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Gs.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return Gs.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Rl(e,0),i=new Rl(e,Number.POSITIVE_INFINITY),r=[];return this.wr.forEachInRange([n,i],(t=>{const e=this.Sr(t.pr);r.push(e)})),Gs.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new fo(Ds);return e.forEach((t=>{const e=new Rl(t,0),i=new Rl(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,i],(t=>{n=n.add(t.pr)}))})),Gs.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;js.isDocumentKey(r)||(r=r.child(""));const s=new Rl(new js(r),0);let o=new fo(Ds);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.pr)),!0)}),s),Gs.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){vs(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Gs.forEach(e.mutations,(i=>{const r=new Rl(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new Rl(e,0),i=this.wr.firstAfterOrEqual(n);return Gs.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Gs.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Dl{constructor(t){this.vr=t,this.docs=new lo(js.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Gs.resolve(n?n.document.mutableCopy():$o.newInvalidDocument(e))}getEntries(t,e){let n=Na();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():$o.newInvalidDocument(t))})),Gs.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=Na();const s=e.path,o=new js(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||qs(Bs(o),n)<=0||(i.has(o.key)||Ca(e,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Gs.resolve(r)}getAllFromCollectionGroup(t,e,n,i){ms()}Fr(t,e){return Gs.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Ll(this)}getSize(t){return Gs.resolve(this.size)}}class Ll extends Il{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.ar.addEntry(t,i)):this.ar.removeEntry(n)})),Gs.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class Ol{constructor(t){this.persistence=t,this.Mr=new xa((t=>pa(t)),ga),this.lastRemoteSnapshotVersion=Ps.min(),this.highestTargetId=0,this.Or=0,this.Nr=new xl,this.targetCount=0,this.Br=Tl.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),Gs.resolve()}getLastRemoteSnapshotVersion(t){return Gs.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Gs.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),Gs.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),Gs.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Br=new Tl(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,Gs.resolve()}updateTargetData(t,e){return this.qn(e),Gs.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,Gs.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),Gs.waitFor(r).next((()=>i))}getTargetCount(t){return Gs.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return Gs.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),Gs.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),Gs.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),Gs.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return Gs.resolve(n)}containsKey(t,e){return Gs.resolve(this.Nr.containsKey(e))}}class Pl{constructor(t,e){this.Lr={},this.overlays={},this.kr=new io(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Ol(this),this.indexManager=new bl,this.remoteDocumentCache=function(t){return new Dl(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new vl(e),this.$r=new kl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Al,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Lr[t.toKey()];return n||(n=new Nl(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){ds("MemoryPersistence","Starting transaction:",t);const i=new Ml(this.kr.next());return this.referenceDelegate.Ur(),n(i).next((t=>this.referenceDelegate.Wr(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Gr(t,e){return Gs.or(Object.values(this.Lr).map((n=>()=>n.containsKey(t,e))))}}class Ml extends Hs{constructor(t){super(),this.currentSequenceNumber=t}}class Fl{constructor(t){this.persistence=t,this.zr=new xl,this.jr=null}static Hr(t){return new Fl(t)}get Jr(){if(this.jr)return this.jr;throw ms()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),Gs.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),Gs.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),Gs.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Gs.forEach(this.Jr,(n=>{const i=js.fromPath(n);return this.Yr(t,i).next((t=>{t||e.removeEntry(i,Ps.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return Gs.or([()=>Gs.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class Ul{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=i}static Ki(t,e){let n=ja(),i=ja();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Ul(t,e.fromCache,n,i)}}class Vl{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class jl{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){var t;const e=null===(t=E())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()||!navigator.userAgent.includes("Safari")||navigator.userAgent.includes("Chrome")?Qs.v(k())>0?6:4:8}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,i){const r={result:null};return this.ji(t,e).next((t=>{r.result=t})).next((()=>{if(!r.result)return this.Hi(t,e,i,n).next((t=>{r.result=t}))})).next((()=>{if(r.result)return;const n=new Vl;return this.Ji(t,e,n).next((i=>{if(r.result=i,this.Ui)return this.Yi(t,e,n,i.size)}))})).next((()=>r.result))}Yi(t,e,n,i){return n.documentReadCount<this.Wi?(us()<=H.DEBUG&&ds("QueryEngine","SDK will not create cache indexes for query:",Sa(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Gs.resolve()):(us()<=H.DEBUG&&ds("QueryEngine","Query:",Sa(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(us()<=H.DEBUG&&ds("QueryEngine","The SDK decides to create cache indexes for query:",Sa(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,_a(e))):Gs.resolve())}ji(t,e){if(wa(e))return Gs.resolve(null);let n=_a(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=Ea(e,null,"F"),n=_a(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=ja(...i);return this.zi.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Zi(e,i);return this.Xi(e,s,r,n.readTime)?this.ji(t,Ea(e,null,"F")):this.es(t,s,e,n)}))))})))))}Hi(t,e,n,i){return wa(e)||i.isEqual(Ps.min())?Gs.resolve(null):this.zi.getDocuments(t,n).next((r=>{const s=this.Zi(e,r);return this.Xi(e,s,n,i)?Gs.resolve(null):(us()<=H.DEBUG&&ds("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Sa(e)),this.es(t,s,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=Ps.fromTimestamp(1e9===i?new Os(n+1,0):new Os(n,i));return new zs(r,js.empty(),e)}(i,-1)).next((t=>t)))}))}Zi(t,e){let n=new fo(ka(t));return e.forEach(((e,i)=>{Ca(t,i)&&(n=n.add(i))})),n}Xi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ji(t,e,n){return us()<=H.DEBUG&&ds("QueryEngine","Using full collection scan to execute query:",Sa(e)),this.zi.getDocumentsMatchingQuery(t,e,zs.min(),n)}es(t,e,n,i){return this.zi.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Bl{constructor(t,e,n,i){this.persistence=t,this.ts=e,this.serializer=i,this.ns=new lo(Ds),this.rs=new xa((t=>pa(t)),ga),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Cl(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function zl(t,e){const n=ys(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=ja();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function ql(t){const e=ys(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}function $l(t,e){const n=ys(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Hl(t,e,n){const i=ys(t),r=i.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!Ys(t))throw t;ds("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.ns=i.ns.remove(e),i.rs.delete(r.target)}function Kl(t,e,n){const i=ys(t);let r=Ps.min(),s=ja();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=ys(t),r=i.rs.get(n);return void 0!==r?Gs.resolve(i.ns.get(r)):i.Qr.getTargetData(e,n)}(i,t,_a(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.ts.getDocumentsMatchingQuery(t,e,n?r:Ps.min(),n?s:ja()))).next((t=>(function(t,e,n){let i=t.ss.get(e)||Ps.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.ss.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,hs:s})))))}class Gl{constructor(){this.activeTargetIds=Ba}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Wl{constructor(){this.no=new Gl,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new Gl,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Ql{io(t){}shutdown(){}}class Jl{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){ds("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){ds("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Xl=null;function Yl(){return null===Xl?Xl=268435456+Math.round(2147483648*Math.random()):Xl++,"0x"+Xl.toString(16)}const Zl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class th{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const eh="WebChannelConnection";class nh extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${i}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get wo(){return!1}So(t,e,n,i,r){const s=Yl(),o=this.bo(t,e.toUriEncodedString());ds("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,i,r),this.Co(t,o,a,n).then((e=>(ds("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw ps("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,i,r,s){return this.So(t,e,n,i,r)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ls,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=Zl[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,i){const r=Yl();return new Promise(((s,o)=>{const a=new rs;a.setWithCredentials(!0),a.listenOnce(ts.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Zr.NO_ERROR:const e=a.getResponseJson();ds(eh,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(e)),s(e);break;case Zr.TIMEOUT:ds(eh,`RPC '${t}' ${r} timed out`),o(new bs(ws.DEADLINE_EXCEEDED,"Request time out"));break;case Zr.HTTP_ERROR:const n=a.getStatus();if(ds(eh,`RPC '${t}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(ws).indexOf(e)>=0?e:ws.UNKNOWN}(e.status);o(new bs(t,e.message))}else o(new bs(ws.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new bs(ws.UNAVAILABLE,"Connection failed."));break;default:ms()}}finally{ds(eh,`RPC '${t}' ${r} completed.`)}}));const c=JSON.stringify(i);ds(eh,`RPC '${t}' ${r} sending request:`,i),a.send(e,"POST",c,n,15)}))}Fo(t,e,n){const i=Yl(),r=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Xr(),o=Yr(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const l=r.join("");ds(eh,`Creating RPC '${t}' stream ${i}: ${l}`,a);const h=s.createWebChannel(l,a);let u=!1,d=!1;const f=new th({lo:e=>{d?ds(eh,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(u||(ds(eh,`Opening RPC '${t}' stream ${i} transport.`),h.open(),u=!0),ds(eh,`RPC '${t}' stream ${i} sending:`,e),h.send(e))},ho:()=>h.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(h,is.EventType.OPEN,(()=>{d||ds(eh,`RPC '${t}' stream ${i} transport opened.`)})),p(h,is.EventType.CLOSE,(()=>{d||(d=!0,ds(eh,`RPC '${t}' stream ${i} transport closed`),f.Vo())})),p(h,is.EventType.ERROR,(e=>{d||(d=!0,ps(eh,`RPC '${t}' stream ${i} transport errored:`,e),f.Vo(new bs(ws.UNAVAILABLE,"The operation could not be completed")))})),p(h,is.EventType.MESSAGE,(e=>{var n;if(!d){const r=e.data[0];vs(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){ds(eh,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=Tc[t];if(void 0!==e)return Sc(e)}(e),r=o.message;void 0===n&&(n=ws.INTERNAL,r="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new bs(n,r)),h.close()}else ds(eh,`RPC '${t}' stream ${i} received:`,r),f.mo(r)}})),p(o,es.STAT_EVENT,(e=>{e.stat===ns.PROXY?ds(eh,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===ns.NOPROXY&&ds(eh,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function ih(){return"undefined"!=typeof document?document:null}function rh(t){return new qc(t,!0)}class sh{constructor(t,e,n=1e3,i=1.5,r=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=i,this.Oo=r,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),i=Math.max(0,e-n);i>0&&ds("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,(()=>(this.Lo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class oh{constructor(t,e,n,i,r,s,o,a){this.oi=t,this.$o=n,this.Uo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new sh(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===ws.RESOURCE_EXHAUSTED?(fs(e.toString()),fs("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===ws.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new bs(ws.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return ds("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(ds("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ah extends oh{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r}a_(t,e){return this.connection.Fo("Listen",t,e)}onMessage(t){this.jo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ms()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(vs(void 0===e||"string"==typeof e),vo.fromBase64String(e||"")):(vs(void 0===e||e instanceof Uint8Array),vo.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?ws.UNKNOWN:Sc(t.code);return new bs(e,t.message||"")}(o);n=new Pc(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Zc(t,i.document.name),s=Wc(i.document.updateTime),o=i.document.createTime?Wc(i.document.createTime):Ps.min(),a=new zo({mapValue:{fields:i.document.fields}}),c=$o.newFoundDocument(r,s,o,a),l=i.targetIds||[],h=i.removedTargetIds||[];n=new Lc(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Zc(t,i.document),s=i.readTime?Wc(i.readTime):Ps.min(),o=$o.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Lc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Zc(t,i.document),s=i.removedTargetIds||[];n=new Lc([],s,r,null)}else{if(!("filter"in e))return ms();{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:r}=t,s=new Ec(i,r),o=t.targetId;n=new Oc(o,s)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ps.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Ps.min():e.readTime?Wc(e.readTime):Ps.min()}(t);return this.listener.u_(e,n)}c_(t){const e={};e.database=el(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=ma(i)?{documents:rl(t,i)}:{query:sl(t,i).ut},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=Kc(t,e.resumeToken);const i=$c(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(Ps.min())>0){n.readTime=Hc(t,e.snapshotVersion.toTimestamp());const i=$c(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ms()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.t_(e)}l_(t){const e={};e.database=el(this.serializer),e.removeTarget=t,this.t_(e)}}class ch extends oh{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(vs(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(vs(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Wc(t.updateTime):Wc(e);return n.isEqual(Ps.min())&&(n=Wc(e)),new ic(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Wc(t.commitTime);return this.listener.T_(n,e)}return vs(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=el(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof dc)n={update:il(t,e.key,e.value)};else if(e instanceof vc)n={delete:Yc(t,e.key)};else if(e instanceof fc)n={update:il(t,e.key,e.data),updateMask:pl(e.fieldMask)};else{if(!(e instanceof yc))return ms();n={verify:Yc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Qa)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ja)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ya)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof tc)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw ms()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Gc(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ms()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class lh extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new bs(ws.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.So(t,Jc(e,n),i,r,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ws.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new bs(ws.UNKNOWN,t.toString())}))}vo(t,e,n,i,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(t,Jc(e,n),i,s,o,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===ws.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new bs(ws.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class hh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(fs(e),this.g_=!1):ds("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class uh{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=r,this.M_.io((t=>{n.enqueueAndForget((async()=>{bh(this)&&(ds("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=ys(t);e.v_.add(4),await fh(e),e.x_.set("Unknown"),e.v_.delete(4),await dh(e)}(this))}))})),this.x_=new hh(n,i)}}async function dh(t){if(bh(t))for(const e of t.F_)await e(!0)}async function fh(t){for(const e of t.F_)await e(!1)}function ph(t,e){const n=ys(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),wh(n)?yh(n):Fh(n).Jo()&&mh(n,e))}function gh(t,e){const n=ys(t),i=Fh(n);n.C_.delete(e),i.Jo()&&vh(n,e),0===n.C_.size&&(i.Jo()?i.Xo():bh(n)&&n.x_.set("Unknown"))}function mh(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ps.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fh(t).c_(e)}function vh(t,e){t.O_.Oe(e),Fh(t).l_(e)}function yh(t){t.O_=new Fc({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Fh(t).start(),t.x_.p_()}function wh(t){return bh(t)&&!Fh(t).Ho()&&t.C_.size>0}function bh(t){return 0===ys(t).v_.size}function _h(t){t.O_=void 0}async function Eh(t){t.C_.forEach(((e,n)=>{mh(t,e)}))}async function Th(t,e){_h(t),wh(t)?(t.x_.S_(e),yh(t)):t.x_.set("Unknown")}async function Ih(t,e,n){if(t.x_.set("Online"),e instanceof Pc&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.C_.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.C_.delete(i),t.O_.removeTarget(i))}(t,e)}catch(n){ds("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Sh(t,n)}else if(e instanceof Lc?t.O_.$e(e):e instanceof Oc?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(Ps.min()))try{const e=await ql(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.O_.it(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.C_.get(i);r&&t.C_.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.C_.get(e);if(!i)return;t.C_.set(e,i.withResumeToken(vo.EMPTY_BYTE_STRING,i.snapshotVersion)),vh(t,e);const r=new ml(i.target,e,n,i.sequenceNumber);mh(t,r)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){ds("RemoteStore","Failed to raise snapshot:",e),await Sh(t,e)}}async function Sh(t,e,n){if(!Ys(e))throw e;t.v_.add(1),await fh(t),t.x_.set("Offline"),n||(n=()=>ql(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{ds("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await dh(t)}))}function Ch(t,e){return e().catch((n=>Sh(t,n,e)))}async function kh(t){const e=ys(t),n=Uh(e);let i=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;Ah(e);)try{const t=await $l(e.localStore,i);if(null===t){0===e.D_.length&&n.Xo();break}i=t.batchId,xh(e,t)}catch(t){await Sh(e,t)}Rh(e)&&Nh(e)}function Ah(t){return bh(t)&&t.D_.length<10}function xh(t,e){t.D_.push(e);const n=Uh(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function Rh(t){return bh(t)&&!Uh(t).Ho()&&t.D_.length>0}function Nh(t){Uh(t).start()}async function Dh(t){Uh(t).d_()}async function Lh(t){const e=Uh(t);for(const n of t.D_)e.I_(n.mutations)}async function Oh(t,e,n){const i=t.D_.shift(),r=bc.from(i,e,n);await Ch(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await kh(t)}async function Ph(t,e){e&&Uh(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return ms();case ws.CANCELLED:case ws.UNKNOWN:case ws.DEADLINE_EXCEEDED:case ws.RESOURCE_EXHAUSTED:case ws.INTERNAL:case ws.UNAVAILABLE:case ws.UNAUTHENTICATED:return!1;case ws.INVALID_ARGUMENT:case ws.NOT_FOUND:case ws.ALREADY_EXISTS:case ws.PERMISSION_DENIED:case ws.FAILED_PRECONDITION:case ws.ABORTED:case ws.OUT_OF_RANGE:case ws.UNIMPLEMENTED:case ws.DATA_LOSS:return!0}}(t)&&t!==ws.ABORTED}(e.code)){const n=t.D_.shift();Uh(t).Zo(),await Ch(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await kh(t)}}(t,e),Rh(t)&&Nh(t)}async function Mh(t,e){const n=ys(t);n.asyncQueue.verifyOperationInProgress(),ds("RemoteStore","RemoteStore received new credentials");const i=bh(n);n.v_.add(3),await fh(n),i&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await dh(n)}function Fh(t){return t.N_||(t.N_=function(t,e,n){const i=ys(t);return i.R_(),new ah(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:Eh.bind(null,t),To:Th.bind(null,t),u_:Ih.bind(null,t)}),t.F_.push((async e=>{e?(t.N_.Zo(),wh(t)?yh(t):t.x_.set("Unknown")):(await t.N_.stop(),_h(t))}))),t.N_}function Uh(t){return t.B_||(t.B_=function(t,e,n){const i=ys(t);return i.R_(),new ch(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:Dh.bind(null,t),To:Ph.bind(null,t),E_:Lh.bind(null,t),T_:Oh.bind(null,t)}),t.F_.push((async e=>{e?(t.B_.Zo(),await kh(t)):(await t.B_.stop(),t.D_.length>0&&(ds("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}class Vh{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new _s,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new Vh(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new bs(ws.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jh(t,e){if(fs("AsyncQueue",`${e}: ${t}`),Ys(t))return new bs(ws.UNAVAILABLE,`${e}: ${t}`);throw t}class Bh{constructor(t){this.comparator=t?(e,n)=>t(e,n)||js.comparator(e.key,n.key):(t,e)=>js.comparator(t.key,e.key),this.keyedMap=La(),this.sortedSet=new lo(this.comparator)}static emptySet(t){return new Bh(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Bh))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Bh;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class zh{constructor(){this.L_=new lo(js.comparator)}track(t){const e=t.doc.key,n=this.L_.get(e);n?0!==t.type&&3===n.type?this.L_=this.L_.insert(e,t):3===t.type&&1!==n.type?this.L_=this.L_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.L_=this.L_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.L_=this.L_.remove(e):1===t.type&&2===n.type?this.L_=this.L_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.L_=this.L_.insert(e,{type:2,doc:t.doc}):ms():this.L_=this.L_.insert(e,t)}k_(){const t=[];return this.L_.inorderTraversal(((e,n)=>{t.push(n)})),t}}class qh{constructor(t,e,n,i,r,s,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new qh(t,e,Bh.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ta(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class $h{constructor(){this.q_=void 0,this.Q_=[]}}class Hh{constructor(){this.queries=new xa((t=>Ia(t)),Ta),this.onlineState="Unknown",this.K_=new Set}}async function Kh(t,e){const n=ys(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new $h),r)try{s.q_=await n.onListen(i)}catch(t){const n=jh(t,`Initialization of query '${Sa(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&Jh(n)}async function Gh(t,e){const n=ys(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.Q_.indexOf(e);t>=0&&(s.Q_.splice(t,1),r=0===s.Q_.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function Wh(t,e){const n=ys(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.Q_)e.W_(t)&&(i=!0);r.q_=t}}i&&Jh(n)}function Qh(t,e,n){const i=ys(t),r=i.queries.get(e);if(r)for(const t of r.Q_)t.onError(n);i.queries.delete(e)}function Jh(t){t.K_.forEach((t=>{t.next()}))}class Xh{constructor(t,e,n){this.query=t,this.G_=e,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}W_(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new qh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.z_?this.H_(t)&&(this.G_.next(t),e=!0):this.J_(t,this.onlineState)&&(this.Y_(t),e=!0),this.j_=t,e}onError(t){this.G_.error(t)}U_(t){this.onlineState=t;let e=!1;return this.j_&&!this.z_&&this.J_(this.j_,t)&&(this.Y_(this.j_),e=!0),e}J_(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Z_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}H_(t){if(t.docChanges.length>0)return!0;const e=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}Y_(t){t=qh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.z_=!0,this.G_.next(t)}}class Yh{constructor(t){this.key=t}}class Zh{constructor(t){this.key=t}}class tu{constructor(t,e){this.query=t,this.oa=e,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=ja(),this.mutatedKeys=ja(),this.ua=ka(t),this.ca=new Bh(this.ua)}get la(){return this.oa}ha(t,e){const n=e?e.Pa:new zh,i=e?e.ca:this.ca;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const l=i.get(t),h=Ca(this.query,e)?e:null,u=!!l&&this.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;l&&h?l.data.isEqual(h.data)?u!==d&&(n.track({type:3,doc:h}),f=!0):this.Ia(l,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.ua(h,a)>0||c&&this.ua(h,c)<0)&&(o=!0)):!l&&h?(n.track({type:0,doc:h}),f=!0):l&&!h&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(o=!0)),f&&(h?(s=s.add(h),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{ca:s,Pa:n,Xi:o,mutatedKeys:r}}Ia(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const r=this.ca;this.ca=t.ca,this.mutatedKeys=t.mutatedKeys;const s=t.Pa.k_();s.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ms()}};return n(t)-n(e)}(t.type,e.type)||this.ua(t.doc,e.doc))),this.Ta(n),i=null!=i&&i;const o=e&&!i?this.Ea():[],a=0===this.aa.size&&this.current&&!i?1:0,c=a!==this._a;return this._a=a,0!==s.length||c?{snapshot:new qh(this.query,t.ca,r,s,t.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),da:o}:{da:o}}U_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new zh,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(t){return!this.oa.has(t)&&!!this.ca.has(t)&&!this.ca.get(t).hasLocalMutations}Ta(t){t&&(t.addedDocuments.forEach((t=>this.oa=this.oa.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.oa=this.oa.delete(t))),this.current=t.current)}Ea(){if(!this.current)return[];const t=this.aa;this.aa=ja(),this.ca.forEach((t=>{this.Aa(t.key)&&(this.aa=this.aa.add(t.key))}));const e=[];return t.forEach((t=>{this.aa.has(t)||e.push(new Zh(t))})),this.aa.forEach((n=>{t.has(n)||e.push(new Yh(n))})),e}Ra(t){this.oa=t.hs,this.aa=ja();const e=this.ha(t.documents);return this.applyChanges(e,!0)}Va(){return qh.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class eu{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class nu{constructor(t){this.key=t,this.ma=!1}}class iu{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new xa((t=>Ia(t)),Ta),this.pa=new Map,this.ya=new Set,this.wa=new lo(js.comparator),this.Sa=new Map,this.ba=new xl,this.Da={},this.Ca=new Map,this.va=Tl.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}async function ru(t,e){const n=function(t){const e=ys(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ou.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bu.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cu.bind(null,e),e.fa.u_=Wh.bind(null,e.eventManager),e.fa.xa=Qh.bind(null,e.eventManager),e}(t);let i,r;const s=n.ga.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.Va();else{const t=await function(t,e){const n=ys(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Qr.getTargetData(t,e).next((r=>r?(i=r,Gs.resolve(i)):n.Qr.allocateTargetId(t).next((r=>(i=new ml(e,r,"TargetPurposeListen",t.currentSequenceNumber),n.Qr.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.ns.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(t.targetId,t),n.rs.set(e,t.targetId)),t}))}(n.localStore,_a(e)),s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await async function(t,e,n,i,r){t.Ma=(e,n,i)=>async function(t,e,n,i){let r=e.view.ha(n);r.Xi&&(r=await Kl(t.localStore,e.query,!1).then((({documents:t})=>e.view.ha(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=i&&null!=i.targetMismatches.get(e.targetId),a=e.view.applyChanges(r,t.isPrimaryClient,s,o);return gu(t,e.targetId,a.da),a.snapshot}(t,e,n,i);const s=await Kl(t.localStore,e,!0),o=new tu(e,s.hs),a=o.ha(s.documents),c=Dc.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),l=o.applyChanges(a,t.isPrimaryClient,c);gu(t,n,l.da);const h=new eu(e,n,o);return t.ga.set(e,h),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),l.snapshot}(n,e,i,"current"===s,t.resumeToken),n.isPrimaryClient&&ph(n.remoteStore,t)}return r}async function su(t,e){const n=ys(t),i=n.ga.get(e),r=n.pa.get(i.targetId);if(r.length>1)return n.pa.set(i.targetId,r.filter((t=>!Ta(t,e)))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Hl(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),gh(n.remoteStore,i.targetId),fu(n,i.targetId)})).catch(Ks)):(fu(n,i.targetId),await Hl(n.localStore,i.targetId,!0))}async function ou(t,e){const n=ys(t);try{const t=await function(t,e){const n=ys(t),i=e.snapshotVersion;let r=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.os.newChangeBuffer({trackRemovals:!0});r=n.ns;const o=[];e.targetChanges.forEach(((s,a)=>{const c=r.get(a);if(!c)return;o.push(n.Qr.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(t,s.addedDocuments,a))));let l=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?l=l.withResumeToken(vo.EMPTY_BYTE_STRING,Ps.min()).withLastLimboFreeSnapshotVersion(Ps.min()):s.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(s.resumeToken,i)),r=r.insert(a,l),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,s)&&o.push(n.Qr.updateTargetData(t,l))}));let a=Na(),c=ja();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n){let i=ja(),r=ja();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=Na();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(Ps.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):ds("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{cs:i,ls:r}}))}(t,s,e.documentUpdates).next((t=>{a=t.cs,c=t.ls}))),!i.isEqual(Ps.min())){const e=n.Qr.getLastRemoteSnapshotVersion(t).next((e=>n.Qr.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return Gs.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.ns=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Sa.get(e);i&&(vs(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.ma=!0:t.modifiedDocuments.size>0?vs(i.ma):t.removedDocuments.size>0&&(vs(i.ma),i.ma=!1))})),await yu(n,t,e)}catch(t){await Ks(t)}}function au(t,e,n){const i=ys(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ga.forEach(((n,i)=>{const r=i.view.U_(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=ys(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.U_(e)&&(i=!0)})),i&&Jh(n)}(i.eventManager,e),t.length&&i.fa.u_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function cu(t,e,n){const i=ys(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Sa.get(e),s=r&&r.key;if(s){let t=new lo(js.comparator);t=t.insert(s,$o.newNoDocument(s,Ps.min()));const n=ja().add(s),r=new Nc(Ps.min(),new Map,new lo(Ds),t,n);await ou(i,r),i.wa=i.wa.remove(s),i.Sa.delete(e),vu(i)}else await Hl(i.localStore,e,!1).then((()=>fu(i,e,n))).catch(Ks)}async function lu(t,e){const n=ys(t),i=e.batch.batchId;try{const t=await function(t,e){const n=ys(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=Gs.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);vs(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=ja();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);du(n,i,null),uu(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await yu(n,t)}catch(t){await Ks(t)}}async function hu(t,e,n){const i=ys(t);try{const t=await function(t,e){const n=ys(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(vs(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);du(i,e,n),uu(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await yu(i,t)}catch(n){await Ks(n)}}function uu(t,e){(t.Ca.get(e)||[]).forEach((t=>{t.resolve()})),t.Ca.delete(e)}function du(t,e,n){const i=ys(t);let r=i.Da[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Da[i.currentUser.toKey()]=r}}function fu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.pa.get(e))t.ga.delete(i),n&&t.fa.xa(i,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach((e=>{t.ba.containsKey(e)||pu(t,e)}))}function pu(t,e){t.ya.delete(e.path.canonicalString());const n=t.wa.get(e);null!==n&&(gh(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),vu(t))}function gu(t,e,n){for(const i of n)i instanceof Yh?(t.ba.addReference(i.key,e),mu(t,i)):i instanceof Zh?(ds("SyncEngine","Document no longer in limbo: "+i.key),t.ba.removeReference(i.key,e),t.ba.containsKey(i.key)||pu(t,i.key)):ms()}function mu(t,e){const n=e.key,i=n.path.canonicalString();t.wa.get(n)||t.ya.has(i)||(ds("SyncEngine","New document in limbo: "+n),t.ya.add(i),vu(t))}function vu(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){const e=t.ya.values().next().value;t.ya.delete(e);const n=new js(Fs.fromString(e)),i=t.va.next();t.Sa.set(i,new nu(n)),t.wa=t.wa.insert(n,i),ph(t.remoteStore,new ml(_a(ya(n.path)),i,"TargetPurposeLimboResolution",io._e))}}async function yu(t,e,n){const i=ys(t),r=[],s=[],o=[];i.ga.isEmpty()||(i.ga.forEach(((t,a)=>{o.push(i.Ma(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=Ul.Ki(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.fa.u_(r),await async function(t,e){const n=ys(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Gs.forEach(e,(e=>Gs.forEach(e.qi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Gs.forEach(e.Qi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!Ys(t))throw t;ds("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.ns=n.ns.insert(e,r)}}}(i.localStore,s))}async function wu(t,e){const n=ys(t);if(!n.currentUser.isEqual(e)){ds("SyncEngine","User change. New user:",e.toKey());const t=await zl(n.localStore,e);n.currentUser=e,function(t,e){t.Ca.forEach((t=>{t.forEach((t=>{t.reject(new bs(ws.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ca.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await yu(n,t.us)}}function bu(t,e){const n=ys(t),i=n.Sa.get(e);if(i&&i.ma)return ja().add(i.key);{let t=ja();const i=n.pa.get(e);if(!i)return t;for(const e of i){const i=n.ga.get(e);t=t.unionWith(i.view.la)}return t}}function _u(t){const e=ys(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lu.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hu.bind(null,e),e}class Eu{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=rh(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,i){return new Bl(t,e,n,i)}(this.persistence,new jl,t.initialUser,this.serializer)}createPersistence(t){return new Pl(Fl.Hr,this.serializer)}createSharedClientState(t){return new Wl}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Tu{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>au(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=wu.bind(null,this.syncEngine),await async function(t,e){const n=ys(t);e?(n.v_.delete(2),await dh(n)):e||(n.v_.add(2),await fh(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Hh}createDatastore(t){const e=rh(t.databaseInfo.databaseId),n=function(t){return new nh(t)}(t.databaseInfo);return function(t,e,n,i){return new lh(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new uh(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,(t=>au(this.syncEngine,t,0)),Jl.D()?new Jl:new Ql)}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new iu(t,e,n,i,r,s);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=ys(t);ds("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await fh(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class Iu{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ba(this.observer.next,t)}error(t){this.observer.error?this.Ba(this.observer.error,t):fs("Uncaught Error in snapshot listener:",t.toString())}La(){this.muted=!0}Ba(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class Su{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=cs.UNAUTHENTICATED,this.clientId=Ns.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{ds("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(ds("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new bs(ws.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new _s;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=jh(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Cu(t,e){t.asyncQueue.verifyOperationInProgress(),ds("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await zl(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function ku(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ds("FirestoreClient","Using user provided OfflineComponentProvider");try{await Cu(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===ws.FAILED_PRECONDITION||t.code===ws.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;ps("Error using user provided cache. Falling back to memory cache: "+n),await Cu(t,new Eu)}}else ds("FirestoreClient","Using default OfflineComponentProvider"),await Cu(t,new Eu);return t._offlineComponents}(t);ds("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>Mh(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Mh(e.remoteStore,n))),t._onlineComponents=e}async function Au(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ds("FirestoreClient","Using user provided OnlineComponentProvider"),await ku(t,t._uninitializedComponentsProvider._online)):(ds("FirestoreClient","Using default OnlineComponentProvider"),await ku(t,new Tu))),t._onlineComponents}async function xu(t){const e=await Au(t),n=e.eventManager;return n.onListen=ru.bind(null,e.syncEngine),n.onUnlisten=su.bind(null,e.syncEngine),n}function Ru(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Nu=new Map;function Du(t,e,n){if(!n)throw new bs(ws.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Lu(t){if(!js.isDocumentKey(t))throw new bs(ws.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ou(t){if(js.isDocumentKey(t))throw new bs(ws.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Pu(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":ms()}function Mu(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new bs(ws.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Pu(t);throw new bs(ws.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Fu{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new bs(ws.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new bs(ws.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new bs(ws.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ru(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new bs(ws.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new bs(ws.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new bs(ws.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Uu{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new bs(ws.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new bs(ws.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fu(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Ts;switch(t.type){case"firstParty":return new ks(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new bs(ws.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Nu.get(t);e&&(ds("ComponentProvider","Removing Datastore"),Nu.delete(t),e.terminate())}(this),Promise.resolve()}}class Vu{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Vu(this.firestore,t,this._query)}}class ju{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bu(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new ju(this.firestore,t,this._key)}}class Bu extends Vu{constructor(t,e,n){super(t,e,ya(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ju(this.firestore,null,new js(t))}withConverter(t){return new Bu(this.firestore,t,this._path)}}function zu(t,e,...n){if(t=V(t),Du("collection","path",e),t instanceof Uu){const i=Fs.fromString(e,...n);return Ou(i),new Bu(t,null,i)}{if(!(t instanceof ju||t instanceof Bu))throw new bs(ws.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Fs.fromString(e,...n));return Ou(i),new Bu(t.firestore,null,i)}}function qu(t,e,...n){if(t=V(t),1===arguments.length&&(e=Ns.newId()),Du("doc","path",e),t instanceof Uu){const i=Fs.fromString(e,...n);return Lu(i),new ju(t,null,new js(i))}{if(!(t instanceof ju||t instanceof Bu))throw new bs(ws.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Fs.fromString(e,...n));return Lu(i),new ju(t.firestore,t instanceof Bu?t.converter:null,new js(i))}}class $u{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new sh(this,"async_queue_retry"),this._u=()=>{const t=ih();t&&ds("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=ih();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const e=ih();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise((()=>{}));const e=new _s;return this.uu((()=>this.tu&&this.su?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.eu.push(t),this.cu())))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!Ys(t))throw t;ds("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo((()=>this.cu()))}}uu(t){const e=this.Xa.then((()=>(this.iu=!0,t().catch((t=>{this.ru=t,this.iu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw fs("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.iu=!1,t))))));return this.Xa=e,e}enqueueAfterDelay(t,e,n){this.au(),this.ou.indexOf(t)>-1&&(e=0);const i=Vh.createAndSchedule(this,t,e,n,(t=>this.lu(t)));return this.nu.push(i),i}au(){this.ru&&ms()}verifyOperationInProgress(){}async hu(){let t;do{t=this.Xa,await t}while(t!==this.Xa)}Pu(t){for(const e of this.nu)if(e.timerId===t)return!0;return!1}Iu(t){return this.hu().then((()=>{this.nu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.hu()}))}Tu(t){this.ou.push(t)}lu(t){const e=this.nu.indexOf(t);this.nu.splice(e,1)}}class Hu extends Uu{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new $u,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Gu(this),this._firestoreClient.terminate()}}function Ku(t){return t._firestoreClient||Gu(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Gu(t){var e,n,i;const r=t._freezeSettings(),s=function(t,e,n,i){return new So(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Ru(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new Su(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}class Wu{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Wu(vo.fromBase64String(t))}catch(t){throw new bs(ws.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Wu(vo.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Qu{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new bs(ws.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vs(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ju{constructor(t){this._methodName=t}}class Xu{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new bs(ws.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new bs(ws.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Ds(this._lat,t._lat)||Ds(this._long,t._long)}}const Yu=/^__.*__$/;class Zu{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new fc(t,this.data,this.fieldMask,e,this.fieldTransforms):new dc(t,this.data,e,this.fieldTransforms)}}class td{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new fc(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function ed(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ms()}}class nd{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Eu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new nd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.mu(t),i}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Au({path:n,Vu:!1});return i.Eu(),i}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return pd(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(ed(this.du)&&Yu.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class id{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||rh(t)}Su(t,e,n,i=!1){return new nd({du:t,methodName:e,wu:n,path:Vs.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rd(t){const e=t._freezeSettings(),n=rh(t._databaseId);return new id(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sd(t,e,n,i,r,s={}){const o=t.Su(s.merge||s.mergeFields?2:0,e,n,r);hd("Data must be an object, but it was:",o,i);const a=cd(i,o);let c,l;if(s.merge)c=new go(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=ud(e,i,n);if(!o.contains(r))throw new bs(ws.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);gd(t,r)||t.push(r)}c=new go(t),l=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=o.fieldTransforms;return new Zu(new zo(a),c,l)}class od extends Ju{_toFieldTransform(t){if(2!==t.du)throw 1===t.du?t.pu(`${this._methodName}() can only appear at the top level of your update data`):t.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof od}}function ad(t,e){if(ld(t=V(t)))return hd("Unsupported field value:",e,t),cd(t,e);if(t instanceof Ju)return function(t,e){if(!ed(e.du))throw e.pu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.pu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&4!==e.du)throw e.pu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=ad(r,e.gu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=V(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return $a(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Os.fromDate(t);return{timestampValue:Hc(e.serializer,n)}}if(t instanceof Os){const n=new Os(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Hc(e.serializer,n)}}if(t instanceof Xu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Wu)return{bytesValue:Kc(e.serializer,t._byteString)};if(t instanceof ju){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.pu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Qc(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.pu(`Unsupported field value: ${Pu(t)}`)}(t,e)}function cd(t,e){const n={};return co(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ao(t,((t,i)=>{const r=ad(i,e.Ru(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function ld(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Os||t instanceof Xu||t instanceof Wu||t instanceof ju||t instanceof Ju)}function hd(t,e,n){if(!ld(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Pu(n);throw"an object"===i?e.pu(t+" a custom object"):e.pu(t+" "+i)}}function ud(t,e,n){if((e=V(e))instanceof Qu)return e._internalPath;if("string"==typeof e)return fd(t,e);throw pd("Field path arguments must be of type string or ",t,!1,void 0,n)}const dd=new RegExp("[~\\*/\\[\\]]");function fd(t,e,n){if(e.search(dd)>=0)throw pd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qu(...e.split("."))._internalPath}catch(i){throw pd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function pd(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new bs(ws.INVALID_ARGUMENT,a+t+c)}function gd(t,e){return t.some((t=>t.isEqual(e)))}class md{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new ju(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new vd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(yd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class vd extends md{data(){return super.data()}}function yd(t,e){return"string"==typeof e?fd(t,e):e instanceof Qu?e._internalPath:e._delegate._internalPath}class wd{convertValue(t,e="none"){switch(Ao(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bo(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(_o(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ms()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return ao(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Xu(bo(t.latitude),bo(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=To(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Io(t));default:return null}}convertTimestamp(t){const e=wo(t);return new Os(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Fs.fromString(t);vs(gl(n));const i=new Co(n.get(1),n.get(3)),r=new js(n.popFirst(5));return i.isEqual(e)||fs(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}function bd(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class _d{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Ed extends md{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Td(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(yd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class Td extends Ed{data(t={}){return super.data(t)}}class Id{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new _d(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Td(this._firestore,this._userDataWriter,n.key,n,new _d(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new bs(ws.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new Td(t._firestore,t._userDataWriter,n.doc.key,n.doc,new _d(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new Td(t._firestore,t._userDataWriter,e.doc.key,e.doc,new _d(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:Sd(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Sd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ms()}}class Cd extends wd{constructor(t){super(),this.firestore=t}convertBytes(t){return new Wu(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ju(this.firestore,null,e)}}function kd(t){t=Mu(t,Vu);const e=Mu(t.firestore,Hu),n=Ku(e),i=new Cd(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new bs(ws.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),function(t,e,n={}){const i=new _s;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const s=new Iu({next:n=>{e.enqueueAndForget((()=>Gh(t,o))),n.fromCache&&"server"===i.source?r.reject(new bs(ws.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:t=>r.reject(t)}),o=new Xh(n,s,{includeMetadataChanges:!0,Z_:!0});return Kh(t,o)}(await xu(t),t.asyncQueue,e,n,i))),i.promise}(n,t._query).then((n=>new Id(e,i,t,n)))}function Ad(t,e){const n=Mu(t.firestore,Hu),i=qu(t),r=bd(t.converter,e);return xd(n,[sd(rd(t.firestore),"addDoc",i._key,r,null!==t.converter,{}).toMutation(i._key,rc.exists(!1))]).then((()=>i))}function xd(t,e){return function(t,e){const n=new _s;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=_u(t);try{const t=await function(t,e){const n=ys(t),i=Os.now(),r=e.reduce(((t,e)=>t.add(e.key)),ja());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Na(),c=ja();return n.os.getEntries(t,r).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((r=>{s=r;const o=[];for(const t of e){const e=hc(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new fc(t.key,e,qo(e.value.mapValue),rc.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:Oa(s)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Da[t.currentUser.toKey()];i||(i=new lo(Ds)),i=i.insert(e,n),t.Da[t.currentUser.toKey()]=i}(i,t.batchId,n),await yu(i,t.changes),await kh(i.remoteStore)}catch(t){const e=jh(t,"Failed to persist write");n.reject(e)}}(await function(t){return Au(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Ku(t),e)}function Rd(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}new WeakMap,function(t,e=!0){!function(t){ls=t}(kt),Tt(new j("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Hu(new Ss(t.getProvider("auth-internal")),new xs(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new bs(ws.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Co(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Rt(as,"4.4.1",t),Rt(as,"4.4.1","esm2017")}(),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Nd=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Dd=new R("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ld=new J("@firebase/auth");function Od(t,...e){Ld.logLevel<=H.ERROR&&Ld.error(`Auth (${kt}): ${t}`,...e)}function Pd(t,...e){throw Fd(t,...e)}function Md(t,...e){return Fd(t,...e)}function Fd(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return Dd.create(t,...e)}function Ud(t,e,...n){if(!t)throw Fd(e,...n)}function Vd(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Od(e),new Error(e)}function jd(t,e){t||Vd(e)}function Bd(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function zd(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function qd(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===zd()||"https:"===zd()||function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class $d{constructor(t,e){this.shortDelay=t,this.longDelay=e,jd(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(k())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return qd()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Hd(t,e){jd(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Kd{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Vd("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Vd("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Vd("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Gd={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Wd=new $d(3e4,6e4);function Qd(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Jd(t,e,n,i,r={}){return Xd(t,r,(async()=>{let r={},s={};i&&("GET"===e?s=i:r={body:JSON.stringify(i)});const o=O(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),Kd.fetch()(Zd(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Xd(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},Gd),e);try{const e=new ef(t),r=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw nf(t,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const e=r.ok?s.errorMessage:s.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw nf(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw nf(t,"email-already-in-use",s);if("USER_DISABLED"===n)throw nf(t,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const i=Object.assign(Object.assign({},Nd()),{[e]:n});return new R("auth","Firebase",i).create(e,{appName:t.name})}(t,a,o);Pd(t,a)}}catch(e){if(e instanceof x)throw e;Pd(t,"network-request-failed",{message:String(e)})}}async function Yd(t,e,n,i,r={}){const s=await Jd(t,e,n,i,r);return"mfaPendingCredential"in s&&Pd(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Zd(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?Hd(t.config,r):`${t.config.apiScheme}://${r}`}function tf(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ef{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Md(this.auth,"network-request-failed"))),Wd.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function nf(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Md(t,e,i);return r.customData._tokenResponse=n,r}function rf(t){return void 0!==t&&void 0!==t.enterprise}class sf{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return tf(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}function of(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function af(t){return 1e3*Number(t)}function cf(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return Od("JWT malformed, contained fewer than 3 sections"),null;try{const t=_(n);return t?JSON.parse(t):(Od("Failed to decode base64 JWT payload"),null)}catch(t){return Od("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}async function lf(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof x&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class hf{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class uf{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=of(this.lastLoginAt),this.creationTime=of(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function df(t){var e;const n=t.auth,i=await t.getIdToken(),r=await lf(t,async function(t,e){return Jd(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));Ud(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(null===(e=s.providerUserInfo)||void 0===e?void 0:e.length)?s.providerUserInfo.map((t=>{var{providerId:e}=t,n=Rd(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=t.providerData,l=o,[...c.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var c,l;const h=t.isAnonymous,u=!(t.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!h&&u,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new uf(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}class ff{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Ud(t.idToken,"internal-error"),Ud(void 0!==t.idToken,"internal-error"),Ud(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=cf(t);return Ud(e,"internal-error"),Ud(void 0!==e.exp,"internal-error"),Ud(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return Ud(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(t,e){const n=await Xd(t,{},(async()=>{const n=O({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,s=Zd(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Kd.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new ff;return n&&(Ud("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(Ud("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(Ud("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new ff,this.toJSON())}_performRefresh(){return Vd("not implemented")}}function pf(t,e){Ud("string"==typeof t||void 0===t,"internal-error",{appName:e})}class gf{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=Rd(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new hf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new uf(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await lf(this,this.stsTokenManager.getToken(this.auth,t));return Ud(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=V(t),i=await n.getIdToken(e),r=cf(i);Ud(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:of(af(r.auth_time)),issuedAtTime:of(af(r.iat)),expirationTime:of(af(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=V(t);await df(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Ud(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new gf(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Ud(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await df(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await lf(this,async function(t,e){return Jd(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,c,l;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,u=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,v=null!==(l=e.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:w,isAnonymous:b,providerData:_,stsTokenManager:E}=e;Ud(y&&E,t,"internal-error");const T=ff.fromJSON(this.name,E);Ud("string"==typeof y,t,"internal-error"),pf(h,t.name),pf(u,t.name),Ud("boolean"==typeof w,t,"internal-error"),Ud("boolean"==typeof b,t,"internal-error"),pf(d,t.name),pf(f,t.name),pf(p,t.name),pf(g,t.name),pf(m,t.name),pf(v,t.name);const I=new gf({uid:y,auth:t,email:u,emailVerified:w,displayName:h,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:v});return _&&Array.isArray(_)&&(I.providerData=_.map((t=>Object.assign({},t)))),g&&(I._redirectEventId=g),I}static async _fromIdTokenResponse(t,e,n=!1){const i=new ff;i.updateFromServerResponse(e);const r=new gf({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await df(r),r}}const mf=new Map;function vf(t){jd(t instanceof Function,"Expected a class definition");let e=mf.get(t);return e?(jd(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,mf.set(t,e),e)}class yf{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}yf.type="NONE";const wf=yf;function bf(t,e,n){return`firebase:${t}:${e}:${n}`}class _f{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=bf(this.userKey,i.apiKey,r),this.fullPersistenceKey=bf("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?gf._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new _f(vf(wf),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||vf(wf);const s=bf(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=gf._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new _f(r,t,n)):new _f(r,t,n)}}function Ef(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Cf(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Tf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Af(e))return"Blackberry";if(xf(e))return"Webos";if(If(e))return"Safari";if((e.includes("chrome/")||Sf(e))&&!e.includes("edge/"))return"Chrome";if(kf(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Tf(t=k()){return/firefox\//i.test(t)}function If(t=k()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Sf(t=k()){return/crios\//i.test(t)}function Cf(t=k()){return/iemobile/i.test(t)}function kf(t=k()){return/android/i.test(t)}function Af(t=k()){return/blackberry/i.test(t)}function xf(t=k()){return/webos/i.test(t)}function Rf(t=k()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Nf(t=k()){return Rf(t)||kf(t)||xf(t)||Af(t)||/windows phone/i.test(t)||Cf(t)}function Df(t,e=[]){let n;switch(t){case"Browser":n=Ef(k());break;case"Worker":n=`${Ef(k())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${kt}/${i}`}class Lf{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class Of{constructor(t){var e,n,i,r;const s=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=s.minPasswordLength)&&void 0!==e?e:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=t.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}class Pf{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ff(this),this.idTokenSubscription=new Ff(this),this.beforeStateQueue=new Lf(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=vf(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await _f.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ud(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await df(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?V(t):null;return e&&Ud(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Ud(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(vf(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return Jd(t,"GET","/v2/passwordPolicy",Qd(t,e))}(this),e=new Of(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new R("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return Jd(t,"POST","/v2/accounts:revokeToken",Qd(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&vf(t)||this._popupRedirectResolver;Ud(e,this,"argument-error"),this.redirectPersistenceManager=await _f.create(this,[vf(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ud(o,this,"internal-error"),o.then((()=>{s||r(this.currentUser)})),"function"==typeof e){const r=t.addObserver(e,n,i);return()=>{s=!0,r()}}{const n=t.addObserver(e);return()=>{s=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Ud(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Df(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){Ld.logLevel<=H.WARN&&Ld.warn(`Auth (${kt}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function Mf(t){return V(t)}class Ff{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new F(t,void 0);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return Ud(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Uf(t){return new Promise(((e,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=Md("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)}))}function Vf(t){return`__${t}${Math.floor(1e6*Math.random())}`}class jf{constructor(t){this.type="recaptcha-enterprise",this.auth=Mf(t)}async verify(t="verify",e=!1){function n(e,n,i){const r=window.grecaptcha;rf(r)?r.enterprise.ready((()=>{r.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{(async function(t,e){return Jd(t,"GET","/v2/recaptchaConfig",Qd(t,e))})(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new sf(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((r=>{if(!e&&rf(window.grecaptcha))n(r,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));Uf("https://www.google.com/recaptcha/enterprise.js?render="+r).then((()=>{n(r,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function Bf(t,e,n,i=!1){const r=new jf(t);let s;try{s=await r.verify(n)}catch(t){s=await r.verify(n,!0)}const o=Object.assign({},e);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function zf(t,e,n,i){var r;if(null===(r=t._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await Bf(t,e,n,"getOobCode"===n);return i(t,r)}return i(t,e).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await Bf(t,e,n,"getOobCode"===n);return i(t,r)}return Promise.reject(r)}))}function qf(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $f(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Hf{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Vd("not implemented")}_getIdTokenResponse(t){return Vd("not implemented")}_linkToIdToken(t,e){return Vd("not implemented")}_getReauthenticationResolver(t){return Vd("not implemented")}}async function Kf(t,e){return Jd(t,"POST","/v1/accounts:signUp",e)}async function Gf(t,e){return Yd(t,"POST","/v1/accounts:signInWithPassword",Qd(t,e))}class Wf extends Hf{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Wf(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Wf(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return zf(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Gf);case"emailLink":return async function(t,e){return Yd(t,"POST","/v1/accounts:signInWithEmailLink",Qd(t,e))}(t,{email:this._email,oobCode:this._password});default:Pd(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return zf(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Kf);case"emailLink":return async function(t,e){return Yd(t,"POST","/v1/accounts:signInWithEmailLink",Qd(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Pd(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Qf(t,e){return Yd(t,"POST","/v1/accounts:signInWithIdp",Qd(t,e))}class Jf extends Hf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Jf(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Pd("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=Rd(e,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Jf(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(t){return Qf(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Qf(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Qf(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=O(e)}return t}}const Xf={USER_NOT_FOUND:"user-not-found"};class Yf extends Hf{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new Yf({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new Yf({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return Yd(t,"POST","/v1/accounts:signInWithPhoneNumber",Qd(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await Yd(t,"POST","/v1/accounts:signInWithPhoneNumber",Qd(t,e));if(n.temporaryProof)throw nf(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return Yd(t,"POST","/v1/accounts:signInWithPhoneNumber",Qd(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),Xf)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new Yf({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Zf{constructor(t){var e,n,i,r,s,o;const a=P(M(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Ud(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=P(M(t)).link,n=e?P(M(e)).deep_link_id:null,i=P(M(t)).deep_link_id;return(i?P(M(i)).link:null)||i||n||e||t}(t);try{return new Zf(e)}catch(t){return null}}}class tp{constructor(){this.providerId=tp.PROVIDER_ID}static credential(t,e){return Wf._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Zf.parseLink(e);return Ud(n,"argument-error"),Wf._fromEmailAndCode(t,n.code,n.tenantId)}}tp.PROVIDER_ID="password",tp.EMAIL_PASSWORD_SIGN_IN_METHOD="password",tp.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ep{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class np extends ep{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class ip extends np{constructor(){super("facebook.com")}static credential(t){return Jf._fromParams({providerId:ip.PROVIDER_ID,signInMethod:ip.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ip.credentialFromTaggedObject(t)}static credentialFromError(t){return ip.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ip.credential(t.oauthAccessToken)}catch(t){return null}}}ip.FACEBOOK_SIGN_IN_METHOD="facebook.com",ip.PROVIDER_ID="facebook.com";class rp extends np{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Jf._fromParams({providerId:rp.PROVIDER_ID,signInMethod:rp.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return rp.credentialFromTaggedObject(t)}static credentialFromError(t){return rp.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return rp.credential(e,n)}catch(t){return null}}}rp.GOOGLE_SIGN_IN_METHOD="google.com",rp.PROVIDER_ID="google.com";class sp extends np{constructor(){super("github.com")}static credential(t){return Jf._fromParams({providerId:sp.PROVIDER_ID,signInMethod:sp.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return sp.credentialFromTaggedObject(t)}static credentialFromError(t){return sp.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return sp.credential(t.oauthAccessToken)}catch(t){return null}}}sp.GITHUB_SIGN_IN_METHOD="github.com",sp.PROVIDER_ID="github.com";class op extends np{constructor(){super("twitter.com")}static credential(t,e){return Jf._fromParams({providerId:op.PROVIDER_ID,signInMethod:op.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return op.credentialFromTaggedObject(t)}static credentialFromError(t){return op.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return op.credential(e,n)}catch(t){return null}}}async function ap(t,e){return Yd(t,"POST","/v1/accounts:signUp",Qd(t,e))}op.TWITTER_SIGN_IN_METHOD="twitter.com",op.PROVIDER_ID="twitter.com";class cp{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await gf._fromIdTokenResponse(t,n,i),s=lp(n);return new cp({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=lp(n);return new cp({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function lp(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class hp extends x{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,hp.prototype),this.customData={appName:t.name,tenantId:null!==(r=t.tenantId)&&void 0!==r?r:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new hp(t,e,n,i)}}function up(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw hp._fromErrorAndOperation(t,n,e,i);throw n}))}new WeakMap;const dp="__sak";class fp{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(dp,"1"),this.storage.removeItem(dp),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class pp extends fp{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=k();return If(t)||Rf(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Nf(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},r=this.storage.getItem(n);!function(){const t=k();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||r===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}pp.type="LOCAL";const gp=pp;class mp extends fp{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}mp.type="SESSION";const vp=mp;class yp{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new yp(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function wp(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}yp.receivers=[];class bp{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=wp("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(l),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function _p(){return window}function Ep(){return void 0!==_p().WorkerGlobalScope&&"function"==typeof _p().importScripts}const Tp="firebaseLocalStorageDb",Ip="firebaseLocalStorage",Sp="fbase_key";class Cp{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function kp(t,e){return t.transaction([Ip],e?"readwrite":"readonly").objectStore(Ip)}function Ap(){const t=indexedDB.open(Tp,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Ip,{keyPath:Sp})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Ip)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Tp);return new Cp(t).toPromise()}(),e(await Ap()))}))}))}async function xp(t,e,n){const i=kp(t,!0).put({[Sp]:e,value:n});return new Cp(i).toPromise()}function Rp(t,e){const n=kp(t,!0).delete(e);return new Cp(n).toPromise()}class Np{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Ap()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ep()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yp._getInstance(Ep()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new bp(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Ap();return await xp(t,dp,"1"),await Rp(t,dp),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>xp(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=kp(t,!1).get(e),i=await new Cp(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Rp(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=kp(t,!1).getAll();return new Cp(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Np.type="LOCAL";const Dp=Np;Vf("rcb"),new $d(3e4,6e4);class Lp{constructor(t){this.providerId=Lp.PROVIDER_ID,this.auth=Mf(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(Ud("string"==typeof r,t,"argument-error"),Ud("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){Ud("enroll"===e.type,t,"internal-error");const n=await function(t,e){return Jd(t,"POST","/v2/accounts/mfaEnrollment:start",Qd(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Ud("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;Ud(n,t,"missing-multi-factor-info");const o=await function(t,e){return Jd(t,"POST","/v2/accounts/mfaSignIn:start",Qd(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return Jd(t,"POST","/v1/accounts:sendVerificationCode",Qd(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,V(e))}static credential(t,e){return Yf._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Lp.credentialFromTaggedObject(e)}static credentialFromError(t){return Lp.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?Yf._fromTokenResponse(e,n):null}}Lp.PROVIDER_ID="phone",Lp.PHONE_SIGN_IN_METHOD="phone";class Op extends Hf{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Qf(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Qf(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Qf(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Pp(t){return async function(t,e,n=!1){const i="signIn",r=await up(t,i,e),s=await cp._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}(t.auth,new Op(t),t.bypassAuthState)}function Mp(t){const{auth:e,user:n}=t;return Ud(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await lf(t,up(i,r,e,t),n);Ud(s.idToken,i,"internal-error");const o=cf(s.idToken);Ud(o,i,"internal-error");const{sub:a}=o;return Ud(t.uid===a,i,"user-mismatch"),cp._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Pd(i,"user-mismatch"),t}}(n,new Op(t),t.bypassAuthState)}async function Fp(t){const{auth:e,user:n}=t;return Ud(n,e,"internal-error"),async function(t,e,n=!1){const i=await lf(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return cp._forOperation(t,"link",i)}(n,new Op(t),t.bypassAuthState)}class Up{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Pp;case"linkViaPopup":case"linkViaRedirect":return Fp;case"reauthViaPopup":case"reauthViaRedirect":return Mp;default:Pd(this.auth,"internal-error")}}resolve(t){jd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){jd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Vp=new $d(2e3,1e4);class jp extends Up{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,jp.currentPopupAction&&jp.currentPopupAction.cancel(),jp.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Ud(t,this.auth,"internal-error"),t}async onExecution(){jd(1===this.filter.length,"Popup operations only handle one event");const t=wp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Md(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Md(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jp.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Md(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,Vp.get())};t()}}jp.currentPopupAction=null;const Bp="pendingRedirect",zp=new Map;class qp extends Up{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=zp.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return bf(Bp,t.config.apiKey,t.name)}(e),i=function(t){return vf(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}zp.set(this.auth._key(),t)}return this.bypassAuthState||zp.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function $p(t,e){zp.set(t._key(),e)}async function Hp(t,e,n=!1){const i=Mf(t),r=function(t,e){return e?vf(e):(Ud(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),s=new qp(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class Kp{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wp(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!Wp(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Md(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Gp(t))}saveEventToCache(t){this.cachedEventUids.add(Gp(t)),this.lastProcessedEventTime=Date.now()}}function Gp(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function Wp({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const Qp=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Jp=/^https?/;function Xp(t){const e=Bd(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Jp.test(n))return!1;if(Qp.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Yp=new $d(3e4,6e4);function Zp(){const t=_p().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let tg=null;function eg(t){return tg=tg||function(t){return new Promise(((e,n)=>{var i,r,s;function o(){Zp(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Zp(),n(Md(t,"network-request-failed"))},timeout:Yp.get()})}if(null===(r=null===(i=_p().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=_p().gapi)||void 0===s?void 0:s.load)){const e=Vf("iframefcb");return _p()[e]=()=>{gapi.load?o():n(Md(t,"network-request-failed"))},Uf(`https://apis.google.com/js/api.js?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw tg=null,t}))}(t),tg}const ng=new $d(5e3,15e3),ig={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rg=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sg(t){const e=t.config;Ud(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Hd(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:kt},r=rg.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${O(i).slice(1)}`}const og={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ag{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const cg=encodeURIComponent("fac");async function lg(t,e,n,i,r,s){Ud(t.config.authDomain,t,"auth-domain-config-required"),Ud(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:kt,eventId:r};if(e instanceof ep){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(s||{}))o[t]=e}if(e instanceof np){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const c=await t._getAppCheckToken(),l=c?`#${cg}=${encodeURIComponent(c)}`:"";return`${function({config:t}){return t.emulator?Hd(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${O(a).slice(1)}${l}`}const hg="webStorageSupport",ug=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vp,this._completeRedirectFn=Hp,this._overrideRedirectResult=$p}async _openPopup(t,e,n,i){var r;return jd(null===(r=this.eventManagers[t._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},og),{width:i.toString(),height:r.toString(),top:s,left:o}),l=k().toLowerCase();n&&(a=Sf(l)?"_blank":n),Tf(l)&&(e=e||"http://localhost",c.scrollbars="yes");const h=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=k()){var e;return Rf(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",a),new ag(null);const u=window.open(e||"",a,h);Ud(u,t,"popup-blocked");try{u.focus()}catch(t){}return new ag(u)}(t,await lg(t,e,n,Bd(),i),wp())}async _openRedirect(t,e,n,i){return await this._originValidation(t),r=await lg(t,e,n,Bd(),i),_p().location.href=r,new Promise((()=>{}));var r}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(jd(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await eg(t),n=_p().gapi;return Ud(n,t,"internal-error"),e.open({where:document.body,url:sg(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ig,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=Md(t,"network-request-failed"),s=_p().setTimeout((()=>{i(r)}),ng.get());function o(){_p().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new Kp(t);return e.register("authEvent",(e=>(Ud(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(hg,{type:hg},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[hg];void 0!==r&&e(!!r),Pd(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return Jd(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(Xp(t))return}catch(t){}Pd(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Nf()||If()||Rf()}};var dg="@firebase/auth",fg="1.5.1";class pg{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Ud(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const gg=S("authIdTokenMaxAge")||300;let mg=null;var vg;vg="Browser",Tt(new j("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Ud(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:vg,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Df(vg)},c=new Pf(n,i,r,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(vf);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(c,e),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),Tt(new j("auth-internal",(t=>(t=>new pg(t))(Mf(t.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Rt(dg,fg,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(vg)),Rt(dg,fg,"esm2017");var yg=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const wg=At({apiKey:"AIzaSyAS_sGDbQYUNZAoF-ZqZcpjWtLQtBmDvsw",authDomain:"proyecto-dca-1b72d.firebaseapp.com",projectId:"proyecto-dca-1b72d",storageBucket:"proyecto-dca-1b72d.appspot.com",messagingSenderId:"272880735350",appId:"1:272880735350:web:f0dbcec16d1c028a4afb57",measurementId:"G-L13XCXHTB8"}),bg=function(t,e){const n="string"==typeof t?t:"(default)",i=It("object"==typeof t?t:xt(),"firestore").getImmediate({identifier:n});if(!i._initialized){const t=(t=>{const e=T("firestore");if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]})();t&&function(t,e,n,i={}){var r;const s=(t=Mu(t,Uu))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&ps("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=cs.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[b(JSON.stringify({alg:"none",type:"JWT"})),b(JSON.stringify(s)),""].join(".")}(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new bs(ws.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new cs(s)}t._authCredentials=new Is(new Es(e,n))}}(i,...t)}return i}(wg),_g=function(t=xt()){const e=It(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=It(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(D(n.getOptions(),null!=e?e:{}))return t;Pd(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:ug,persistence:[Dp,gp,vp]}),i=S("authTokenSyncURL");if(i){const t=(r=i,async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>gg)return;const i=null==e?void 0:e.token;mg!==i&&(mg=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(t,e,n){V(t).beforeAuthStateChanged(e,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,r){V(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}var r;const s=T("auth");return s&&function(t,e,n){const i=Mf(t);Ud(i._canInitEmulator,i,"emulator-config-failed"),Ud(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=qf(e),{host:o,port:a}=function(t){const e=qf(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const t=r[1];return{host:t,port:$f(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:$f(e)}}}(e),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}(wg);let Eg=null;const Tg=t=>{(async function(t,e,n){const i=Mf(t),r=zf(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ap),s=await r.catch((e=>{throw"auth/password-does-not-meet-requirements"===e.code&&async function(t){const e=Mf(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}(t),e})),o=await cp._fromIdTokenResponse(i,"signIn",s);return await i._updateCurrentUser(o.user),o})(_g,t.email,t.password).then((e=>yg(void 0,void 0,void 0,(function*(){const n=e.user;Eg=n.uid,console.log(n.uid);try{const e=qu(bg,"users",n.uid),i={id:n.uid,username:t.username,completeName:t.completeName};console.log(i),yield function(t,e,n){t=Mu(t,ju);const i=Mu(t.firestore,Hu),r=bd(t.converter,e,n);return xd(i,[sd(rd(i),"setDoc",t._key,r,null!==t.converter,n).toMutation(t._key,rc.none())])}(e,i),alert("Se creó el usuario")}catch(t){console.error(t)}})))).catch((t=>{const e=t.code,n=t.message;console.error(e,n)}))},Ig=t=>yg(void 0,void 0,void 0,(function*(){const e=qu(bg,"users",t);return(yield function(t){t=Mu(t,ju);const e=Mu(t.firestore,Hu);return function(t,e,n={}){const i=new _s;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,r){const s=new Iu({next:s=>{e.enqueueAndForget((()=>Gh(t,o)));const a=s.docs.has(n);!a&&s.fromCache?r.reject(new bs(ws.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&i&&"server"===i.source?r.reject(new bs(ws.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:t=>r.reject(t)}),o=new Xh(ya(n.path),s,{includeMetadataChanges:!0,Z_:!0});return Kh(t,o)}(await xu(t),t.asyncQueue,e,n,i))),i.promise}(Ku(e),t._key).then((n=>function(t,e,n){const i=n.docs.get(e._key),r=new Cd(t);return new Ed(t,r,e._key,i,new _d(n.hasPendingWrites,n.fromCache),e.converter)}(e,t,n)))}(e)).data()})),Sg=t=>yg(void 0,void 0,void 0,(function*(){const e=qu(bg,"users");yield function(t,e,n,...i){t=Mu(t,ju);const r=Mu(t.firestore,Hu),s=rd(r);let o;return o="string"==typeof(e=V(e))||e instanceof Qu?function(t,e,n,i,r,s){const o=t.Su(1,e,n),a=[ud(e,i,n)],c=[r];if(s.length%2!=0)throw new bs(ws.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)a.push(ud(e,s[t])),c.push(s[t+1]);const l=[],h=zo.empty();for(let t=a.length-1;t>=0;--t)if(!gd(l,a[t])){const e=a[t];let n=c[t];n=V(n);const i=o.fu(e);if(n instanceof od)l.push(e);else{const t=ad(n,i);null!=t&&(l.push(e),h.set(e,t))}}const u=new go(l);return new td(h,u,o.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.Su(1,e,n);hd("Data must be an object, but it was:",r,i);const s=[],o=zo.empty();ao(i,((t,i)=>{const a=fd(e,t,n);i=V(i);const c=r.fu(a);if(i instanceof od)s.push(a);else{const t=ad(i,c);null!=t&&(s.push(a),o.set(a,t))}}));const a=new go(s);return new td(o,a,r.fieldTransforms)}(s,"updateDoc",t._key,e),xd(r,[o.toMutation(t._key,rc.exists(!0))])}(e,{fav_song:t})}));var Cg;!function(t){t.unlike="unlike",t.like="like",t.cantidadlike="cantidadlike",t.share="share",t.cantidadshare="cantidadshare",t.comentar="comentar",t.cantidadcomentar="cantidadcomentar",t.profileuid="profileuid",t.name="name",t.image="image",t.wave="wave"}(Cg||(Cg={}));class kg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({unlike:null,like:null,cantidadlike:null,share:null,cantidadshare:null,comentar:null,cantidadcomentar:null,profileuid:null,name:null,image:null,wave:null})}attributeChangedCallback(t,e,n){t===Cg.profileuid?this.profileuid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render(),this.attachEventHandlers()}attachEventHandlers(){var t,e;const n=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".like"),i=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".unlike");n&&i&&(n.addEventListener("click",(()=>{n.style.display="none",i.style.display="block",localStorage.setItem("likeState","block")})),i.addEventListener("click",(()=>{n.style.display="block",i.style.display="none",localStorage.setItem("likeState","none")})),"none"===localStorage.getItem("likeState")&&(n.style.display="none",i.style.display="block"))}render(){return function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){var t;if(this.shadowRoot){this.shadowRoot.innerHTML=`\n\t\t\t<section class= "cardEntera">\n\t\t\t<section class= profile>\n\t\t\t<section class="image">\n\t\t\t<img src="${this.image}"></img>\n\t\t\t</section>\n\t\t\t<p class="username">${this.name||"No Username"}</p>\n\t\t\t</section>\n\n\t\t\t<section class='wave'>\n\t\t\t<p id='wave'>${this.wave}</p>\n\t\t\t</section>\n\n\t\t\t<section class="interacciones">\n\t\t\t<section class="like_group">\n\t\t\t<svg id="svg" class="unlike">${this.unlike}</svg>\n\t\t\t<svg id="svg_like" class="like" style="display: none;">${this.like}</svg>\n\t\t\t<p>${this.cantidadlike}</p>\n\t\t\t</section>\n\n\t\t\t<sections class='share'>\n\t\t\t<svg id="svg">${this.share}</svg>\n\t\t\t<p>${this.cantidadshare}</p>\n\t\t\t</sections>\n\n\t\t\t<section class='comment'>\n\t\t\t<svg id="svg">${this.comentar}</svg>\n\t\t\t<p>${this.cantidadcomentar}</p>\n\t\t\t</section>\n\t\t\t</section>\n\t\t\t</section>`;const t=yield yg(void 0,void 0,void 0,(function*(){const t=yield kd(zu(bg,"waves")),e=[];return t.forEach((t=>{const n=t.data();e.push(Object.assign({id:t.id},n))})),e})),e=this.shadowRoot.querySelector(".wave");e&&t.forEach((t=>{const n=document.createElement("p");n.innerText=t.wave,e.appendChild(n)}))}const e=this.ownerDocument.createElement("style");e.innerHTML=m.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}))}}customElements.define("my-card",kg);var Ag=n(9);const xg={wave:""};class Rg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){this.render()}changeWave(t){xg.wave=t.target.value}submitForm(){var t;console.log(xg),t=xg,yg(void 0,void 0,void 0,(function*(){try{const e=zu(bg,"waves");yield Ad(e,t),console.log("se añadió con éxito")}catch(t){console.error(t)}}))}render(){return function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){var e,n,i,r;if(this.shadowRoot){u.forEach((t=>{var e;const n=document.createElement("my-header");n.setAttribute(d.logo,t.logo),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const s=this.ownerDocument.createElement("h1");s.textContent="Share your wave!",null===(e=this.shadowRoot)||void 0===e||e.appendChild(s);const o=this.ownerDocument.createElement("input");o.placeholder="Enter your Wave",o.classList.add("image"),o.addEventListener("change",this.changeWave),this.shadowRoot.appendChild(o);const a=this.ownerDocument.createElement("button");a.innerText="Share",a.classList.add("save"),a.addEventListener("click",this.submitForm.bind(this)),null===(n=this.shadowRoot)||void 0===n||n.appendChild(a);const c=this.ownerDocument.createElement("h2");c.textContent="For You",null===(i=this.shadowRoot)||void 0===i||i.appendChild(c),g.forEach((t=>{var e;const n=document.createElement("my-card");n.setAttribute(Cg.name,t.name),n.setAttribute(Cg.image,t.image),n.setAttribute(Cg.unlike,t.unlike),n.setAttribute(Cg.like,t.like),n.setAttribute(Cg.cantidadlike,t.cantidadlike),n.setAttribute(Cg.share,t.share),n.setAttribute(Cg.cantidadshare,t.cantidadshare),n.setAttribute(Cg.comentar,t.comentar),n.setAttribute(Cg.cantidadcomentar,t.cantidadcomentar),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)})),t.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(l.iconohome,t.iconohome),n.setAttribute(l.iconoexplore,t.iconoexplore),n.setAttribute(l.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const h=this.ownerDocument.createElement("style");h.innerHTML=Ag.A,null===(r=this.shadowRoot)||void 0===r||r.appendChild(h)}}))}}customElements.define("app-dashboard",Rg);const Ng=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg",log_out:'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1e1e1e" d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/></svg>'}];var Dg;!function(t){t.uid="uid",t.logo="logo",t.log_out="log_out"}(Dg||(Dg={}));class Lg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,logo:null,log_out:null})}attributeChangedCallback(t,e,n){t===Dg.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t,e,n;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n    <section class="header">\n\t\t<section class="logo">\n    <img src='${this.logo}'></img>\n\t\t</section>\n\n\t\t<svg class="log_out" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1e1e1e" d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/></svg>\n    </section>`);const i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".logo");null==i||i.addEventListener("click",(()=>{o(c("HOME"))}));const r=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".log_out");null==r||r.addEventListener("click",(()=>{o(c("REGISTER"))}));const s=this.ownerDocument.createElement("style");s.innerHTML=f.A,null===(n=this.shadowRoot)||void 0===n||n.appendChild(s)}}customElements.define("my-headerprofile",Lg);const Og=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1E1E1E" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'"https://i.pinimg.com/originals/94/67/f5/9467f504e83345d60816f9b87ac84588.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#ff9f1c" d="M399 384.2C376.9 345.8 335.4 320 288 320H224c-47.4 0-88.9 25.8-111 64.2c35.2 39.2 86.2 63.8 143 63.8s107.8-24.7 143-63.8zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 16a72 72 0 1 0 0-144 72 72 0 1 0 0 144z"/></svg>'}];var Pg,Mg=n(831);!function(t){t.profile_image="profile_image",t.username="username",t.fav_song="fav_song",t.completeName="completeName"}(Pg||(Pg={}));class Fg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({profile_image:null,username:null,fav_song:null,completeName:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}render(){var t,e,n,i,r;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t<section class="todo">\n\t\t<section class="profile">\n    <img class="image" src="${this.profile_image}"></img>\n    <h1>${this.username}</h1>\n\t\t<Button class="edit">Edit picture</Button>\n\n    <button id="ButtonSong">\n\t\t<p class="fav_song"><svg class="pin"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgb(46, 196, 182);transform: ;msFilter:;"><path d="M15 11.586V6h2V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2h2v5.586l-2.707 1.707A.996.996 0 0 0 6 14v2a1 1 0 0 0 1 1h4v3l1 2 1-2v-3h4a1 1 0 0 0 1-1v-2a.996.996 0 0 0-.293-.707L15 11.586z"></path></svg></svg>\n\t\t${this.fav_song}</p>\n    </section>\n\n\t\t<section class="name-following">\n    <p class="name">${this.completeName}</p>\n\t\t<p class="following">100 following</p>\n\t\t</section>\n\n    <p class="followers">238 followers</p>\n    <Button class="playlist">Playlists</Button>\n\t\t</section>\n\t\t</section>\n\n\n\t\t<section class="modalContainer" style="display:none;">\n    <form class="waveSong">\n        <span class="close">X</span>\n        <h2>What's your wave song at the moment?</h2>\n        <textarea id="writtenSong" name="wave"></textarea>\n        <span role="button" class="post">Post</span>\n    </form>\n    `);const s=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".modalContainer"),o=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#ButtonSong"),a=null===(n=this.shadowRoot)||void 0===n?void 0:n.querySelector(".close");(null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector(".post")).addEventListener("click",(()=>function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){var t;const e=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("#writtenSong"),n=e.value;Sg(n||"Add your Wave"),e.value="",s.style.display="none",document.body.style.overflow="auto"}))));const c=document.body;c&&(o.addEventListener("click",(()=>{s.style.display="block",c.style.overflow="hidden"})),a.addEventListener("click",(()=>{var t;s.style.display="none",c.style.overflow="auto",window.addEventListener("click",(t=>{t.target==s&&(s.style.display="none",c.style.overflow="auto")})),(null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".post")).addEventListener("click",(t=>{var e;t.preventDefault();const n=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#writtenSong"),i=n.value;console.log("Entered wave:",i),n.value="",s.style.display="none",c.style.overflow="auto"}))})));const l=this.ownerDocument.createElement("style");l.innerHTML=Mg.A,null===(r=this.shadowRoot)||void 0===r||r.appendChild(l)}}customElements.define("my-perfil",Fg);var Ug,Vg=n(471);!function(t){t.artist="artist",t.song_title="song_title",t.image="image",t.top="top"}(Ug||(Ug={}));class jg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({artist:null,song_title:null,image:null,top:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}render(){var t;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\t\t\t<section class = "card">\n\n\n\t\t\t<p class="top">${this.top}</p>\n\n\t\t\t<section class= "imagen">\n\t\t\t<img src="${this.image}" alt= "cover album"></img>\n\t\t\t</section>\n\n\t\t\t<section class = "letters">\n\n\t\t\t<section class = "title">\n\t\t\t<p>${this.song_title}</p>\n\t\t\t</section>\n\n\t\t<section class = "artist">\n\t\t<p>${this.artist}</p>\n\t\t</section>\n\n\n\t\t</section>\n\n\t\t</section>\n    `);const e=this.ownerDocument.createElement("style");e.innerHTML=Vg.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}}customElements.define("my-songs",jg);var Bg=n(11),zg=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};const qg={top:"",artist:"",song_title:"",image:"",duration:""};class $g extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){return zg(this,void 0,void 0,(function*(){const t=yield Ig("gvwWdixou6QvruLSFuVBhn1vDEF3");this.render(t)}))}submitForm(){var t;console.log(qg),t=qg,yg(void 0,void 0,void 0,(function*(){try{const e=zu(bg,"playlist");yield Ad(e,t),console.log("se añadió con éxito")}catch(t){console.error(t)}}))}changeArtist(t){qg.artist=t.target.value}changeTitle(t){qg.song_title=t.target.value}changeImage(t){qg.image=t.target.value}render(t){return zg(this,void 0,void 0,(function*(){var e,n,i,r,s;this.shadowRoot&&Ng.forEach((t=>{var e;const n=document.createElement("my-headerprofile");n.setAttribute(Dg.logo,t.logo),n.setAttribute(Dg.log_out,t.log_out),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const o=document.createElement("my-perfil");o.setAttribute(Pg.profile_image,t.profile_image),o.setAttribute(Pg.username,t.username),o.setAttribute(Pg.completeName,t.completeName),o.setAttribute(Pg.fav_song,t.fav_song),null===(e=this.shadowRoot)||void 0===e||e.appendChild(o);const a=this.ownerDocument.createElement("h1");a.textContent="Add your own song",a.classList.add("h1Add"),null===(n=this.shadowRoot)||void 0===n||n.appendChild(a);const c=this.ownerDocument.createElement("section");c.classList.add("create-song");const h=this.ownerDocument.createElement("input");h.placeholder="Add an artist",h.classList.add("artist"),h.addEventListener("change",this.changeArtist),c.appendChild(h);const u=this.ownerDocument.createElement("input");u.placeholder="Add the song title",u.classList.add("title"),u.addEventListener("change",this.changeTitle),c.appendChild(u);const d=this.ownerDocument.createElement("input");d.placeholder="Add the album cover",d.classList.add("image"),d.addEventListener("change",this.changeImage),c.appendChild(d),null===(i=this.shadowRoot)||void 0===i||i.appendChild(c);const f=this.ownerDocument.createElement("button");f.innerText="Save",f.classList.add("save"),f.addEventListener("click",this.submitForm),null===(r=this.shadowRoot)||void 0===r||r.appendChild(f),(yield yg(void 0,void 0,void 0,(function*(){const t=yield kd(zu(bg,"playlist")),e=[];return t.forEach((t=>{const n=t.data();e.push(Object.assign({id:t.id},n))})),e}))).forEach((t=>{var e;const n=this.ownerDocument.createElement("my-songs");n.setAttribute(Ug.top,"●"),n.setAttribute(Ug.image,t.image),n.setAttribute(Ug.artist,t.artist),n.setAttribute(Ug.song_title,t.song_title),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)})),Og.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(l.iconohome,t.iconohome),n.setAttribute(l.iconoexplore,t.iconoexplore),n.setAttribute(l.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const p=this.ownerDocument.createElement("style");p.innerHTML=Bg.A,null===(s=this.shadowRoot)||void 0===s||s.appendChild(p)}))}}customElements.define("app-perfil",$g);var Hg,Kg=n(499);!function(t){t.uid="uid",t.name="name",t.photo="photo",t.profile="profile",t.song="song"}(Hg||(Hg={}));class Gg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({uid:null,photo:null,name:null,profile:null,song:null})}attributeChangedCallback(t,e,n){t===Hg.uid?this.uid=n?Number(n):void 0:this[t]=n}connectedCallback(){this.render()}render(){var t;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n\n\t\t<section class="card" style="background-image: url('${this.photo}');background-position-x: center;background-size: cover;">\n\t\t<section class="todo">\n\t\t<section class= "image">\n\t\t<img src='${this.profile}'></img>\n    <p>${this.name}</p>\n\t\t</section>\n\t\t<section class="song">\n    <h3>${this.song}</h3>\n\t\t</section>\n\t\t</section>\n\t\t</section>\n\t\t`);const e=this.ownerDocument.createElement("style");e.innerHTML=Kg.A,null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}}customElements.define("my-friend",Gg);const Wg=[{id:1,iconohome:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"  viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#1E1E1E" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg>',iconoexplore:'\t"https://i.pinimg.com/originals/33/ff/00/33ff00839226a94f68b571016bc6d99c.jpg"',iconoprofile:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgb(32, 32, 32);transform: ;msFilter:;"><path d="M12 2C6.579 2 2 6.579 2 12s4.579 10 10 10 10-4.579 10-10S17.421 2 12 2zm0 5c1.727 0 3 1.272 3 3s-1.273 3-3 3c-1.726 0-3-1.272-3-3s1.274-3 3-3zm-5.106 9.772c.897-1.32 2.393-2.2 4.106-2.2h2c1.714 0 3.209.88 4.106 2.2C15.828 18.14 14.015 19 12 19s-3.828-.86-5.106-2.228z"></path></svg>'}];var Qg=n(628);class Jg extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){return function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){const t=yield yg(void 0,void 0,void 0,(function*(){const t=[];return(yield kd(zu(bg,"Friends-playlist"))).forEach((e=>{t.push(e.data())})),t})),e=yield yg(void 0,void 0,void 0,(function*(){const t=[];return(yield kd(zu(bg,"Songs"))).forEach((e=>{t.push(e.data())})),t}));console.log(t,e),this.render(t,e)}))}render(t,e){var n,i,r,s;this.shadowRoot&&u.forEach((t=>{var e;const n=document.createElement("my-header");n.setAttribute(d.logo,t.logo),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)})),Wg.forEach((t=>{var e;const n=document.createElement("my-iconos");n.setAttribute(l.iconohome,t.iconohome),n.setAttribute(l.iconoexplore,t.iconoexplore),n.setAttribute(l.iconoprofile,t.iconoprofile),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}));const o=this.ownerDocument.createElement("h1");o.textContent="On trending",null===(n=this.shadowRoot)||void 0===n||n.appendChild(o),e.forEach(((t,e)=>{var n;const i=document.createElement("my-songs");i.setAttribute(Ug.top,t.top),i.setAttribute(Ug.song_title,t.song_title),i.setAttribute(Ug.artist,t.artist),i.setAttribute(Ug.image,t.image),i.setAttribute("data-index",(e+1).toString()),null===(n=this.shadowRoot)||void 0===n||n.appendChild(i)}));const a=this.ownerDocument.createElement("h1");a.textContent="My friends playlist",null===(i=this.shadowRoot)||void 0===i||i.appendChild(a);const c=this.ownerDocument.createElement("section");c.classList.add("playlists"),t.forEach((t=>{const e=document.createElement("my-friend");console.log(t),e.setAttribute(Hg.name,t.name),e.setAttribute(Hg.profile,t.profile),e.setAttribute(Hg.photo,t.photo),e.setAttribute(Hg.song,t.song),c.appendChild(e)})),null===(r=this.shadowRoot)||void 0===r||r.appendChild(c);const h=this.ownerDocument.createElement("style");h.innerHTML=Qg.A,null===(s=this.shadowRoot)||void 0===s||s.appendChild(h)}}customElements.define("app-explore",Jg);var Xg=n(835);const Yg={email:"",username:"",completeName:"",password:""};var Zg;!function(t){t.logo="logo",t.google="google",t.facebook="facebook",t.outlook="outlook"}(Zg||(Zg={}));class tm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({logo:null,google:null,facebook:null,outlook:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render(),console.log(Yg)}changeEmail(t){var e;Yg.email=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value,console.log(Yg.email)}changePassword(t){var e;Yg.password=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value,console.log(Yg.password)}changeUsername(t){var e;Yg.username=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value,console.log(Yg.username)}changeCompleteName(t){var e;Yg.completeName=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.value,console.log(Yg.completeName)}submitForm(){Tg(Yg)}render(){if(this.shadowRoot){const t=this.ownerDocument.createElement("section");t.classList.add("todo");const e=this.ownerDocument.createElementNS("http://www.w3.org/2000/svg","svg");e.classList.add("svg"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("height","35"),e.setAttribute("width","35"),e.setAttribute("viewBox","0 0 320 512"),e.innerHTML='\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec4b6" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/>',t.appendChild(e);const n=this.ownerDocument.createElement("img");n.classList.add("logo"),n.src=this.logo||"undefined",t.appendChild(n);const i=this.ownerDocument.createElement("section");i.classList.add("info");const r=this.ownerDocument.createElement("h1");r.classList.add("text_create"),r.textContent="Create your account",i.appendChild(r),t.appendChild(i),this.shadowRoot.appendChild(t);const s=this.ownerDocument.createElement("section");s.classList.add("inputs");const a=this.ownerDocument.createElement("input");a.placeholder="Correo electronico",a.addEventListener("change",this.changeEmail),s.appendChild(a);const l=this.ownerDocument.createElement("input");l.placeholder="Username",l.addEventListener("change",this.changeUsername),s.appendChild(l);const h=this.ownerDocument.createElement("input");h.placeholder="Name and Last name",h.addEventListener("change",this.changeCompleteName),s.appendChild(h);const u=this.ownerDocument.createElement("input");u.placeholder="Contraseña",u.addEventListener("change",this.changePassword),s.appendChild(u);const d=this.ownerDocument.createElement("button");d.innerText="Registrarme",d.addEventListener("click",this.submitForm),s.appendChild(d),this.shadowRoot.appendChild(s);const f=this.ownerDocument.createElement("section");f.classList.add("todo");const p=this.ownerDocument.createElement("p");p.classList.add("text"),p.textContent="Or sign up with",f.appendChild(p);const g=this.ownerDocument.createElement("section");g.id="apps";const m=this.ownerDocument.createElement("img");m.classList.add("google"),m.src=this.google||"undefined",g.appendChild(m);const v=this.ownerDocument.createElement("img");v.classList.add("facebook"),v.src=this.facebook||"undefined",g.appendChild(v);const y=this.ownerDocument.createElement("img");y.classList.add("outlook"),y.src=this.outlook||"undefined",g.appendChild(y),f.appendChild(g);const w=this.ownerDocument.createElement("section");w.classList.add("already_have");const b=this.ownerDocument.createElement("p");b.classList.add("text"),b.textContent="Already have an account?",w.appendChild(b);const _=this.ownerDocument.createElement("p");_.classList.add("signup_btn"),_.textContent="Log In",w.appendChild(_),f.appendChild(w),this.shadowRoot.appendChild(f),e.addEventListener("click",(()=>{o(c("PROFILE"))})),_.addEventListener("click",(()=>{o(c("LOGIN"))}));const E=this.ownerDocument.createElement("style");E.innerHTML=Xg.A,this.shadowRoot.appendChild(E)}}}customElements.define("my-register",tm);const em=[{id:1,logo:"https://i.pinimg.com/736x/4e/97/d6/4e97d610dfc03d8fde6969d5be6434f4.jpg",google:"https://cdn1.iconfinder.com/data/icons/google-s-logo/150/Google_Icons-09-512.png",facebook:"https://upload.wikimedia.org/wikipedia/commons/6/6c/Facebook_Logo_2023.png",outlook:"https://seeklogo.com/images/M/microsoft-outlook-logo-188AB32C94-seeklogo.com.png"}];class nm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){this.render()}render(){this.shadowRoot&&em.forEach((t=>{var e;const n=document.createElement("my-register");n.setAttribute(Zg.logo,t.logo),n.setAttribute(Zg.google,t.google),n.setAttribute(Zg.facebook,t.facebook),n.setAttribute(Zg.outlook,t.outlook),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}))}}var im;customElements.define("app-register",nm),function(t){t.logo="logo",t.google="google",t.facebook="facebook",t.outlook="outlook"}(im||(im={}));class rm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys({logo:null,google:null,facebook:null,outlook:null})}attributeChangedCallback(t,e,n){this[t]=n}connectedCallback(){this.render()}render(){var t,e,n;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n      <section class="todo">\n\n      <svg class="svg" xmlns="http://www.w3.org/2000/svg" height="35" width="35" viewBox="0 0 320 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path fill="#2ec4b6" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>\n\n      <img class="logo" src="${this.logo}"></img>\n\n      <section class="info">\n\t\t\t<h1 class="text_create">Log in to your account</h1>\n\n      <section class="inputs">\n\t\t\t<form>\n\t\t\t<input type="Email" placeholder="Email or Username"></input>\n\t\t\t<input type="Password" placeholder="Password"></input>\n      </section>\n\t\t\t<button type="submit">Sign In</button>\n\t\t\t</form>\n      </section>\n\t\t\t<p class="text">Or sign in with</p>\n\n      <section id="apps">\n      <img class="google" src="${this.google}"></img>\n      <img class="facebook" src="${this.facebook}"></img>\n      <img class="outlook" src="${this.outlook}"></img>\n      </section>\n      <section class="already_have">\n      <p class="text">Don't have an account?</p>\n      <p class="signup_btn" >Sign Up</p>\n      </section>\n      </section>\n    `);const i=null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(".svg");null==i||i.addEventListener("click",(()=>{o(c("PROFILE"))}));const r=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".signup_btn");null==r||r.addEventListener("click",(()=>{o(c("REGISTER"))}));const s=this.ownerDocument.createElement("style");s.innerHTML=Xg.A,null===(n=this.shadowRoot)||void 0===n||n.appendChild(s)}}customElements.define("my-login",rm);class sm extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){this.render()}render(){this.shadowRoot&&em.forEach((t=>{var e;const n=document.createElement("my-login");n.setAttribute(im.logo,t.logo),n.setAttribute(im.google,t.google),n.setAttribute(im.facebook,t.facebook),n.setAttribute(im.outlook,t.outlook),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n)}))}}customElements.define("app-login",sm);class om extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),a(this)}connectedCallback(){this.render()}render(){var t,e,n,i,s;switch(this.shadowRoot&&(this.shadowRoot.innerHTML=""),r.screen){case"HOME":const r=this.ownerDocument.createElement("app-dashboard");null===(t=this.shadowRoot)||void 0===t||t.appendChild(r);break;case"EXPLORE":const o=this.ownerDocument.createElement("app-explore");null===(e=this.shadowRoot)||void 0===e||e.appendChild(o);break;case"PROFILE":const a=this.ownerDocument.createElement("app-perfil");null===(n=this.shadowRoot)||void 0===n||n.appendChild(a);break;case"REGISTER":const c=this.ownerDocument.createElement("app-register");null===(i=this.shadowRoot)||void 0===i||i.appendChild(c);break;case"LOGIN":const l=this.ownerDocument.createElement("app-login");null===(s=this.shadowRoot)||void 0===s||s.appendChild(l)}}}customElements.define("app-container",om)})()})();